var excelOnlineCalc=function(e){var r={};function n(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)n.d(t,o,function(r){return e[r]}.bind(null,o));return t},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="",n(n.s=12)}([function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=n(1);r.utils=t;var o=n(2);r.idbPromised=o;var a=n(3);r.ULS=a.ULS,r.TraceLevel=a.TraceLevel,r.LogCategory=a.LogCategory,r.NulLogger=a.NulLogger,r.ConsoleLogger=a.ConsoleLogger;var i=n(4);r.browserSupport=i;var u=n(5);r.perfWatch=u;var c=n(6);r.initEwaUtils=c.initEwaUtils,r.ewaUtils=c.ewaUtils;var l=n(7);r.initStopwatchFactory=l.initStopwatchFactory},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.forEachPromise=function(e,r,n){return e.reduce(function(e,t){return e.then(function(){return n&&n.stop?Promise.resolve(void 0):r(t,n)})},Promise.resolve(void 0))},r.defaultToJSONResultWhenStringifyFails="...",r.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(r,n){if(void 0===n&&(n=0),n<0||n>t)return r;if(null==r||"object"!=typeof r)return r;var o={};Object.getOwnPropertyNames(r).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=r[e])});var a=Object.getPrototypeOf(r);a&&"object"==typeof a&&Object.keys(a).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=r[e])});var i={};return Object.keys(o).forEach(function(r){i[r]=e(o[r],n+1)}),i}(e))}catch(e){return r.defaultToJSONResultWhenStringifyFails}};var t=5;var o="_",a=new RegExp("\\W+","g");r.getPerfWatchMarkName=function(e){if(!e)return"";var r=e.trim().substring(0,200).trim().replace(a,o).substring(0,80);return r&&r.length>0&&r.substr(r.length-1,1)===o&&(r=r.substr(0,r.length-1)),r&&r.length>0&&r.substr(0,1)===o&&(r=r.substr(1)),r},r.retry=function(e,r){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(r<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+r));for(var n=Promise.reject(void 0),t=function(r){n=n.catch(function(n){return e(r,n)})},o=1;o<=r;o+=1)t(o);return n},r.chainFallbackPromises=function(e,r){if(!e||0===e.length)return Promise.resolve();for(var n=r(e[0]),t=function(t){var o=e[t];n=n.catch(function(){return r(o)})},o=1;o<e.length;o+=1)t(o);return n},r.getQueryParameterByName=function(e,r){var n=new RegExp("[?&]"+r+"(=([^&#]*)|&|#|$)").exec(e);if(n)return n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):""},r.calcHashCode=function(e){if(!e)return 0;for(var r=5381,n=r,t=e.length,o=0;o<t&&(r=4294967295&((r<<5)+r^e.charCodeAt(o)),o!==t-1);o+=2)n=4294967295&((n<<5)+n^e.charCodeAt(o+1));var a=r+35685*n+(23896*n<<16)&4294967295;return a<0&&(a+=4294967296),a},r.getCharIndexInTextFromPoint=function(e,r){var n=-1,t=document.elementFromPoint(e,r);if(void 0!==document.caretPositionFromPoint)null!==(o=document.caretPositionFromPoint(e,r))&&(n=o.offset);else if(void 0!==document.caretRangeFromPoint)null!==(o=document.caretRangeFromPoint(e,r))&&(n=o.startOffset);else try{var o;(o=document.body.createTextRange()).moveToPoint(e,r);var a=document.body.createTextRange();a.moveToElementText(t),a.setEndPoint("EndToStart",o),n=a.text.length}catch(e){return n}for(;null!=t&&"SPAN"===t.nodeName;)null!=(t=t.previousSibling)&&null!=t.textContent&&(n+=t.textContent.length);return n}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t,o=n(1);function a(e,r,n){return e?!(r&&!e.objectStoreNames.contains(r))||(n({name:"ValidationError",message:"The database doesn't contain store name: "+r}),!1):(n({name:"ValidationError",message:"The database should be initialized"}),!1)}var i=void 0;function u(e){void 0!==i&&i(e)}function c(e,r,n,t){return new Promise(function(o,i){if(a(e,r,i)){var u,c=e.transaction([r],n);c.oncomplete=function(){return o()},c.onerror=function(){return i(u||c.error)},c.onabort=function(){return i(u||c.error)};var l=c.objectStore(r),s=t(l);s.onerror=function(){u=s.error}}})}r.registerTraceSubscriber=function(e){i=e},r.clearTraceSubscriber=function(){i=void 0},r.setTestDbFactory=function(e){t=e},r.getDbFactory=function(){if(t)return t;try{if(window&&"indexedDB"in window&&void 0!==window.indexedDB)return window.indexedDB}catch(n){var e=o.getStringifiedError(n);e&&e!==o.defaultToJSONResultWhenStringifyFails||!n||!n.message||(e=n.message);var r=o.getPerfWatchMarkName(e);u("indexedDB_access_error"+(r&&r.length>0?"_":"")+r)}},r.getStoreReadinessPromise=function(e){return new Promise(function(r,n){e.transaction.oncomplete=function(){return r()},e.transaction.onerror=function(){return n(e.transaction.error)}})},r.initDb=function(e,r,n,t){return new Promise(function(o,a){u("idb_open");var i,c,l,s,f=n||0===n?e.open(r,n):e.open(r),d=(i=!1,c=!1,l=function(e){u("idb_open_"+e)},s=function(){return c?(l("already_resolved"),!1):!i||(l("already_rejected"),!1)},{rejectOnce:function(e){l("should_reject"),s()&&(l("rejecting"),i=!0,a(e))},resolveOnce:function(e){l("should_resolve"),s()&&(l("resolving"),c=!0,o(e))}});f.onupgradeneeded=function(e){u("idb_open_onupgradeneeded_start");var n=e.target.result;if(e.oldVersion>0&&function(e){u("idb_open_onupgradeneeded_deleteAllObjectStores");for(var r=[],n=e.objectStoreNames.length-1;n>=0;n-=1){var t=e.objectStoreNames.item(n);(t||""===t)&&r.push(t)}r.forEach(function(r){u("idb_open_onupgradeneeded_delete_store_"+r),e.deleteObjectStore(r)})}(n),t){u("idb_open_onupgradeneeded_create_stores");var o=t(n);o&&o.length>0&&Promise.all(o).then(function(){u("idb_open_onupgradeneeded_stores_ready"),d.resolveOnce({db:n,dbName:r})},function(e){u("idb_open_onupgradeneeded_stores_ready_error"),d.rejectOnce(e)})}u("idb_open_onupgradeneeded_end")},f.onsuccess=function(e){u("idb_open_onsuccess"),d.resolveOnce({db:e.target.result,dbName:r})},f.onerror=function(){u("idb_open_onerror"),d.rejectOnce(f.error)},f.onblocked=function(e){u("idb_open_onblocked"),d.rejectOnce(e)}})},r.deleteDb=function(e,r){return new Promise(function(n,t){var o=e.deleteDatabase(r);o.onsuccess=function(){return n()},o.onblocked=function(){return n()},o.onerror=function(){return t(o.error)}})},r.doTransactionAction=c,r.put=function(e,r,n,t){return c(e,r,"readwrite",function(e){return n?e.put(t,n):e.put(t)})},r.get=function(e,r,n){return new Promise(function(t,o){if(a(e,void 0,o)){var i;e.objectStoreNames.contains(r)||t(void 0);var u=void 0,c=e.transaction([r],"readonly");c.oncomplete=function(){return t(u)},c.onerror=function(){return o(i||c.error)},c.onabort=function(){return o(i||c.error)};var l=c.objectStore(r).get(n);l.onsuccess=function(e){u=e.target.result},l.onerror=function(){i=l.error}}})},r.getAllItems=function(e,r){return new Promise(function(n,t){if(a(e,r,t)){var o,i=[],u=e.transaction([r],"readonly");u.oncomplete=function(){return n(i)},u.onerror=function(){return t(o||u.error)},u.onabort=function(){return t(o||u.error)};var c=u.objectStore(r).openCursor();c.onsuccess=function(e){var r=e.target.result;r&&(i.push(r.value),r.continue())},c.onerror=function(){o=c.error}}})},r.getAllKeys=function(e,r){return new Promise(function(n,t){if(a(e,r,t)){var o,i=[],u=e.transaction([r],"readonly");u.oncomplete=function(){return n(i)},u.onerror=function(){return t(o||u.error)},u.onabort=function(){return t(o||u.error)};var c=u.objectStore(r).openCursor();c.onsuccess=function(e){var r=e.target.result;r&&(i.push(r.key),r.continue())},c.onerror=function(){o=c.error}}})},r.remove=function(e,r,n){return c(e,r,"readwrite",function(e){return e.delete(n)})},r.removeAll=function(e,r){return c(e,r,"readwrite",function(e){return e.clear()})}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r.TraceLevel||(r.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(r.LogCategory||(r.LogCategory={})),r.ULS={getFromExternalLogger:function(e){var r=e;return{ULS:{trace:function(e,n,t){return r.traceTag(0,e,n,t)},traceTag:function(e,n,t,o){return r.traceTag(e,n,t,o)},debugTrace:function(e,n,t){return r.debugTraceTag(0,e,n,t)},debugTraceTag:function(e,n,t,o){return r.debugTraceTag(e,n,t,o)},assert:function(e,n,t){return r.assertTag(0,e,n,t)},assertTag:function(e,n,t,o){return r.assertTag(e,n,t,o)},shipAssert:function(e,n,t){return r.shipAssertTag(0,e,n,t)},shipAssertTag:function(e,n,t,o){return r.shipAssertTag(e,n,t,o)}}}}};var t=function(){function e(){}return e.prototype.shipAssertTag=function(e,r,n,t){console.assert(n,"shipAssertTag:",e,r,t)},e.prototype.assertTag=function(e,r,n,t){console.assert(n,"assertTag",e,r,t)},e.prototype.traceTag=function(e,r,n,t){console.log("traceTag",e,t,r,n)},e.prototype.debugTraceTag=function(e,r,n,t){console.log("debugTraceTag",e,t,r,n)},e}();r.ConsoleLogger=t;var o=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();r.NulLogger=o},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t={},o="promises";r.promises=function(){return void 0===t[o]&&(t[o]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),t[o]}},function(e,r,n){"use strict";function t(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function o(e,r,n){e[r]=t()-n}Object.defineProperty(r,"__esModule",{value:!0}),r.start=function(e){var r=t(),n=e,a=r,i={},u=function(e,r,t){return function(e,r,n,t,a,i){o(e,"end",n);var u={sessionName:r,result:t?"success":"failure",message:i,marks:e},c=JSON.stringify(u);a(c)}(i,n,a,e,r,t)};return i.start=0,{mark:function(e){return function(e){return o(i,e,a)}(e)},end:function(e){return u(!0,e)},success:function(e,r){return u(!0,e,r)},failure:function(e,r){return u(!1,e,r)}}},r.mark=function(e,r){void 0!==e&&e.mark(r)},r.end=function(e,r){void 0!==e&&e.end(r)},r.success=function(e,r,n){void 0!==e&&e.success(r,n)},r.failure=function(e,r,n){void 0!==e&&e.failure(r,n)}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t={isChangeGateEnabled:function(e){return!1}};r.ewaUtils=function(){return t},r.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");t=e}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=function(){return Date.now()};r.initStopwatchFactory=function(e,r){return void 0===r&&(r=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(t=function(){return self.performance.now()}),function(n){var o=t(),a=n;return{reset:function(e){null!=e&&(a=e),o=t()},stop:function(){var n=t()-o,i=JSON.stringify({Target:a,Duration:n.toFixed(r)});e(i)}}}}},function(e,r,n){(function(e,r){function t(e){return"undefined"!=typeof MessageEvent?new MessageEvent("message",{data:e}):{type:"message",data:e}}e:if("undefined"==typeof Worker){var o=void 0!==e&&null!=Object({NODE_ENV:"production"})&&null!=Object({NODE_ENV:"production"}).JEST_WORKER_ID,a=void 0!==r&&r.global===r;if(o||a){var i,u;try{i="undefined"!=typeof require?require:n(11)}catch(e){console.log("require is not defined (is this in a script executed by vm.runInThisContext?)");break e}try{u=i("worker_threads")}catch(e){console.log("error importing worker_threads (was node run without --experimental-worker?): "+e.stack);break e}if(r.Worker=function(){function e(e){var r=this;this._onmessage=null,this._onerror=null,this.onmessageerror=null,this._messageHandler=function(e){null!=r._onmessage&&r._onmessage.call(r,t(e))},this._errorHandler=function(e){null!=r._onerror&&r._onerror.call(r,function(e,r){return"undefined"!=typeof ErrorEvent?new ErrorEvent("error",{message:e,error:r}):{type:"error",message:e,error:r,preventDefault:function(){}}}(e.message,e))},this._worker=new u.Worker(e)}return Object.defineProperty(e.prototype,"onmessage",{get:function(){return this._onmessage},set:function(e){null==e?this._worker.removeListener("message",this._messageHandler):null==this._onmessage&&this._worker.on("message",this._messageHandler),this._onmessage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onerror",{get:function(){return this._onerror},set:function(e){null==e?this._worker.removeListener("error",this._errorHandler):null==this._onerror&&this._worker.on("error",this._errorHandler),this._onerror=e},enumerable:!0,configurable:!0}),e.prototype.postMessage=function(e){this._worker.postMessage(e)},e.prototype.terminate=function(){this._worker.terminate()},e.prototype.addEventListener=function(){throw new Error("unimplemented: WorkerPolyfill.addEventListener")},e.prototype.removeEventListener=function(){throw new Error("unimplemented: WorkerPolyfill.removeEventListener")},e.prototype.dispatchEvent=function(e){throw new Error("unimplemented: WorkerPolyfill.dispatchEvent")},e}(),!u.isMainThread&&"undefined"==typeof DedicatedWorkerGlobalScope){var c=function(){function r(){var e=this;this._onmessage=null,this.onmessageerror=null,this.onunhandledrejection=null,this._messageHandler=function(r){null!=e._onmessage&&e._onmessage.call(e,t(r))}}return Object.defineProperty(r.prototype,"onmessage",{get:function(){return this._onmessage},set:function(e){null==e?u.parentPort.removeListener("message",this._messageHandler):null==this._onmessage&&u.parentPort.on("message",this._messageHandler),this._onmessage=e},enumerable:!0,configurable:!0}),r.prototype.postMessage=function(e,r){u.parentPort.postMessage(e)},r.prototype.close=function(){e.exit()},r}();r.DedicatedWorkerGlobalScope=c,r.self=new c,r.importScripts=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=i("vm"),t=i("fs");e.forEach(function(e){var r=t.readFileSync(e,"utf-8");n.runInThisContext(r)})}}}}}).call(this,n(9),n(10))},function(e,r){var n,t,o=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(r){try{return n.call(null,e,0)}catch(r){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{t="function"==typeof clearTimeout?clearTimeout:i}catch(e){t=i}}();var c,l=[],s=!1,f=-1;function d(){s&&c&&(s=!1,c.length?l=c.concat(l):f=-1,l.length&&E())}function E(){if(!s){var e=u(d);s=!0;for(var r=l.length;r;){for(c=l,l=[];++f<r;)c&&c[f].run();f=-1,r=l.length}c=null,s=!1,function(e){if(t===clearTimeout)return clearTimeout(e);if((t===i||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(e);try{t(e)}catch(r){try{return t.call(null,e)}catch(r){return t.call(this,e)}}}(e)}}function p(e,r){this.fun=e,this.array=r}function v(){}o.nextTick=function(e){var r=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)r[n-1]=arguments[n];l.push(new p(e,r)),1!==l.length||s||u(E)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,r){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,r){function n(e){var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=11},function(e,r,n){"use strict";n.r(r);var t={};n.r(t),n.d(t,"createParseGlobals",function(){return dt}),n.d(t,"ReasonKind",function(){return Et}),n.d(t,"notImplemented",function(){return ft}),n.d(t,"notFormulaString",function(){return pt}),n.d(t,"createParser",function(){return Eu}),n.d(t,"parseResultHelper",function(){return Iu});var o={};n.r(o),n.d(o,"createAnalyzeGlobals",function(){return Cu}),n.d(o,"createAnalyzer",function(){return Rc});var a={};n.r(a),n.d(a,"fastMathpack",function(){return Fc}),n.d(a,"createCompiler",function(){return is}),n.d(a,"createEvaluator",function(){return Yd}),n.d(a,"createFormulaInspector",function(){return oE}),n.d(a,"ReasonKind",function(){return fl}),n.d(a,"CellKind",function(){return ll}),n.d(a,"Interrupt",function(){return sl}),n.d(a,"notImplemented",function(){return ul}),n.d(a,"finalValue",function(){return pl}),n.d(a,"pendingValue",function(){return vl}),n.d(a,"cellFormula",function(){return hl}),n.d(a,"unavailable",function(){return cl}),n.d(a,"unevaluated",function(){return Tl}),n.d(a,"stopped",function(){return gl}),n.d(a,"nameCycle",function(){return Sl}),n.d(a,"cellCycle",function(){return Rl}),n.d(a,"paused",function(){return Al}),n.d(a,"previousFailure",function(){return Il}),n.d(a,"javaScriptError",function(){return Cl}),n.d(a,"evalGlobals",function(){return ml}),n.d(a,"getEvalFailureReason",function(){return Nl}),n.d(a,"illFormedFormula",function(){return El}),n.d(a,"createCompileGlobals",function(){return dl}),n.d(a,"extractResultValue",function(){return Bl}),n.d(a,"evalToCellValue",function(){return xl}),n.d(a,"getBasicFirstOrderFunc",function(){return vp}),n.d(a,"extension",function(){return dp});var i={};n.r(i),n.d(i,"WorkerKind",function(){return tv}),n.d(i,"ErrorKind",function(){return ov}),n.d(i,"isWorkerSupported",function(){return Uv}),n.d(i,"createWorker",function(){return Pv}),n.d(i,"tryCreateWorker",function(){return Bv}),n.d(i,"dedicatedWorkerInsideInit",function(){return Vv}),n.d(i,"runSmokeTest",function(){return Xv}),n.d(i,"cancelSmokeTest",function(){return jv}),n.d(i,"smokeTestInsideDef",function(){return Gv});var u={};n.r(u),n.d(u,"recalcMapper",function(){return Wp}),n.d(u,"mapperContext",function(){return Hp}),n.d(u,"formulaCacheGlobals",function(){return $p}),n.d(u,"formulaCache",function(){return ev}),n.d(u,"createFormatInfo",function(){return Zp}),n.d(u,"createRecalcService",function(){return qv}),n.d(u,"recalcServiceInsideDef",function(){return Jv});var c={};n.r(c),n.d(c,"getBasicFirstOrderFunc",function(){return vp}),n.d(c,"makeGetFirstOrderFunc",function(){return hp});var l={};n.r(l),n.d(l,"Workbook",function(){return mh}),n.d(l,"DataCell",function(){return $v}),n.d(l,"FormulaCell",function(){return rh}),n.d(l,"FailedCell",function(){return nh}),n.d(l,"emptyCell",function(){return eh}),n.d(l,"Worksheet",function(){return oh});var s=n(0);function f(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function d(e){return e}function E(e){if("object"!=typeof e)return"<unexpected>";var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=p(e[n],n));return r}function p(e,r){if("string"==typeof r&&null!=g[r])return e;var n=function(e){var r=typeof e;if("object"===r){if(null===e)return"null";if(e instanceof Array)return"Array";var n=e.kind;if("string"==typeof n)return n}return r}(e),t=T[n];return null!=t?t(e,r):"object"==typeof e?E(e):"<unexpected>"}function v(e){try{var r=function(e){if("object"==typeof e&&null!=e){if(e.hasOwnProperty("node")&&e.hasOwnProperty("spans"))return"Formula";if(e.hasOwnProperty("kind")&&("Literal"===(r=e.kind)||"Array"===r||"App"===r||"Paren"===r||"Name"===r||"CellRef"===r||"Bad"===r||"Operator"===r))return"FormulaNode"}var r}(e);if(void 0!==r){var n=m[r](e);return void 0!==n?n:JSON.stringify(p(e,void 0))}return JSON.stringify(p(e,void 0))}catch(e){return e instanceof Error?"<error "+e.name+": "+JSON.stringify(e.message)+">":"<error: "+JSON.stringify(e)+">"}}var h,g={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},T={boolean:d,symbol:d,undefined:d,null:d,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var r=e.name;return"string"==typeof r&&r.length>0?"<function "+r+">":"<function>"},object:E,Array:function(e){return"object"==typeof e&&e instanceof Array?e.map(p):"<unexpected>"}},m={},S={ULS:new s.NulLogger};function R(e){S.ULS=e}function I(e,r){var n=e+": code should be unreachable because a value has type 'never'; given "+v(r);return S.ULS.assertTag(595980872,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}function C(e){return S.ULS.assertTag(595980873,s.LogCategory.msoulscat_ES_EWAJS,!1,e)}function A(e,r){(!f(r)||r<0)&&C(e+": expected natural number; given "+v(r))}function N(e,r){(!f(r)||r<=0)&&C(e+": expected positive integer; given "+v(r))}function O(e,r,n){(!f(r)||r<0||r>=n)&&C(e+": expected natural number less than "+v(n)+"; given "+v(r))}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation"}(h||(h={}));var y=L(void 0,"");function L(e,r){return{path:e,name:r}}function k(e,r,n){return{document:e,index:r,length:n}}function D(e,r,n){return A("calc.lang.sheetRange",r),N("calc.lang.sheetRange",n),k(e,r,n)}function M(e,r){return A("calc.lang.sheetIndex",r),k(e,r,1)}function _(e,r,n,t){return{row:e,col:r,rows:n,cols:t}}function F(e,r,n,t){return A("calc.lang.gridRange",e),A("calc.lang.gridRange",r),N("calc.lang.gridRange",n),N("calc.lang.gridRange",t),_(e,r,n,t)}function b(e,r){return A("calc.lang.gridCell",e),A("calc.lang.gridCell",r),_(e,r,1,1)}function U(e,r){return{sheet:e,range:r}}var w,P,B,x,V,G,W=U,H=U,K=U;function j(e){return{document:e,index:void 0}}function Q(e,r){return{scope:e,name:r}}function X(e,r,n,t,o,a){(A("calc.lang.functionType",e),0===n.length&&r.length<e)&&C("calc.lang.functionType: expected headTypes.length >= "+e+"; given "+JSON.stringify(r));return{minArgs:e,headTypes:r,restTypes:n,returnType:t,staticPrecs:o,flags:a}}function J(e,r,n,t){return{cells:e,names:r,special:n,isExact:t}}function Y(e){return{kind:w.Error,type:e}}!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(w||(w={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(P||(P={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.All=4095]="All"}(B||(B={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro"}(x||(x={})),function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.FIELD=9]="FIELD"}(V||(V={})),function(e){e[e.First=1]="First",e[e.Last=9]="Last"}(G||(G={}));var q=Y(V.NULL),z=Y(V.DIV0),Z=Y(V.VALUE),$=Y(V.REF),ee=Y(V.NAME),re=Y(V.NUM),ne=Y(V.NA),te=Y(V.GETTING_DATA),oe=Y(V.FIELD);function ae(e,r,n){return A("calc.lang.arrayOper",e),A("calc.lang.arrayOper",r),n.length!==e?C("calc.lang.arrayOper: Inconsistent row number"):{kind:w.Array,rows:e,cols:r,opers:n}}function ie(e,r){return N("calc.lang.rangeSeqOper",r.length),{kind:w.Range,sheets:e,ranges:r}}function ue(e,r){return{kind:w.Range,sheets:e,ranges:[r]}}var ce,le,se,fe,de,Ee,pe={kind:w.Missing},ve={kind:w.Blank};function he(e){return void 0===e&&(e=0),{kind:le.Error,isQuoted:!1,label:e}}function ge(e){return void 0===e&&(e=0),{kind:le.Relative,isQuoted:!1,label:e}}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(ce||(ce={})),function(e){e.Error="Error",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange"}(le||(le={})),function(e){e.Error="Error",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col"}(se||(se={})),function(e){e.Abs="Abs",e.Rel="Rel"}(fe||(fe={})),function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.Bad="Bad",e.Operator="Operator"}(de||(de={})),function(e){e.Unexpected="Unexpected",e.CellRef="CellRef",e.Qualifier="Qualifier",e.Sequence="Sequence"}(Ee||(Ee={}));var Te=he(),me=ge();function Se(e,r,n,t){return void 0===n&&(n=!1),void 0===t&&(t=0),{kind:le.Document,isQuoted:n,label:t,document:e,path:r}}function Re(e,r,n,t){return void 0===n&&(n=!1),void 0===t&&(t=0),{kind:le.Sheet,isQuoted:n,label:t,sheet:e,document:r}}function Ie(e,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:le.Ident,isQuoted:r,label:n,name:e}}function Ce(e,r,n,t){return void 0===n&&(n=!1),void 0===t&&(t=0),{kind:le.SheetRange,isQuoted:n,label:t,sheet1:e,sheet2:r}}function Ae(e,r){return{kind:e,index:r}}function Ne(e){return void 0===e&&(e=0),{kind:se.Error,label:e}}var Oe,ye=Ne();function Le(e,r,n){return void 0===n&&(n=0),{kind:se.Single,label:n,row:e,col:r}}function ke(e,r,n){return void 0===n&&(n=0),{kind:se.Range,label:n,ref1:e,ref2:r}}function De(e,r,n){return void 0===n&&(n=0),{kind:se.Row,label:n,row1:e,row2:r}}function Me(e,r,n){return void 0===n&&(n=0),{kind:se.Col,label:n,col1:e,col2:r}}function _e(e,r){return{node:e,spans:r}}function Fe(e,r,n,t){var o,a;return A("calc.lang.formulaSpan",e),o="calc.lang.formulaSpan",f(a=r)||C(o+": expected integer; given "+v(a)),r<e&&C("calc.lang.formulaSpan: expected end >= "+e+"; given "+r),{start:e,end:r,pre:n,post:t}}function be(e,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:de.Literal,label:n,oper:e,isClosed:r}}function Ue(e,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:de.Array,label:n,nodes:e,isClosed:r}}function we(e,r,n,t){return void 0===n&&(n=!0),void 0===t&&(t=0),{kind:de.App,label:t,head:e,args:r,isClosed:n}}function Pe(e,r){return void 0===r&&(r=0),{kind:de.Operator,label:r,id:e}}function Be(e,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:de.Paren,label:n,node:e,isClosed:r}}function xe(e,r,n){return void 0===n&&(n=0),{kind:de.Name,label:n,whole:e,qualifier:r}}function Ve(e,r,n){return void 0===n&&(n=0),{kind:de.CellRef,label:n,ref:e,qualifier:r}}function Ge(e,r,n){return void 0===n&&(n=0),{kind:de.Bad,label:n,type:e,contents:r}}!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.ERROR_CODE=249]="ERROR_CODE",e[e.ALLOC_COUNT=250]="ALLOC_COUNT",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.DEBUG=524]="DEBUG",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e.IMAGE=612]="IMAGE",e[e.RECORD=613]="RECORD",e[e.RECORDTEST=614]="RECORDTEST",e[e.GRF=615]="GRF",e[e.UNIT=616]="UNIT",e[e.RICHERROR=617]="RICHERROR",e[e.FILTER=618]="FILTER",e[e.FUN=619]="FUN",e[e.LET=620]="LET",e[e.ARRAYMAKE=621]="ARRAYMAKE",e[e.APPLY=622]="APPLY",e[e.ISFUN=623]="ISFUN",e[e.ARITY=624]="ARITY",e[e.RECURSE=625]="RECURSE",e[e.FIELDVALUE=626]="FIELDVALUE"}(Oe||(Oe={}));var We=[];We[Oe.COUNT]=X(1,[],[57],1,0,0),We[Oe.IF]=X(1,[36,575,575],[],567,0,0),We[Oe.ISNA]=X(1,[15],[],4,0,0),We[Oe.ISERROR]=X(1,[15],[],4,0,0),We[Oe.SUM]=X(1,[],[49],1,0,0),We[Oe.AVERAGE]=X(1,[],[49],1,0,0),We[Oe.MIN]=X(1,[],[49],1,0,0),We[Oe.MAX]=X(1,[],[49],1,0,0),We[Oe.ROW]=X(0,[16],[],33,0,0),We[Oe.COLUMN]=X(0,[16],[],33,0,0),We[Oe.NA]=X(0,[],[],3,0,0),We[Oe.NPV]=X(2,[1],[49],1,0,0),We[Oe.STDEV]=X(1,[],[49],1,0,0),We[Oe.DOLLAR]=X(1,[1,1],[],2,0,0),We[Oe.FIXED]=X(1,[1,65,4],[],2,0,0),We[Oe.SIN]=X(1,[1],[],1,0,0),We[Oe.COS]=X(1,[1],[],1,0,0),We[Oe.TAN]=X(1,[1],[],1,0,0),We[Oe.ATAN]=X(1,[1],[],1,0,0),We[Oe.PI]=X(0,[],[],1,0,0),We[Oe.SQRT]=X(1,[1],[],1,0,0),We[Oe.EXP]=X(1,[1],[],1,0,0),We[Oe.LN]=X(1,[1],[],1,0,0),We[Oe.LOG10]=X(1,[1],[],1,0,0),We[Oe.ABS]=X(1,[1],[],1,0,0),We[Oe.INT]=X(1,[1],[],1,0,0),We[Oe.SIGN]=X(1,[1],[],1,0,0),We[Oe.ROUND]=X(2,[1,1],[],1,0,0),We[Oe.LOOKUP]=X(2,[7,48,48],[],7,0,0),We[Oe.INDEX]=X(2,[48,1,1,1],[],55,0,0),We[Oe.REPT]=X(2,[2,1],[],2,0,0),We[Oe.MID]=X(3,[2,1,1],[],2,0,0),We[Oe.LEN]=X(1,[2],[],1,0,0),We[Oe.VALUE]=X(1,[7],[],1,0,0),We[Oe.TRUE]=X(0,[],[],4,0,0),We[Oe.FALSE]=X(0,[],[],4,0,0),We[Oe.AND]=X(1,[],[52],4,0,0),We[Oe.OR]=X(1,[],[52],4,0,0),We[Oe.NOT]=X(1,[4],[],4,0,0),We[Oe.MOD]=X(2,[1,1],[],1,0,0),We[Oe.DCOUNT]=X(3,[16,83,18],[],1,0,0),We[Oe.DSUM]=X(3,[16,19,18],[],1,0,0),We[Oe.DAVERAGE]=X(3,[16,19,18],[],1,0,0),We[Oe.DMIN]=X(3,[16,19,18],[],1,0,0),We[Oe.DMAX]=X(3,[16,19,18],[],1,0,0),We[Oe.DSTDEV]=X(3,[16,19,18],[],1,0,0),We[Oe.VAR]=X(1,[],[49],1,0,0),We[Oe.DVAR]=X(3,[16,19,18],[],1,0,0),We[Oe.TEXT]=X(2,[7,2],[],2,0,0),We[Oe.LINEST]=X(1,[48,112,84,84],[],32,0,0),We[Oe.TREND]=X(1,[48,112,112,84],[],32,0,0),We[Oe.LOGEST]=X(1,[48,112,84,84],[],32,0,0),We[Oe.GROWTH]=X(1,[48,112,112,84],[],32,0,0),We[Oe.GOTO]=X(1,[16],[],512,0,2),We[Oe.HALT]=X(0,[4],[],512,0,2),We[Oe.RETURN]=X(0,[575],[],512,0,2),We[Oe.PV]=X(3,[1,1,1,1,1],[],1,0,0),We[Oe.FV]=X(3,[1,1,1,1,1],[],1,0,0),We[Oe.NPER]=X(3,[1,1,1,1,1],[],1,0,0),We[Oe.PMT]=X(3,[1,1,1,1,1],[],1,0,0),We[Oe.RATE]=X(3,[1,1,1,1,1,1],[],1,0,0),We[Oe.MIRR]=X(3,[48,1,1],[],1,0,0),We[Oe.IRR]=X(1,[48,1],[],1,0,0),We[Oe.RAND]=X(0,[],[],1,4095,0),We[Oe.MATCH]=X(2,[7,49,17],[],1,0,0),We[Oe.DATE]=X(3,[1,1,1],[],1,0,0),We[Oe.TIME]=X(3,[1,1,1],[],1,0,0),We[Oe.DAY]=X(1,[1],[],1,0,0),We[Oe.MONTH]=X(1,[1],[],1,0,0),We[Oe.YEAR]=X(1,[1],[],1,0,0),We[Oe.WEEKDAY]=X(1,[1,1],[],1,0,0),We[Oe.HOUR]=X(1,[1],[],1,0,0),We[Oe.MINUTE]=X(1,[1],[],1,0,0),We[Oe.SECOND]=X(1,[1],[],1,0,0),We[Oe.NOW]=X(0,[],[],1,4095,0),We[Oe.AREAS]=X(1,[16],[],1,0,0),We[Oe.ROWS]=X(1,[48],[],1,0,0),We[Oe.COLUMNS]=X(1,[48],[],1,0,0),We[Oe.OFFSET]=X(3,[16,65,65,65,65],[],16,4095,0),We[Oe.ABSREF]=X(2,[2,16],[],16,0,2),We[Oe.RELREF]=X(2,[16,16],[],2,0,2),We[Oe.ARGUMENT]=X(0,[66,81,16],[],4,0,2),We[Oe.SEARCH]=X(2,[2,2,1],[],1,0,0),We[Oe.TRANSPOSE]=X(1,[39],[],32,0,0),We[Oe.ERROR]=X(0,[1,24],[],4,0,2),We[Oe.STEP]=X(0,[],[],4,0,2),We[Oe.TYPE]=X(1,[47],[],1,0,0),We[Oe.ECHO]=X(0,[4],[],4,0,2),We[Oe.SET_NAME]=X(1,[2,63],[],4,0,2),We[Oe.CALLER]=X(0,[],[],50,0,2),We[Oe.DEREF]=X(1,[16],[],47,0,2),We[Oe.WINDOWS]=X(0,[65,66],[],32,0,2),We[Oe.SERIES]=X(4,[87,117,117,1,117],[],4,0,0),We[Oe.DOCUMENTS]=X(0,[1,66],[],32,0,2),We[Oe.ACTIVE_CELL]=X(0,[],[],16,0,2),We[Oe.SELECTION]=X(0,[],[],16,0,2),We[Oe.RESULT]=X(0,[1],[],4,0,2),We[Oe.ATAN2]=X(2,[1,1],[],1,0,0),We[Oe.ASIN]=X(1,[1],[],1,0,0),We[Oe.ACOS]=X(1,[1],[],1,0,0),We[Oe.CHOOSE]=X(2,[33],[575],567,0,0),We[Oe.HLOOKUP]=X(3,[7,49,49,4],[],39,0,0),We[Oe.VLOOKUP]=X(3,[7,49,49,4],[],39,0,0),We[Oe.LINKS]=X(0,[66,65],[],32,0,2),We[Oe.INPUT]=X(1,[2,65,66,67,65,65,2],[],575,0,2),We[Oe.ISREF]=X(1,[63],[],4,0,0),We[Oe.GET_FORMULA]=X(1,[18],[],2,0,2),We[Oe.GET_NAME]=X(1,[2,4],[],6,0,2),We[Oe.SET_VALUE]=X(2,[16,47],[],4,0,2),We[Oe.LOG]=X(1,[1,1],[],1,0,0),We[Oe.EXEC]=X(1,[2,1,4,4],[],7,0,2),We[Oe.CHAR]=X(1,[1],[],2,0,0),We[Oe.LOWER]=X(1,[2],[],2,0,0),We[Oe.UPPER]=X(1,[2],[],2,0,0),We[Oe.PROPER]=X(1,[2],[],2,0,0),We[Oe.LEFT]=X(1,[2,9],[],2,0,0),We[Oe.RIGHT]=X(1,[2,9],[],2,0,0),We[Oe.EXACT]=X(2,[2,2],[],4,0,0),We[Oe.TRIM]=X(1,[2],[],2,0,0),We[Oe.REPLACE]=X(4,[2,1,1,2],[],2,0,0),We[Oe.SUBSTITUTE]=X(3,[2,2,2,2],[],2,0,0),We[Oe.CODE]=X(1,[2],[],1,0,0),We[Oe.NAMES]=X(0,[66,65,66],[],32,0,2),We[Oe.DIRECTORY]=X(0,[2],[],2,0,2),We[Oe.FIND]=X(2,[2,2,1],[],1,0,0),We[Oe.CELL]=X(1,[2,16],[],47,4095,0),We[Oe.ISERR]=X(1,[15],[],4,0,0),We[Oe.ISTEXT]=X(1,[143],[],4,0,0),We[Oe.ISNUMBER]=X(1,[143],[],4,0,0),We[Oe.ISBLANK]=X(1,[143],[],4,0,0),We[Oe.T]=X(1,[23],[],2,0,0),We[Oe.N]=X(1,[23],[],1,0,0),We[Oe.FOPEN]=X(1,[2,1],[],1,0,2),We[Oe.FCLOSE]=X(1,[1],[],1,0,2),We[Oe.FSIZE]=X(1,[1],[],1,0,2),We[Oe.FREADLN]=X(1,[1],[],2,0,2),We[Oe.FREAD]=X(2,[1,1],[],2,0,2),We[Oe.FWRITELN]=X(2,[1,2],[],1,0,2),We[Oe.FWRITE]=X(2,[1,2],[],1,0,2),We[Oe.FPOS]=X(1,[1,1],[],1,0,2),We[Oe.DATEVALUE]=X(1,[3],[],1,0,0),We[Oe.TIMEVALUE]=X(1,[3],[],1,0,0),We[Oe.SLN]=X(3,[1,1,1],[],1,0,0),We[Oe.SYD]=X(4,[1,1,1,1],[],1,0,0),We[Oe.DDB]=X(4,[1,1,1,1,1],[],1,0,0),We[Oe.GET_DEF]=X(1,[2,66,65],[],2,0,2),We[Oe.REFTEXT]=X(1,[16,4],[],2,0,2),We[Oe.TEXTREF]=X(1,[2,4],[],16,0,2),We[Oe.INDIRECT]=X(1,[2,4],[],16,4095,0),We[Oe.REGISTER]=X(1,[2,3,66,66,66,65,67,66,67],[66],3,0,2),We[Oe.CALL]=X(1,[3],[127],575,0,2),We[Oe.ADD_BAR]=X(0,[3],[],1,0,2),We[Oe.ADD_MENU]=X(2,[3,115,83,3],[],1,0,2),We[Oe.ADD_COMMAND]=X(3,[3,83,115,83,3],[],1,0,2),We[Oe.ENABLE_COMMAND]=X(4,[3,3,3,4,3],[],4,0,2),We[Oe.CHECK_COMMAND]=X(4,[3,3,3,4,3],[],4,0,2),We[Oe.RENAME_COMMAND]=X(4,[3,3,3,3,3],[],4,0,2),We[Oe.SHOW_BAR]=X(0,[3],[],4,0,2),We[Oe.DELETE_MENU]=X(2,[3,3,3],[],4,0,2),We[Oe.DELETE_COMMAND]=X(3,[3,3,3,3],[],4,0,2),We[Oe.GET_CHART_ITEM]=X(1,[1,67,66],[],1,0,2),We[Oe.DIALOG_BOX]=X(1,[52],[],36,0,2),We[Oe.CLEAN]=X(1,[2],[],2,0,0),We[Oe.MDETERM]=X(1,[32],[],1,0,0),We[Oe.MINVERSE]=X(1,[32],[],32,0,0),We[Oe.MMULT]=X(2,[32,32],[],32,0,0),We[Oe.FILES]=X(0,[2,2],[],32,0,2),We[Oe.IPMT]=X(4,[1,1,1,1,1,1],[],1,0,0),We[Oe.PPMT]=X(4,[1,1,1,1,1,1],[],1,0,0),We[Oe.COUNTA]=X(1,[],[121],1,0,0),We[Oe.CANCEL_KEY]=X(0,[1,16],[],4,0,2),We[Oe.FOR]=X(3,[2,1,1,1],[],512,0,2),We[Oe.WHILE]=X(1,[4],[],512,0,2),We[Oe.BREAK]=X(0,[],[],512,0,2),We[Oe.NEXT]=X(0,[],[],512,0,2),We[Oe.INITIATE]=X(2,[2,2],[],1,0,2),We[Oe.REQUEST]=X(2,[1,2],[],32,0,2),We[Oe.POKE]=X(3,[1,18,18],[],4,0,2),We[Oe.EXECUTE]=X(2,[1,2],[],4,0,2),We[Oe.TERMINATE]=X(1,[1],[],4,0,2),We[Oe.RESTART]=X(0,[1],[],512,0,2),We[Oe.HELP]=X(0,[2],[],4,0,2),We[Oe.GET_BAR]=X(0,[3,3,3,3],[],3,0,2),We[Oe.PRODUCT]=X(1,[],[113],1,0,0),We[Oe.FACT]=X(1,[1],[],1,0,0),We[Oe.GET_CELL]=X(1,[1,16],[],47,0,2),We[Oe.GET_WORKSPACE]=X(1,[1],[],47,0,2),We[Oe.GET_WINDOW]=X(1,[1,2],[],47,0,2),We[Oe.GET_DOCUMENT]=X(1,[1,2],[],63,0,2),We[Oe.DPRODUCT]=X(3,[16,19,18],[],1,0,0),We[Oe.ISNONTEXT]=X(1,[143],[],4,0,0),We[Oe.GET_NOTE]=X(0,[82,65,65],[],2,0,2),We[Oe.NOTE]=X(0,[66,82,17,17],[],1,0,2),We[Oe.STDEVP]=X(1,[],[49],1,0,0),We[Oe.VARP]=X(1,[],[49],1,0,0),We[Oe.DSTDEVP]=X(3,[16,19,18],[],1,0,0),We[Oe.DVARP]=X(3,[16,19,18],[],1,0,0),We[Oe.TRUNC]=X(1,[1,1],[],1,0,0),We[Oe.ISLOGICAL]=X(1,[143],[],4,0,0),We[Oe.DCOUNTA]=X(3,[16,83,18],[],1,0,0),We[Oe.DELETE_BAR]=X(1,[3],[],4,0,2),We[Oe.UNREGISTER]=X(1,[3],[],4,0,2),We[Oe.USDOLLAR]=X(1,[1,1],[],2,0,0),We[Oe.FINDB]=X(2,[2,2,1],[],1,0,0),We[Oe.SEARCHB]=X(2,[2,2,1],[],1,0,0),We[Oe.REPLACEB]=X(4,[2,1,1,2],[],2,0,0),We[Oe.LEFTB]=X(1,[2,9],[],2,0,0),We[Oe.RIGHTB]=X(1,[2,9],[],2,0,0),We[Oe.MIDB]=X(3,[2,1,1],[],2,0,0),We[Oe.LENB]=X(1,[2],[],1,0,0),We[Oe.ROUNDUP]=X(2,[1,1],[],1,0,0),We[Oe.ROUNDDOWN]=X(2,[1,1],[],1,0,0),We[Oe.ASC]=X(1,[2],[],2,0,0),We[Oe.DBCS]=X(1,[2],[],2,0,0),We[Oe.RANK]=X(2,[1,16,4],[],1,0,0),We[Oe.ADDRESS]=X(2,[1,65,65,68,66],[],2,0,0),We[Oe.DAYS360]=X(2,[1,1,4],[],1,0,0),We[Oe.TODAY]=X(0,[],[],1,4095,0),We[Oe.VDB]=X(5,[1,1,1,1,1,1,4],[],1,0,0),We[Oe.ELSE]=X(0,[],[],512,0,2),We[Oe.ELSE_IF]=X(1,[12],[],512,0,2),We[Oe.END_IF]=X(0,[],[],512,0,2),We[Oe.FOR_CELL]=X(1,[2,82,84],[],512,0,2),We[Oe.MEDIAN]=X(1,[],[49],1,0,0),We[Oe.SUMPRODUCT]=X(1,[],[32],1,0,0),We[Oe.SINH]=X(1,[1],[],1,0,0),We[Oe.COSH]=X(1,[1],[],1,0,0),We[Oe.TANH]=X(1,[1],[],1,0,0),We[Oe.ASINH]=X(1,[1],[],1,0,0),We[Oe.ACOSH]=X(1,[1],[],1,0,0),We[Oe.ATANH]=X(1,[1],[],1,0,0),We[Oe.DGET]=X(3,[16,19,18],[],7,0,0),We[Oe.CREATE_OBJECT]=X(2,[1,18,17,17,18,17,17,115,84,21,17],[],2,0,2),We[Oe.VOLATILE]=X(0,[4],[],4,0,2),We[Oe.LAST_ERROR]=X(0,[],[],16,0,2),We[Oe.CUSTOM_UNDO]=X(0,[2,2],[],4,0,2),We[Oe.CUSTOM_REPEAT]=X(0,[2,2,2],[],4,0,2),We[Oe.FORMULA_CONVERT]=X(2,[2,23,23,23,23],[],2,0,2),We[Oe.GET_LINK_INFO]=X(2,[2,1,1,2],[],1,0,2),We[Oe.TEXT_BOX]=X(1,[2,66,65,65],[],1,0,2),We[Oe.INFO]=X(1,[2],[],3,4095,0),We[Oe.GROUP]=X(0,[],[],2,0,2),We[Oe.GET_OBJECT]=X(1,[1,2,1,1,1],[],47,0,2),We[Oe.DB]=X(4,[1,1,1,1,1],[],1,0,0),We[Oe.PAUSE]=X(0,[4],[],512,0,2),We[Oe.ERROR_CODE]=X(0,[],[],2,0,2),We[Oe.ALLOC_COUNT]=X(0,[],[],1,0,2),We[Oe.RESUME]=X(0,[1],[],512,0,2),We[Oe.FREQUENCY]=X(2,[48,48],[],32,0,0),We[Oe.ADD_TOOLBAR]=X(0,[66,96],[],2,0,2),We[Oe.DELETE_TOOLBAR]=X(1,[2],[],4,0,2),We[Oe._UDF]=X(1,[17],[127],575,0,0),We[Oe.RESET_TOOLBAR]=X(1,[3],[],4,0,2),We[Oe.EVALUATE]=X(1,[2],[],63,0,2),We[Oe.GET_TOOLBAR]=X(1,[1,3],[],47,0,2),We[Oe.GET_TOOL]=X(1,[1,3,1],[],47,0,2),We[Oe.SPELLING_CHECK]=X(1,[2,66,4],[],4,0,2),We[Oe.ERROR_TYPE]=X(1,[15],[],1,0,0),We[Oe.APP_TITLE]=X(0,[2],[],4,0,2),We[Oe.WINDOW_TITLE]=X(0,[2],[],4,0,2),We[Oe.SAVE_TOOLBAR]=X(0,[99,66],[],4,0,2),We[Oe.ENABLE_TOOL]=X(3,[3,1,4],[],4,0,2),We[Oe.PRESS_TOOL]=X(3,[3,1,4],[],4,0,2),We[Oe.REGISTER_ID]=X(2,[2,3,66],[],1,0,2),We[Oe.GET_PROJECT]=X(1,[1,2],[],35,0,2),We[Oe.AVEDEV]=X(1,[],[49],1,0,0),We[Oe.BETADIST]=X(3,[1,1,1,65,65],[],1,0,0),We[Oe.GAMMALN]=X(1,[1],[],1,0,0),We[Oe.BETAINV]=X(3,[1,1,1,65,65],[],1,0,0),We[Oe.BINOMDIST]=X(4,[1,1,1,4],[],1,0,0),We[Oe.CHIDIST]=X(2,[1,1],[],1,0,0),We[Oe.CHIINV]=X(2,[1,1],[],1,0,0),We[Oe.COMBIN]=X(2,[1,1],[],1,0,0),We[Oe.CONFIDENCE]=X(3,[1,1,1],[],1,0,0),We[Oe.CRITBINOM]=X(3,[1,1,1],[],1,0,0),We[Oe.EVEN]=X(1,[1],[],1,0,0),We[Oe.EXPONDIST]=X(3,[1,1,4],[],1,0,0),We[Oe.FDIST]=X(3,[1,1,1],[],1,0,0),We[Oe.FINV]=X(3,[1,1,1],[],1,0,0),We[Oe.FISHER]=X(1,[1],[],1,0,0),We[Oe.FISHERINV]=X(1,[1],[],1,0,0),We[Oe.FLOOR]=X(2,[1,1],[],1,0,0),We[Oe.GAMMADIST]=X(4,[1,1,1,4],[],1,0,0),We[Oe.GAMMAINV]=X(3,[1,1,1],[],1,0,0),We[Oe.CEILING]=X(2,[1,1],[],1,0,0),We[Oe.HYPGEOMDIST]=X(4,[1,1,1,1],[],1,0,0),We[Oe.LOGNORMDIST]=X(3,[1,1,1],[],1,0,0),We[Oe.LOGINV]=X(3,[1,1,1],[],1,0,0),We[Oe.NEGBINOMDIST]=X(3,[1,1,1],[],1,0,0),We[Oe.NORMDIST]=X(4,[1,1,1,4],[],1,0,0),We[Oe.NORMSDIST]=X(1,[1],[],1,0,0),We[Oe.NORMINV]=X(3,[1,1,1],[],1,0,0),We[Oe.NORMSINV]=X(1,[1],[],1,0,0),We[Oe.STANDARDIZE]=X(3,[1,1,1],[],1,0,0),We[Oe.ODD]=X(1,[1],[],1,0,0),We[Oe.PERMUT]=X(2,[1,1],[],1,0,0),We[Oe.POISSON]=X(3,[1,1,4],[],1,0,0),We[Oe.TDIST]=X(3,[1,1,1],[],1,0,0),We[Oe.WEIBULL]=X(4,[1,1,1,4],[],1,0,0),We[Oe.SUMXMY2]=X(2,[32,32],[],1,0,0),We[Oe.SUMX2MY2]=X(2,[32,32],[],1,0,0),We[Oe.SUMX2PY2]=X(2,[32,32],[],1,0,0),We[Oe.CHITEST]=X(2,[32,32],[],1,0,0),We[Oe.CORREL]=X(2,[32,32],[],1,0,0),We[Oe.COVAR]=X(2,[32,32],[],1,0,0),We[Oe.FORECAST]=X(3,[1,32,32],[],1,0,0),We[Oe.FTEST]=X(2,[32,32],[],1,0,0),We[Oe.INTERCEPT]=X(2,[32,32],[],1,0,0),We[Oe.PEARSON]=X(2,[32,32],[],1,0,0),We[Oe.RSQ]=X(2,[32,32],[],1,0,0),We[Oe.STEYX]=X(2,[32,32],[],1,0,0),We[Oe.SLOPE]=X(2,[32,32],[],1,0,0),We[Oe.TTEST]=X(4,[32,32,1,1],[],1,0,0),We[Oe.PROB]=X(3,[32,32,1,65],[],1,0,0),We[Oe.DEVSQ]=X(1,[],[49],1,0,0),We[Oe.GEOMEAN]=X(1,[],[49],1,0,0),We[Oe.HARMEAN]=X(1,[],[49],1,0,0),We[Oe.SUMSQ]=X(1,[],[49],1,0,0),We[Oe.KURT]=X(1,[],[49],1,0,0),We[Oe.SKEW]=X(1,[],[49],1,0,0),We[Oe.ZTEST]=X(2,[49,1,1],[],1,0,0),We[Oe.LARGE]=X(2,[49,1],[],1,0,0),We[Oe.SMALL]=X(2,[49,1],[],1,0,0),We[Oe.QUARTILE]=X(2,[49,1],[],1,0,0),We[Oe.PERCENTILE]=X(2,[49,1],[],1,0,0),We[Oe.PERCENTRANK]=X(2,[49,1,65],[],1,0,0),We[Oe.MODE]=X(1,[],[32],1,0,0),We[Oe.TRIMMEAN]=X(2,[49,1],[],1,0,0),We[Oe.TINV]=X(2,[1,1],[],1,0,0),We[Oe.MOVIE_COMMAND]=X(3,[2,1,1,1],[],1,0,2),We[Oe.GET_MOVIE]=X(2,[2,1,1],[],1,0,2),We[Oe.CONCATENATE]=X(1,[],[2],2,0,0),We[Oe.POWER]=X(2,[1,1],[],1,0,0),We[Oe.SPREADBASE_DATA_FIELD]=X(2,[66,2,66,65,65,65,66,66,66],[],2,0,2),We[Oe.GET_VIEW]=X(1,[1,2],[],35,0,2),We[Oe.GET_FIELD]=X(1,[1,66,2],[],35,0,2),We[Oe.GET_ITEM]=X(1,[1,66,66,2],[],7,0,2),We[Oe.RADIANS]=X(1,[1],[],1,0,0),We[Oe.DEGREES]=X(1,[1],[],1,0,0),We[Oe.SUBTOTAL]=X(2,[1],[16],1,0,0),We[Oe.SUMIF]=X(2,[16,15,16],[],1,0,0),We[Oe.COUNTIF]=X(2,[16,15],[],1,0,0),We[Oe.COUNTBLANK]=X(1,[16],[],1,0,0),We[Oe.SCENARIO_GET]=X(1,[1,2],[],19,0,2),We[Oe.OPTIONS_LISTS]=X(1,[33],[],33,0,2),We[Oe.ISPMT]=X(4,[1,1,1,1],[],1,0,0),We[Oe.DATEDIF]=X(3,[1,1,2],[],1,0,0),We[Oe.DATESTRING]=X(1,[1],[],2,0,0),We[Oe.NUMBERSTRING]=X(2,[1,1],[],2,0,0),We[Oe.ROMAN]=X(1,[1,5],[],2,0,0),We[Oe.OPENDIALOG]=X(0,[66,66,66,65],[],6,0,2),We[Oe.SAVEDIALOG]=X(0,[66,66,66,66,65],[],6,0,2),We[Oe.VIEW_GET]=X(1,[1,2],[],19,0,2),We[Oe.GETPIVOTDATA]=X(2,[18,18],[2,79],15,0,0),We[Oe.HYPERLINK]=X(1,[2,39],[],39,0,0),We[Oe.FURIGANA]=X(1,[16],[],2,0,0),We[Oe.AVERAGEA]=X(1,[],[49],1,0,0),We[Oe.MAXA]=X(1,[],[49],1,0,0),We[Oe.MINA]=X(1,[],[49],1,0,0),We[Oe.STDEVPA]=X(1,[],[49],1,0,0),We[Oe.VARPA]=X(1,[],[49],1,0,0),We[Oe.STDEVA]=X(1,[],[49],1,0,0),We[Oe.VARA]=X(1,[],[49],1,0,0),We[Oe.BAHTTEXT]=X(1,[1],[],2,0,0),We[Oe.THAIDOW]=X(1,[1],[],2,0,0),We[Oe.THAIDIGIT]=X(1,[3],[],2,0,0),We[Oe.THAIMOY]=X(1,[1],[],2,0,0),We[Oe.THAINUMSOUND]=X(1,[1],[],2,0,0),We[Oe.THAINUMSTRING]=X(1,[1],[],2,0,0),We[Oe.THAISTRINGLENGTH]=X(1,[2],[],1,0,0),We[Oe.ISTHAIDIGIT]=X(1,[2],[],4,0,0),We[Oe.ROUNDBAHTDOWN]=X(1,[1],[],1,0,0),We[Oe.ROUNDBAHTUP]=X(1,[1],[],1,0,0),We[Oe.THAIYEAR]=X(1,[1],[],1,0,0),We[Oe.RTD]=X(3,[],[2],2,0,0),We[Oe.CUBEVALUE]=X(1,[2],[50],15,0,0),We[Oe.CUBEMEMBER]=X(2,[2,50,2],[],10,0,0),We[Oe.CUBEMEMBERPROPERTY]=X(3,[2,2,2],[],15,0,0),We[Oe.CUBERANKEDMEMBER]=X(3,[2,2,1,2],[],10,0,0),We[Oe.HEX2BIN]=X(1,[95,95],[],9,0,0),We[Oe.HEX2DEC]=X(1,[95],[],9,0,0),We[Oe.HEX2OCT]=X(1,[95,95],[],9,0,0),We[Oe.DEC2BIN]=X(1,[95,95],[],9,0,0),We[Oe.DEC2HEX]=X(1,[95,95],[],9,0,0),We[Oe.DEC2OCT]=X(1,[95,95],[],9,0,0),We[Oe.OCT2BIN]=X(1,[95,95],[],9,0,0),We[Oe.OCT2HEX]=X(1,[95,95],[],9,0,0),We[Oe.OCT2DEC]=X(1,[95],[],9,0,0),We[Oe.BIN2DEC]=X(1,[95],[],9,0,0),We[Oe.BIN2OCT]=X(1,[95,95],[],9,0,0),We[Oe.BIN2HEX]=X(1,[95,95],[],9,0,0),We[Oe.IMSUB]=X(2,[95,95],[],9,0,0),We[Oe.IMDIV]=X(2,[95,95],[],9,0,0),We[Oe.IMPOWER]=X(2,[95,95],[],9,0,0),We[Oe.IMABS]=X(1,[95],[],9,0,0),We[Oe.IMSQRT]=X(1,[95],[],9,0,0),We[Oe.IMLN]=X(1,[95],[],9,0,0),We[Oe.IMLOG2]=X(1,[95],[],9,0,0),We[Oe.IMLOG10]=X(1,[95],[],9,0,0),We[Oe.IMSIN]=X(1,[95],[],9,0,0),We[Oe.IMCOS]=X(1,[95],[],9,0,0),We[Oe.IMEXP]=X(1,[95],[],9,0,0),We[Oe.IMARGUMENT]=X(1,[95],[],9,0,0),We[Oe.IMCONJUGATE]=X(1,[95],[],9,0,0),We[Oe.IMAGINARY]=X(1,[95],[],9,0,0),We[Oe.IMREAL]=X(1,[95],[],9,0,0),We[Oe.COMPLEX]=X(2,[95,95,95],[],9,0,0),We[Oe.IMSUM]=X(1,[],[127],9,0,0),We[Oe.IMPRODUCT]=X(1,[],[127],9,0,0),We[Oe.SERIESSUM]=X(4,[95,95,95,127],[],9,0,0),We[Oe.FACTDOUBLE]=X(1,[95],[],9,0,0),We[Oe.SQRTPI]=X(1,[95],[],9,0,0),We[Oe.QUOTIENT]=X(2,[95,95],[],9,0,0),We[Oe.DELTA]=X(1,[95,95],[],9,0,0),We[Oe.GESTEP]=X(1,[95,95],[],9,0,0),We[Oe.ISEVEN]=X(1,[95],[],9,0,0),We[Oe.ISODD]=X(1,[95],[],9,0,0),We[Oe.MROUND]=X(2,[95,95],[],9,0,0),We[Oe.ERF]=X(1,[95,95],[],9,0,0),We[Oe.ERFC]=X(1,[95],[],9,0,0),We[Oe.BESSELJ]=X(2,[95,95],[],9,0,0),We[Oe.BESSELK]=X(2,[95,95],[],9,0,0),We[Oe.BESSELY]=X(2,[95,95],[],9,0,0),We[Oe.BESSELI]=X(2,[95,95],[],9,0,0),We[Oe.XIRR]=X(2,[127,127,95],[],9,0,0),We[Oe.XNPV]=X(3,[95,127,127],[],9,0,0),We[Oe.PRICEMAT]=X(5,[95,95,95,95,95,95],[],9,0,0),We[Oe.YIELDMAT]=X(5,[95,95,95,95,95,95],[],9,0,0),We[Oe.INTRATE]=X(4,[95,95,95,95,95],[],9,0,0),We[Oe.RECEIVED]=X(4,[95,95,95,95,95],[],9,0,0),We[Oe.DISC]=X(4,[95,95,95,95,95],[],9,0,0),We[Oe.PRICEDISC]=X(4,[95,95,95,95,95],[],9,0,0),We[Oe.YIELDDISC]=X(4,[95,95,95,95,95],[],9,0,0),We[Oe.TBILLEQ]=X(3,[95,95,95],[],9,0,0),We[Oe.TBILLPRICE]=X(3,[95,95,95],[],9,0,0),We[Oe.TBILLYIELD]=X(3,[95,95,95],[],9,0,0),We[Oe.PRICE]=X(6,[95,95,95,95,95,95,95],[],9,0,0),We[Oe.YIELD]=X(6,[95,95,95,95,95,95,95],[],9,0,0),We[Oe.DOLLARDE]=X(2,[95,95],[],9,0,0),We[Oe.DOLLARFR]=X(2,[95,95],[],9,0,0),We[Oe.NOMINAL]=X(2,[95,95],[],9,0,0),We[Oe.EFFECT]=X(2,[95,95],[],9,0,0),We[Oe.CUMPRINC]=X(6,[95,95,95,95,95,95],[],9,0,0),We[Oe.CUMIPMT]=X(6,[95,95,95,95,95,95],[],9,0,0),We[Oe.EDATE]=X(2,[95,95],[],9,0,0),We[Oe.EOMONTH]=X(2,[95,95],[],9,0,0),We[Oe.YEARFRAC]=X(2,[95,95,95],[],9,0,0),We[Oe.COUPDAYBS]=X(3,[95,95,95,95],[],9,0,0),We[Oe.COUPDAYS]=X(3,[95,95,95,95],[],9,0,0),We[Oe.COUPDAYSNC]=X(3,[95,95,95,95],[],9,0,0),We[Oe.COUPNCD]=X(3,[95,95,95,95],[],9,0,0),We[Oe.COUPNUM]=X(3,[95,95,95,95],[],9,0,0),We[Oe.COUPPCD]=X(3,[95,95,95,95],[],9,0,0),We[Oe.DURATION]=X(5,[95,95,95,95,95,95],[],9,0,0),We[Oe.MDURATION]=X(5,[95,95,95,95,95,95],[],9,0,0),We[Oe.ODDLPRICE]=X(7,[95,95,95,95,95,95,95,95],[],9,0,0),We[Oe.ODDLYIELD]=X(7,[95,95,95,95,95,95,95,95],[],9,0,0),We[Oe.ODDFPRICE]=X(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),We[Oe.ODDFYIELD]=X(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),We[Oe.RANDBETWEEN]=X(2,[95,95],[],9,4095,0),We[Oe.WEEKNUM]=X(1,[95,95],[],9,0,0),We[Oe.AMORDEGRC]=X(6,[95,95,95,95,95,95,95],[],9,0,0),We[Oe.AMORLINC]=X(6,[95,95,95,95,95,95,95],[],9,0,0),We[Oe.CONVERT]=X(3,[95,95,95],[],9,0,0),We[Oe.ACCRINT]=X(6,[95,95,95,95,95,95,95,95],[],9,0,0),We[Oe.ACCRINTM]=X(4,[95,95,95,95,95],[],9,0,0),We[Oe.WORKDAY]=X(2,[95,95,127],[],9,0,0),We[Oe.NETWORKDAYS]=X(2,[95,95,127],[],9,0,0),We[Oe.GCD]=X(1,[],[127],9,0,0),We[Oe.MULTINOMIAL]=X(1,[],[127],9,0,0),We[Oe.LCM]=X(1,[],[127],9,0,0),We[Oe.FVSCHEDULE]=X(2,[95,127],[],9,0,0),We[Oe.CUBEKPIMEMBER]=X(3,[2,2,1,2],[],10,0,0),We[Oe.CUBESET]=X(2,[2,50,2,1,2],[],10,0,0),We[Oe.CUBESETCOUNT]=X(1,[2],[],9,0,0),We[Oe.IFERROR]=X(2,[47,575],[],47,0,0),We[Oe.COUNTIFS]=X(2,[],[16,15],1,0,0),We[Oe.SUMIFS]=X(3,[16],[16,15],1,0,0),We[Oe.AVERAGEIF]=X(2,[16,15,16],[],1,0,0),We[Oe.AVERAGEIFS]=X(3,[16],[16,15],1,0,0),We[Oe.AGGREGATE]=X(3,[1,1,48,17],[16],1,0,0),We[Oe.BINOM_DIST]=X(4,[1,1,1,4],[],1,0,0),We[Oe.BINOM_INV]=X(3,[1,1,1],[],1,0,0),We[Oe.CONFIDENCE_NORM]=X(3,[1,1,1],[],1,0,0),We[Oe.CONFIDENCE_T]=X(3,[1,1,1],[],1,0,0),We[Oe.CHISQ_TEST]=X(2,[32,32],[],1,0,0),We[Oe.F_TEST]=X(2,[32,32],[],1,0,0),We[Oe.COVARIANCE_P]=X(2,[32,32],[],1,0,0),We[Oe.COVARIANCE_S]=X(2,[32,32],[],1,0,0),We[Oe.EXPON_DIST]=X(3,[1,1,4],[],1,0,0),We[Oe.GAMMA_DIST]=X(4,[1,1,1,4],[],1,0,0),We[Oe.GAMMA_INV]=X(3,[1,1,1],[],1,0,0),We[Oe.MODE_MULT]=X(1,[],[32],32,0,0),We[Oe.MODE_SNGL]=X(1,[],[32],1,0,0),We[Oe.NORM_DIST]=X(4,[1,1,1,4],[],1,0,0),We[Oe.NORM_INV]=X(3,[1,1,1],[],1,0,0),We[Oe.PERCENTILE_EXC]=X(2,[49,1],[],1,0,0),We[Oe.PERCENTILE_INC]=X(2,[49,1],[],1,0,0),We[Oe.PERCENTRANK_EXC]=X(2,[49,1,65],[],1,0,0),We[Oe.PERCENTRANK_INC]=X(2,[49,1,65],[],1,0,0),We[Oe.POISSON_DIST]=X(3,[1,1,4],[],1,0,0),We[Oe.QUARTILE_EXC]=X(2,[49,1],[],1,0,0),We[Oe.QUARTILE_INC]=X(2,[49,1],[],1,0,0),We[Oe.RANK_AVG]=X(2,[1,16,4],[],1,0,0),We[Oe.RANK_EQ]=X(2,[1,16,4],[],1,0,0),We[Oe.STDEV_S]=X(1,[],[49],1,0,0),We[Oe.STDEV_P]=X(1,[],[49],1,0,0),We[Oe.T_DIST]=X(3,[1,1,4],[],1,0,0),We[Oe.T_DIST_2T]=X(2,[1,1],[],1,0,0),We[Oe.T_DIST_RT]=X(2,[1,1],[],1,0,0),We[Oe.T_INV]=X(2,[1,1],[],1,0,0),We[Oe.T_INV_2T]=X(2,[1,1],[],1,0,0),We[Oe.VAR_S]=X(1,[],[49],1,0,0),We[Oe.VAR_P]=X(1,[],[49],1,0,0),We[Oe.WEIBULL_DIST]=X(4,[1,1,1,4],[],1,0,0),We[Oe.NETWORKDAYS_INTL]=X(2,[95,95,75,127],[],9,0,0),We[Oe.WORKDAY_INTL]=X(2,[95,95,75,127],[],9,0,0),We[Oe.ECMA_CEILING]=X(2,[1,1],[],1,0,0),We[Oe.ISO_CEILING]=X(1,[1,65],[],1,0,0),We[Oe.DEBUG]=X(1,[2],[1151],1087,0,0),We[Oe.BETA_DIST]=X(4,[1,1,1,4,65,65],[],1,0,0),We[Oe.BETA_INV]=X(3,[1,1,1,65,65],[],1,0,0),We[Oe.CHISQ_DIST]=X(3,[1,1,4],[],1,0,0),We[Oe.CHISQ_DIST_RT]=X(2,[1,1],[],1,0,0),We[Oe.CHISQ_INV]=X(2,[1,1],[],1,0,0),We[Oe.CHISQ_INV_RT]=X(2,[1,1],[],1,0,0),We[Oe.F_DIST]=X(4,[1,1,1,4],[],1,0,0),We[Oe.F_DIST_RT]=X(3,[1,1,1],[],1,0,0),We[Oe.F_INV]=X(3,[1,1,1],[],1,0,0),We[Oe.F_INV_RT]=X(3,[1,1,1],[],1,0,0),We[Oe.HYPGEOM_DIST]=X(5,[1,1,1,1,4],[],1,0,0),We[Oe.LOGNORM_DIST]=X(4,[1,1,1,4],[],1,0,0),We[Oe.LOGNORM_INV]=X(3,[1,1,1],[],1,0,0),We[Oe.NEGBINOM_DIST]=X(4,[1,1,1,4],[],1,0,0),We[Oe.NORM_S_DIST]=X(2,[1,4],[],1,0,0),We[Oe.NORM_S_INV]=X(1,[1],[],1,0,0),We[Oe.T_TEST]=X(4,[32,32,1,1],[],1,0,0),We[Oe.Z_TEST]=X(2,[49,1,1],[],1,0,0),We[Oe.ERF_PRECISE]=X(1,[95],[],9,0,0),We[Oe.ERFC_PRECISE]=X(1,[95],[],9,0,0),We[Oe.GAMMALN_PRECISE]=X(1,[1],[],1,0,0),We[Oe.CEILING_PRECISE]=X(1,[1,65],[],1,0,0),We[Oe.FLOOR_PRECISE]=X(1,[1,65],[],1,0,0),We[Oe.ACOT]=X(1,[1],[],1,0,0),We[Oe.ACOTH]=X(1,[1],[],1,0,0),We[Oe.COT]=X(1,[1],[],1,0,0),We[Oe.COTH]=X(1,[1],[],1,0,0),We[Oe.CSC]=X(1,[1],[],1,0,0),We[Oe.CSCH]=X(1,[1],[],1,0,0),We[Oe.SEC]=X(1,[1],[],1,0,0),We[Oe.SECH]=X(1,[1],[],1,0,0),We[Oe.IMTAN]=X(1,[95],[],9,0,0),We[Oe.IMCOT]=X(1,[95],[],9,0,0),We[Oe.IMCSC]=X(1,[95],[],9,0,0),We[Oe.IMCSCH]=X(1,[95],[],9,0,0),We[Oe.IMSEC]=X(1,[95],[],9,0,0),We[Oe.IMSECH]=X(1,[95],[],9,0,0),We[Oe.BITAND]=X(2,[1,1],[],1,0,0),We[Oe.BITOR]=X(2,[1,1],[],1,0,0),We[Oe.BITXOR]=X(2,[1,1],[],1,0,0),We[Oe.BITLSHIFT]=X(2,[1,1],[],1,0,0),We[Oe.BITRSHIFT]=X(2,[1,1],[],1,0,0),We[Oe.PERMUTATIONA]=X(2,[1,1],[],1,0,0),We[Oe.COMBINA]=X(2,[1,1],[],1,0,0),We[Oe.XOR]=X(1,[],[52],4,0,0),We[Oe.PDURATION]=X(3,[1,1,1],[],1,0,0),We[Oe.BASE]=X(2,[1,1,65],[],2,0,0),We[Oe.DECIMAL]=X(2,[2,1],[],1,0,0),We[Oe.DAYS]=X(2,[3,3],[],1,0,0),We[Oe.BINOM_DIST_RANGE]=X(3,[1,1,1,65],[],1,0,0),We[Oe.GAMMA]=X(1,[1],[],1,0,0),We[Oe.SKEW_P]=X(1,[],[49],1,0,0),We[Oe.GAUSS]=X(1,[1],[],1,0,0),We[Oe.PHI]=X(1,[1],[],1,0,0),We[Oe.RRI]=X(3,[1,1,1],[],1,0,0),We[Oe.UNICHAR]=X(1,[1],[],2,0,0),We[Oe.UNICODE]=X(1,[2],[],1,0,0),We[Oe.MUNIT]=X(1,[1],[],32,0,0),We[Oe.ARABIC]=X(1,[2],[],1,0,0),We[Oe.ISOWEEKNUM]=X(1,[1],[],1,0,0),We[Oe.NUMBERVALUE]=X(1,[2,66,66],[],1,0,0),We[Oe.SHEET]=X(0,[50],[],1,4095,0),We[Oe.SHEETS]=X(0,[48],[],1,4095,0),We[Oe.FORMULATEXT]=X(1,[16],[],2,4095,0),We[Oe.ISFORMULA]=X(1,[16],[],4,0,0),We[Oe.IFNA]=X(2,[47,575],[],47,0,0),We[Oe.CEILING_MATH]=X(1,[1,65,65],[],1,0,0),We[Oe.FLOOR_MATH]=X(1,[1,65,65],[],1,0,0),We[Oe.IMSINH]=X(1,[95],[],9,0,0),We[Oe.IMCOSH]=X(1,[95],[],9,0,0),We[Oe.FILTERXML]=X(2,[2,2],[],47,0,0),We[Oe.WEBSERVICE]=X(1,[2],[],10,0,0),We[Oe.ENCODEURL]=X(1,[2],[],10,0,0),We[Oe.FORECAST_ETS]=X(3,[1,48,48,65,65,65],[],1,0,0),We[Oe.FORECAST_ETS_CONFINT]=X(3,[1,48,48,65,65,65,65],[],1,0,0),We[Oe.FORECAST_ETS_SEASONALITY]=X(2,[48,48,65,65],[],1,0,0),We[Oe.FORECAST_LINEAR]=X(3,[1,32,32],[],1,0,0),We[Oe.FORECAST_ETS_STAT]=X(3,[48,48,1,65,65,65],[],1,0,0),We[Oe.MAXIFS]=X(3,[16],[16,15],1,0,0),We[Oe.MINIFS]=X(3,[16],[16,15],1,0,0),We[Oe.TEXTJOIN]=X(3,[114,68],[114],2,0,0),We[Oe.CONCAT]=X(1,[],[114],2,0,0),We[Oe.IFS]=X(2,[],[44,575],575,0,0),We[Oe.SWITCH]=X(3,[47,575],[575,575],575,0,0),We[Oe.SINGLE]=X(1,[1079,4],[],1055,0,1),We[Oe.AVERAGE_WEIGHTED]=X(2,[],[113,113],1,0,1),We[Oe.ANCHORARRAY]=X(1,[16],[],48,0,1),We[Oe.IMAGE]=X(1,[2],[],2,0,1),We[Oe.RECORD]=X(2,[],[2,303],256,0,1),We[Oe.RECORDTEST]=X(3,[15],[2,47],256,0,1),We[Oe.GRF]=X(1,[15,2],[],15,0,1),We[Oe.UNIT]=X(2,[15,2],[],15,0,1),We[Oe.RICHERROR]=X(1,[1],[],10,0,1),We[Oe.FILTER]=X(2,[48,48],[],32,0,1),We[Oe.FUN]=X(1,[],[63],63,0,1),We[Oe.LET]=X(3,[63,63,63],[],63,0,1),We[Oe.ARRAYMAKE]=X(3,[1,1,63],[],32,0,1),We[Oe.APPLY]=X(1,[],[63],63,0,1),We[Oe.ISFUN]=X(1,[63],[],4,0,1),We[Oe.ARITY]=X(1,[63],[],9,0,1),We[Oe.RECURSE]=X(0,[],[],63,0,1),We[Oe.FIELDVALUE]=X(2,[263,2],[],295,0,1);var He,Ke=X(0,[],[P.All],P.All,B.All,x.None);!function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.Dot=24]="Dot"}(He||(He={}));var je,Qe,Xe=w.Number|w.String|w.Boolean,Je=w.Number|w.String|w.Boolean|w.Blank,Ye=X(2,[w.Number,w.Number],[],w.Number,B.None,x.None),qe=X(1,[w.Number],[],w.Number,B.None,x.None),ze=X(1,[Xe],[],Xe,B.None,x.None),Ze=X(2,[w.String,w.String],[],w.String,B.None,x.None),$e=X(2,[Je,Je],[],w.Boolean,B.None,x.None),er=X(2,[w.Range,w.Range],[],w.Range,B.AllCells,x.None),rr=X(2,[w.Range,w.Range],[],w.Range,B.None,x.None),nr=X(2,[w.Boolean,w.Boolean],[],w.Boolean,B.None,x.None),tr=[];function or(e){var r=tr[e];return null!=r?r:Ke}function ar(e){var r=We[e];return null!=r?r:Ke}function ir(e,r){var n=We[e];null!=n&&(n.staticPrecs=r)}function ur(e){return 1===e.length}function cr(e){return 1===e.rows&&1===e.cols}function lr(e){return ur(e.sheet)}function sr(e){return cr(e.range)}function fr(e){return cr(e)?e:_(e.row,e.col,1,1)}function dr(e){return sr(e)?e:K(e.sheet,fr(e.range))}function Er(e,r){var n=e.row,t=e.col,o=r.row,a=r.col;return _(Math.min(n,o),Math.min(t,a),Math.abs(o-n)+1,Math.abs(a-t)+1)}function pr(e,r){function n(n){var t=e.spans[n.label];return void 0!==t&&t.start<=r&&r<t.end}for(var t=e.node,o=!0;o;)switch(o=!1,t.kind){case de.Array:for(var a=t.nodes,i=a.length-1;!o&&i>=0;i-=1)for(var u=a[i],c=u.length-1;!o&&c>=0;c-=1){n(s=u[c])&&(t=s,o=!0)}break;case de.App:var l=t.args;for(c=l.length-1;!o&&c>=0;c-=1){n(s=l[c])&&(t=s,o=!0)}break;case de.Paren:var s;n(s=t.node)&&(t=s,o=!0);break;case de.Bad:case de.Name:case de.CellRef:case de.Literal:break;default:I("getSubExpressionFromPosition",t)}return t}function vr(e,r){var n=-1,t=document.elementFromPoint(e,r);if(void 0!==document.caretPositionFromPoint)null!==(o=document.caretPositionFromPoint(e,r))&&(n=o.offset);else if(void 0!==document.caretRangeFromPoint){null!==(o=document.caretRangeFromPoint(e,r))&&(n=o.startOffset)}else try{var o;(o=document.body.createTextRange()).moveToPoint(e,r);var a=document.body.createTextRange();a.moveToElementText(t),a.setEndPoint("EndToStart",o),n=a.text.length}catch(e){return n}for(;null!=t&&"SPAN"===t.nodeName;)null!=(t=t.previousSibling)&&null!=t.textContent&&(n+=t.textContent.length);return n}function hr(e){return 0===function(e){if(1===e.args.length){var r=e.args[0];if(r.kind===de.Literal&&mr(r.oper)===w.Missing)return 0}return e.args.length}(e)?[]:e.args}function gr(e,r){A("calc.runtime.getArgType",r);var n=e.headTypes,t=n.length;if(r<t)return n[r];var o=e.restTypes,a=o.length;return a>0?o[(r-t)%a]:P.None}function Tr(e,r){return!(r<e.minArgs)&&(r<=e.headTypes.length||e.restTypes.length>0)}function mr(e){switch(typeof e){case"number":return w.Number;case"string":return w.String;case"boolean":return w.Boolean;default:return e.kind}}function Sr(e){return"number"==typeof e&&isFinite(e)}function Rr(e){return{kind:je.Success,value:e}}function Ir(e){return{kind:je.Failure,reason:e}}function Cr(e){return null!=e&&e.kind===je.Success}function Ar(e){return{kind:Qe.NotImplemented,features:e}}function Nr(e){return 0===e.length&&C("calc.lang.unavailable: expected nonempty array"),{kind:Qe.Unavailable,objects:e}}function Or(e){if(null!=e){var r=e.path,n=e.name;return null!=r&&"string"!=typeof r?(S.ULS.traceTag(595969803,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Illegal document path: type is "+typeof r),y):"string"!=typeof n?(S.ULS.traceTag(595969804,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Illegal document name: type is "+typeof n),y):e}}tr[He.Add]=Ye,tr[He.Sub]=Ye,tr[He.Mul]=Ye,tr[He.Div]=Ye,tr[He.Pow]=Ye,tr[He.Percent]=qe,tr[He.Neg]=qe,tr[He.Pos]=ze,tr[He.Concat]=Ze,tr[He.Eq]=$e,tr[He.Ne]=$e,tr[He.Lt]=$e,tr[He.Le]=$e,tr[He.Gt]=$e,tr[He.Ge]=$e,tr[He.Range]=er,tr[He.Isect]=rr,tr[He.Union]=rr,tr[He.And]=nr,tr[He.Or]=nr,tr[He.Xor]=nr,tr[He.Min]=Ye,tr[He.Max]=Ye,ir(Oe.ROW,B.OwnRow),ir(Oe.COLUMN,B.OwnCol),ir(Oe.SHEET,B.OwnDocSheets),ir(Oe.SHEETS,B.OwnDocSheets),ir(Oe.OFFSET,B.AllCells),ir(Oe.INDIRECT,B.AllCells),ir(Oe.SUMIF,B.AllCells),ir(Oe.NOW,B.Time),ir(Oe.TODAY,B.Time),ir(Oe.RAND,B.Calc),ir(Oe.RANDBETWEEN,B.Calc),ir(Oe.SUBTOTAL,B.CellProps),ir(Oe.CELL,B.CellProps|B.AllCells),ir(Oe.INFO,B.Calc),ir(Oe.FORMULATEXT,B.None),function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused"}(je||(je={})),function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable"}(Qe||(Qe={}));var yr=65;function Lr(e){for(var r=e+1,n="";r>0;){var t=(r-1)%26;n=String.fromCharCode(yr+t)+n,r=Math.floor((r-t)/26)}return n}function kr(e,r,n){var t=n.kind,o=n.index;return t===fe.Abs?r+e.formatNumber(o+1):0===o?r:r+e.leftBracket+e.formatNumber(o)+e.rightBracket}function Dr(e,r,n,t){if(r===ce.A1){if(null==n){return S.ULS.assertTag(595935437,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.lang.util.formatRow: in A1 style, expected origin to be defined")}return function(e,r,n){var t=n.kind===fe.Abs,o=e.formatNumber(n.index+(t?0:r)+1);return t?"$"+o:o}(e,n,t)}return kr(e,e.rowLetter,t)}function Mr(e,r,n,t){if(r===ce.A1){if(null==n){return S.ULS.assertTag(595935438,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.lang.util.formatCol: in A1 style, expected origin to be defined")}return function(e,r){var n=r.kind===fe.Abs,t=Lr(r.index+(n?0:e));return n?"$"+t:t}(n,t)}return kr(e,e.columnLetter,t)}function _r(e){return function(r,n,t,o,a){var i=e(r,n,t,o);return n===ce.R1C1&&o.kind===a.kind&&o.index===a.index?i:i+":"+e(r,n,t,a)}}var Fr=_r(Dr),br=_r(Mr);function Ur(e,r,n,t,o){var a=Dr(e,r,null!=n?n.row:void 0,t),i=Mr(e,r,null!=n?n.col:void 0,o);return r===ce.A1?i+a:a+i}var wr,Pr={ULS:new s.NulLogger},Br=Object(s.initStopwatchFactory)(function(e){return Pr.ULS.traceTag(595948114,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,e)});!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcNewFunctions="CalcNewFunctions",e.CalcContractChecks="CalcContractChecks",e.CalcSupportDynamicArrays="CalcSupportDynamicArrays",e.CalcFormatCalculations="CalcFormatCalculations",e.CalcFormulaCacheAPIChanges="CalcFormulaCacheAPIChanges",e.CalcStrictFormulaChecking="CalcStrictFormulaChecking",e.CalcUnifyRangeResolutionCode="CalcUnifyRangeResolutionCode",e.CalcSupportRowReference="CalcSupportRowReference",e.CalcHashSet="CalcHashSet",e.CalcFieldValueFunction="CalcFieldValueFunction",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcWebWorkerTest="CalcWebWorkerTest",e.CalcWorksheetFunctions="CalcWorksheetFunctions",e.CalcLogStopWatch="CalcLogStopWatch"}(wr||(wr={}));var xr=function(e){return!1},Vr={};function Gr(e){return void 0===Vr[e]&&(Vr[e]=xr(e)),Vr[e]}function Wr(e,r){return{wrap:e,unwrap:r}}function Hr(e){return e}function Kr(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function jr(e){var r=Kr();for(var n in e)r[n]=e[n];return r}function Qr(e){return null!=e}function Xr(e){return null==e}function Jr(e,r){return void 0!==e?e:r}var Yr=100;function qr(e,r,n){return void 0===n&&(n=Yr),r.maxDepth=n,r.level=0,zr(e,r)}function zr(e,r){if(r.level===r.maxDepth)throw"AST is too deep to continue the visit. Currently as level "+r.level;var n;switch(r.level+=1,e.kind){case de.Literal:n=function(e,r){if("boolean"==typeof e)return r.visitBoolean(e);if("number"==typeof e)return r.visitNumber(e);if("string"==typeof e)return r.visitString(e);if(e.kind===w.Missing)return r.visitMissing(e);if(e.kind===w.Error)switch(e.type){case V.NULL:return r.visitNullError(e);case V.DIV0:return r.visitDiv0Error(e);case V.VALUE:return r.visitValueError(e);case V.REF:return r.visitRefError(e);case V.NAME:return r.visitNameError(e);case V.NUM:return r.visitNumError(e);case V.NA:return r.visitNAError(e);case V.GETTING_DATA:return r.visitDataError(e);case V.FIELD:return r.visitFieldError(e)}throw"Tried to visit unrecognized AST node: "+e.kind+"."}(e.oper,r.operVisitor);break;case de.Array:n=r.visitArray(e);break;case de.App:n=r.visitApp(e);break;case de.Paren:n=r.visitParen(e);break;case de.Name:n=r.visitName(e);break;case de.CellRef:n=r.visitCellRef(e);break;case de.Bad:n=r.visitBad(e);break;case de.Operator:n=r.visitOperator(e);break;case se.Error:n=r.visitRefError(e);break;case se.Single:n=r.visitSingle(e);break;case se.Range:n=r.visitRange(e);break;case se.Row:n=r.visitRow(e);break;case se.Col:n=r.visitCol(e);break;case le.Error:n=r.visitNameError(e);break;case le.Relative:n=r.visitRelative(e);break;case le.Document:n=r.visitDocument(e);break;case le.Sheet:n=r.visitSheet(e);break;case le.Ident:n=r.visitIdent(e);break;case le.SheetRange:n=r.visitSheetRange(e);break;default:throw"Tried to visit unrecognized AST node: "+e.kind+"."}return r.level-=1,n}function Zr(e){return{visitString:e,visitBoolean:e,visitNumber:e,visitMissing:e,visitNullError:e,visitDiv0Error:e,visitValueError:e,visitRefError:e,visitNameError:e,visitNumError:e,visitNAError:e,visitDataError:e,visitFieldError:e}}function $r(e,r,n){return{level:0,operVisitor:e,visitArray:Jr(n.vArray,r),visitApp:Jr(n.vApp,r),visitParen:Jr(n.vParen,r),visitName:Jr(n.vName,r),visitCellRef:Jr(n.vCellRef,r),visitBad:Jr(n.vBad,r),visitOperator:Jr(n.vOperator,r),visitRefError:Jr(n.vRefError,r),visitSingle:Jr(n.vSingle,r),visitRange:Jr(n.vRange,r),visitRow:Jr(n.vRow,r),visitCol:Jr(n.vCol,r),visitNameError:Jr(n.vNameError,r),visitRelative:Jr(n.vRelative,r),visitDocument:Jr(n.vDocument,r),visitSheet:Jr(n.vSheet,r),visitIdent:Jr(n.vIdent,r),visitSheetRange:Jr(n.vSheetRange,r)}}var en=["+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":"," ",","];var rn={level:0,operVisitor:{visitString:function(e){return'"'+e+'"'},visitBoolean:function(e){return e.toString().toLocaleUpperCase()},visitNumber:function(e){return e.toString()},visitMissing:function(e){return""},visitNullError:function(e){return"#NULL!"},visitDiv0Error:function(e){return"#DIV/0!"},visitValueError:function(e){return"#VALUE!"},visitRefError:function(e){return"#REF!"},visitNameError:function(e){return"#NAME?"},visitNumError:function(e){return"#NUM!"},visitNAError:function(e){return"#N/A"},visitDataError:function(e){return"#GETTING_DATA!"},visitFieldError:function(e){return"#FIELD"}},visitArray:function(e){var r=[];return e.nodes.forEach(function(e){var n=[];e.forEach(function(e){n.push(zr(e,rn))}),r.push(n.join(","))}),"{"+r.join(";")+"}"},visitApp:function(e){var r=[];e.args.forEach(function(e){r.push(zr(e,rn))});var n=zr(e.head,rn);if(e.head.kind===de.Operator){if(e.head.id===He.Percent)return r[0]+"%";if(1===r.length)return n+r[0];if(2===r.length)return r[0]+n+r[1];throw"Tried to pretty print operator with 0 or more than 2 operators"}return n+"("+r.join(",")+")"},visitParen:function(e){return"("+zr(e.node,rn)+")"},visitName:function(e){return e.whole},visitCellRef:function(e){var r="";return void 0!==e.qualifier&&(r=zr(e.qualifier,this)+"!"),r+zr(e.ref,this)},visitBad:function(e){if(e.type===Ee.Sequence){var r=[];return e.contents.forEach(function(e){r.push(zr(e,rn))}),r.join("")}return e.contents},visitOperator:function(e){return en[e.id-1]},visitRefError:function(e){return"#REF!"},visitSingle:function(e){return r=e.row.index,n=e.row.kind===fe.Abs,t=e.col.index,(e.col.kind===fe.Abs?"$":"")+Lr(t)+(n?"$":"")+(r+1);var r,n,t},visitRange:function(e){return zr(e.ref1,rn)+":"+zr(e.ref2,rn)},visitRow:function(e){var r=e.row1.index+1,n=e.row1.kind===fe.Abs,t=e.row2.index+1;return(n?"$":"")+r+":"+(e.row2.kind===fe.Abs?"$":"")+t},visitCol:function(e){var r=e.col1.index,n=e.col1.kind===fe.Abs,t=e.col2.index,o=e.col2.kind===fe.Abs;return(n?"$":"")+Lr(r)+":"+(o?"$":"")+Lr(t)},visitNameError:function(e){return"#REF"},visitRelative:function(e){return""},visitDocument:function(e){return void 0!==e.path?e.path+"/"+e.document:e.document},visitSheet:function(e){return(void 0!==e.document?zr(e.document,rn):"")+e.sheet},visitIdent:function(e){return e.name},visitSheetRange:function(e){return e.sheet1+":"+e.sheet2}};function nn(e){var r=function(e){try{return Rr("="+qr(e,rn))}catch(e){return S.ULS.traceTag(595964180,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"PrettyPrinter failed: "+e),rn.level=0,Ir(e)}}(e);if(r.kind===je.Success){return r.value.toLowerCase().replace(/d/g,"w").replace(/[0-9]/g,"d").replace(new RegExp('[^/=\\[\\]\\.\\\\\\/%#\\-\\+,;\\(\\):?""&<>\'!{}~\\^\\*/g/\\u0024\\u0080\\u00a2\\u00a3\\u00a4\\u00a5\\u20a0\\u20a1\\u20a2\\u20a3\\u20a4\\u20a5\\u20a6\\u20a7\\u20a8\\u20a9\\u20aa\\u20ab\\u20ac\\u20ad\\u20ae\\u20af\\u20b0\\u20b1\\u20b2\\u20b3\\u20b4\\u20b5\\u20b6\\u20b7\\u20b8\\u20b9/g/\\s\\ua0c2/gd]',"g"),"w")}}function tn(e){return nn(e.node)}function on(e){return m.FormulaNode=nn,m.Formula=tn,{localeInfo:e}}var an=!1,un=void 0;function cn(e,r,n){if(an){var t="calc.config.initCalc: Calc is already initialized";S.ULS.traceTag(595910878,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,t)}else{var o;if(R(e),function(e){Pr.ULS=e}(e),"function"==typeof(o=r)&&(xr=o),null!=n&&!/(^https:\/\/)|(^http:\/\/)/.test(n)){t="calc.config.initCalc: calcAbsUrl is not absolute: "+n;S.ULS.traceTag(595910879,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,t)}un=n,an=!0}}function ln(){return an}function sn(){return un}function fn(e,r,n,t,o,a,i,u,c,l,s,f,d,E,p,v,h,g,T,m,S,R){return{parseNumber:e,formatNumber:r,getWorksheetFuncId:n,getWorksheetFuncName:t,isNumeral:o,getOrdinal:a,getNumeral:i,isLetter:u,stringCompareCI:c,errorNames:l,trueName:s,falseName:f,rowLetter:d,columnLetter:E,leftBrace:p,rightBrace:v,leftBracket:h,rightBracket:g,decimalSeparator:T,listSeparator:m,columnSeparator:S,rowSeparator:R}}function dn(e){return Number(e)}function En(e){return String(e)}function pn(e){return Rn[e.toLocaleUpperCase()]}function vn(e){var r=In[e];return null==r?C("calc.config.getWorksheetFuncName: unknown function ID "+e):r}function hn(e){return e>="0"&&e<="9"}function gn(e){return hn(e)||C("calc.config.getOrdinal: expected numeral; given "+v(e)),e.charCodeAt(0)-"0".charCodeAt(0)}function Tn(e){return O("calc.config.getNumeral",e,10),String(e)}function mn(e){return e>="A"&&e<="Z"||e>="a"&&e<="z"}function Sn(e,r){return e.toLocaleUpperCase().localeCompare(r.toLocaleUpperCase())}var Rn,In,Cn=[void 0,"#NULL!","#DIV/0!","#VALUE!","#REF!","#NAME?","#NUM!","#N/A","#GETTING_DATA","#FIELD"];function An(){return void 0!==Rn&&void 0!==In||(Rn={},In=[],Object.keys(Oe).forEach(function(e){var r=Oe[e];if("number"==typeof r){var n=e.replace("_",".");Rn[n]=r,In[r]=n}})),fn(dn,En,pn,vn,hn,gn,Tn,mn,Sn,Cn,"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";")}var Nn,On,yn,Ln,kn,Dn,Mn,_n,Fn,bn,Un,wn,Pn=se,Bn=fe,xn=le,Vn=Se,Gn=b,Wn=M,Hn=D,Kn=W,jn=j,Qn=Q,Xn=Er,Jn=Cr,Yn=Qe,qn=Ar;function zn(e){if(void 0===e)return!0;if(null===e||"object"!=typeof e)return!1;switch(e.kind){case Yn.NotImplemented:case Yn.Unavailable:return!0}return!1}function Zn(e,r,n){return function(t,o){return void 0===o?r(t):zn(o)?n(o,t):e(o)}}function $n(e,r){return function(n){if(Array.isArray(n)){for(var t=void 0,o=0;o<n.length;o+=1){var a=n[o];if(void 0!==(t=e(a)))return[a,t]}return r}var i=e(n);return void 0===i?r:[n,i]}}function et(e,r){return r.kind===Bn.Abs?r.index:e+r.index}function rt(e,r){var n=et(e.row,r.row),t=et(e.col,r.col);return Gn(n,t)}function nt(e,r){switch(r.kind){case Pn.Error:return;case Pn.Single:var n=rt(e,r);return Gn(n.row,n.col);case Pn.Range:var t=rt(e,r.ref1),o=rt(e,r.ref2);return Xn(t,o);case Pn.Row:return qn(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]);case Pn.Col:return qn(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]);default:return I("calc.runtime.resolverService.resolveGridRef",r)}}function tt(e){function r(r){var n=e.getDocumentLoc(r.path,r.document);return Qr(n)?n:void 0}function n(n,t){var o=Qr(t.document)?r(t.document):n;if(!Xr(o)){var a=e.getSheetIndex(o,t.sheet);return Jn(a)?Qr(a.value)?Wn(o,a.value):void 0:a.reason}}return{resolveName:function(t,o,a){if(Xr(o)||o.kind===xn.Relative)return[Qn(t.sheet,a),Qn(jn(t.sheet.document),a)];var i=function(t,o){switch(o.kind){case xn.Document:var a=r(o);return Qr(a)?jn(a):a;case xn.Sheet:return n(t.sheet.document,o);case xn.Ident:var i=t.sheet.document,u=e.getSheetIndex(i,o.name);if(Jn(u)){if(Qr(u.value))return Wn(i,u.value);var c=r(Vn(o.name));return Qr(c)?jn(c):void 0}return u.reason;default:return I("calc.runtime.resolverService.resolveNameQualifier",o)}}(t,o);return zn(i)?i:Qn(i,a)},resolveGridRef:nt,resolveCellRef:function(r,t,o){var a=nt(r.range,o);if(zn(a))return a;var i=Xr(t)?r.sheet:function(r,t){switch(t.kind){case xn.Error:return;case xn.Sheet:return n(r.document,t);case xn.SheetRange:var o=r.document,a=e.getSheetIndex(o,t.sheet1);if(!Jn(a))return a.reason;var i=e.getSheetIndex(o,t.sheet2);if(!Jn(i))return i.reason;var u=a.value,c=i.value;if(Xr(u)||Xr(c))return;return u===c?Wn(o,u):Hn(o,Math.min(u,c),Math.abs(c-u)+1);case xn.Relative:return r;default:return I("calc.runtime.resolverService.resolveCellRefQualifier",t)}}(r.sheet,t);return zn(i)?i:Kn(i,a)}}}(On=Nn||(Nn={})).FormulaSource=h,On.documentLoc=L,On.sheetIndex=M,On.sheetRange=D,On.gridCell=b,On.gridRange=F,On.sheetGridCell=K,On.sheetGridRange=H,On.sheetGridCube=W,On.documentScope=j,On.nameLoc=Q,(Ln=yn||(yn={})).SpecialPrecs=B,Ln.OperKind=w,Ln.ErrorType=V,Ln.ErrorTypeBounds=G,Ln.precedents=J,Ln.errorOper=Y,Ln.nullErrorOper=q,Ln.div0ErrorOper=z,Ln.valueErrorOper=Z,Ln.refErrorOper=$,Ln.nameErrorOper=ee,Ln.numErrorOper=re,Ln.naErrorOper=ne,Ln.gettingDataErrorOper=te,Ln.fieldErrorOper=oe,Ln.arrayOper=ae,Ln.rangeSeqOper=ie,Ln.range3DOper=ue,Ln.missingOper=pe,Ln.blankOper=ve,(Dn=kn||(kn={})).RefStyle=ce,Dn.QualifierKind=le,Dn.CellRefKind=se,Dn.PosKind=fe,Dn.NodeKind=de,Dn.BadType=Ee,Dn.errorQualifierLabeled=he,Dn.relativeQualifierLabeled=ge,Dn.errorQualifier=Te,Dn.relativeQualifier=me,Dn.documentQualifier=Se,Dn.sheetQualifier=Re,Dn.identQualifier=Ie,Dn.sheetRangeQualifier=Ce,Dn.pos=Ae,Dn.cellRefErrorLabeled=Ne,Dn.cellRefError=ye,Dn.cellRefSingle=Le,Dn.cellRefRange=ke,Dn.cellRefRow=De,Dn.cellRefCol=Me,Dn.formula=_e,Dn.formulaSpan=Fe,Dn.literalNode=be,Dn.arrayNode=Ue,Dn.appNode=we,Dn.operatorNode=Pe,Dn.parenNode=Be,Dn.nameNode=xe,Dn.cellRefNode=Ve,Dn.badNode=Ge,(_n=Mn||(Mn={})).SignatureType=P,_n.FunctionFlags=x,_n.OperatorId=He,_n.WorksheetFuncId=Oe,_n.SpecialPrecs=B,_n.functionType=X,_n.unknownFunctionType=Ke,_n.getOperatorType=or,_n.getWorksheetFuncType=ar,(bn=Fn||(Fn={})).isSheetIndex=ur,bn.isSheetGridRange=lr,bn.isGridCell=cr,bn.isSheetGridCell=sr,bn.gridRangeAnchor=fr,bn.sheetGridRangeAnchor=dr,bn.gridCellRange=Er,bn.getArguments=hr,bn.getArgType=gr,bn.isValidArgsLength=Tr,bn.operKind=mr,bn.ResultKind=je,bn.success=Rr,bn.failure=Ir,bn.isSuccess=Cr,bn.ReasonKind=Qe,bn.notImplemented=Ar,bn.unavailable=Nr,bn.columnName=Lr,bn.formatRow=Dr,bn.formatCol=Mr,bn.formatRowRange=Fr,bn.formatColRange=br,bn.formatCellPos=Ur,bn.getSubExpressionFromPosition=pr,bn.getFormulaCharIndexFromPoint=vr,bn.createResolver=tt,bn.createResolutionHandler=Zn,bn.createNameFinder=$n,bn.defaultLiteralVisitor=Zr,bn.defaultFormulaVisitor=$r,bn.dispatch=zr,bn.startVisit=qr,(wn=Un||(Un={})).localeInfo=fn,wn.calcConfig=on,wn.initCalc=cn,wn.createSimpleLocaleInfo=An,wn.isCalcInit=ln,wn.getCalcAbsUrl=sn;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var ot=function(e,r){return(ot=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])})(e,r)};function at(e,r){function n(){this.constructor=e}ot(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var it=function(){return(it=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var o in r=arguments[n])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)};function ut(e,r,n,t){return new(n||(n=Promise))(function(o,a){function i(e){try{c(t.next(e))}catch(e){a(e)}}function u(e){try{c(t.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new n(function(r){r(e.value)}).then(i,u)}c((t=t.apply(e,r||[])).next())})}function ct(e,r){var n,t,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,t&&(o=2&a[0]?t.return:a[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,a[1])).done)return o;switch(t=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,t=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],t=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}var lt,st=Fn.ReasonKind,ft=Fn.notImplemented;function dt(e){return{config:e}}!function(e){e.BadFormulaString="BadFormulaString"}(lt||(lt={}));var Et=it({},st,lt);function pt(e){return{kind:Et.BadFormulaString,message:e}}var vt=" \t\n\r";function ht(e){return vt.indexOf(e)>=0}function gt(e,r){return"\\"===r||"_"===r||e.isLetter(r)}function Tt(e,r){return"."===r||gt(e,r)||e.isNumeral(r)}function mt(e,r){var n=r-1;return function(r){if(r<=n){var t=e+": internal error: no progress made at index "+r;return S.ULS.assertTag(595980821,s.LogCategory.msoulscat_ES_EWAJS,!1,t)}n=r}}function St(e,r,n){for(var t=r;t<e.length&&n(e[t]);t+=1);return[e.substring(r,t),t]}function Rt(e,r,n,t,o){var a=e[r];return n(a)?1:a===t&&o(e[r+1])?2:0}function It(e,r,n,t,o){for(var a=[],i=r,u=r;u<e.length;){var c=Rt(e,u,n,t,o);if(0===c)break;2===c&&(i!==u&&a.push(e.substring(i,u)),i=u+1),u+=c}return i!==u&&a.push(e.substring(i,u)),[a.join(""),u]}var Ct,At,Nt,Ot,yt=yn.nullErrorOper,Lt=yn.div0ErrorOper,kt=yn.valueErrorOper,Dt=yn.refErrorOper,Mt=yn.nameErrorOper,_t=yn.numErrorOper,Ft=yn.naErrorOper,bt=yn.gettingDataErrorOper,Ut=yn.fieldErrorOper,wt=Mn.OperatorId;function Pt(e,r,n){return{kind:e,start:r,chars:n}}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected"}(Ct||(Ct={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(At||(At={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual"}(Nt||(Nt={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(Ot||(Ot={}));var Bt=function(e){return Pt(Ct.End,e,"")},xt=function(e,r){return Pt(Ct.Spaces,e,r)},Vt=function(e,r){return Pt(Ct.Unexpected,e,r)},Gt=function(e,r){return Pt(Ct.Ident,e,r)};function Wt(e,r,n,t){return{kind:e,start:r,chars:n,value:t}}var Ht=function(e){return Wt(Ct.Left,e,"(",At.Paren)},Kt=function(e,r){return Wt(Ct.Left,e,r,At.Bracket)},jt=function(e,r){return Wt(Ct.Left,e,r,At.Brace)},Qt=function(e){return Wt(Ct.Left,e,"'",At.SQuote)},Xt=function(e){return Wt(Ct.Right,e,")",At.Paren)},Jt=function(e,r){return Wt(Ct.Right,e,r,At.Bracket)},Yt=function(e,r){return Wt(Ct.Right,e,r,At.Brace)},qt=function(e){return Wt(Ct.Right,e,"'",At.SQuote)},zt=function(e,r){return Wt(Ct.Sep,e,r,Nt.List)},Zt=function(e,r){return Wt(Ct.Sep,e,r,Nt.Col)},$t=function(e,r){return Wt(Ct.Sep,e,r,Nt.Row)},eo=function(e){return Wt(Ct.Sep,e,"!",Nt.Qual)},ro={"#ALL":function(e,r){return Wt(Ct.SpecialRef,e,r,Ot.All)},"#DATA":function(e,r){return Wt(Ct.SpecialRef,e,r,Ot.Data)},"#HEADERS":function(e,r){return Wt(Ct.SpecialRef,e,r,Ot.Headers)},"#TOTALS":function(e,r){return Wt(Ct.SpecialRef,e,r,Ot.Totals)},"#THIS ROW":function(e,r){return Wt(Ct.SpecialRef,e,r,Ot.ThisRow)}};function no(e,r,n,t,o,a,i,u){return{kind:Ct.CellRef,start:e,chars:r,row:n,col:t,refStyle:o,isName:a,isNumber:i,isQualPart:u}}function to(e,r,n,t){void 0===t&&(t=!0);var o="number"==typeof n&&function(e){for(var r=0;r<e.length;r+=1)if("+"===e[r]||"-"===e[r])return!1;return!0}(r);return{kind:Ct.Literal,start:e,chars:r,oper:n,hasRight:t,isQualPart:o}}var oo=[function(e,r){throw new Error("errorToken[0]: no error type 0")},function(e,r){return to(e,r,yt)},function(e,r){return to(e,r,Lt)},function(e,r){return to(e,r,kt)},function(e,r){return to(e,r,Dt)},function(e,r){return to(e,r,Mt)},function(e,r){return to(e,r,_t)},function(e,r){return to(e,r,Ft)},function(e,r){return to(e,r,bt)},function(e,r){return to(e,r,Ut)}];function ao(e,r,n){return 0===e.stringCompareCI(e.falseName,n)?to(r,n,!1):0===e.stringCompareCI(e.trueName,n)?to(r,n,!0):Gt(r,n)}var io=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"."];function uo(e){var r=io[e];if(null==r)throw new Error("operatorTokenMaker: invalid operator "+e);return function(n){return{kind:Ct.Operator,start:n,chars:r,value:e}}}var co=uo(wt.Add),lo=uo(wt.Sub),so=uo(wt.Mul),fo=uo(wt.Div),Eo=uo(wt.Pow),po=uo(wt.Percent),vo=uo(wt.Concat),ho=uo(wt.Eq),go=uo(wt.Lt),To=uo(wt.Gt),mo=uo(wt.Ne),So=uo(wt.Le),Ro=uo(wt.Ge),Io=uo(wt.Range);uo(wt.And),uo(wt.Or),uo(wt.Xor),uo(wt.Dot);function Co(e,r,n){return n.push(r),r.start+e}var Ao=kn.PosKind,No=kn.pos,Oo=kn.RefStyle;function yo(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}function Lo(e){return e.toUpperCase().charCodeAt(0)-65+1}function ko(e,r,n,t){for(var o=0,a=t,i=Math.min(n.length,t+r);a<i;a+=1){var u=n[a];if(!e.isNumeral(u))break;o=10*o+e.getOrdinal(u)}return a===i&&e.isNumeral(n[a])?[0,t]:[o,a]}function Do(e,r,n){return function(t,o,a,i){var u=function(e,r){return"$"===e[r]?[Ao.Abs,r+1]:[Ao.Rel,r]}(a,i),c=u[0],l=u[1],s=e(t,n,a,l),f=s[0],d=s[1];if(d>l){if(f<1||f>r)return;var E=c===Ao.Rel?f-o:f;return[No(c,E-1),!1,d]}return[void 0,!1,i]}}function Mo(e,r,n){return function(t,o,a,i){var u=e?t.rowLetter:t.columnLetter;if(i>=a.length||0!==t.stringCompareCI(u,a[i]))return[void 0,!1,i];var c=i+1,l=ko(t,n,a,c),s=l[0],f=l[1];if(f>c){if(s<1||s>r)return;return[No(Ao.Abs,s-1),!1,f]}if(a[c]===t.leftBracket){var d=1;"+"===a[c+=1]?c+=1:"-"===a[c]&&(d=-1,c+=1);var E=ko(t,n,a,c),p=E[0],v=E[1];if(v>c&&p<r&&a[v]===t.rightBracket)return[No(Ao.Rel,p*d),!0,v+1]}return[!1,!1,f]}}function _o(e,r,n,t,o,a,i){var u=t(e,r,a,i);if(null==u)return[void 0,void 0,!1,i];var c=u[0],l=u[1],s=u[2];if(s>i){var f=o(e,n,a,s);if(null==f)return l?[c,void 0,!0,s]:[void 0,void 0,!1,i];var d=f[0],E=f[1],p=f[2];return p>s?[c,d,E,p]:[c,void 0,l,s]}var v=o(e,n,a,i);if(null==v)return[void 0,void 0,!1,i];var h=v[0],g=v[1],T=v[2];return T>i?[void 0,h,g,T]:[void 0,void 0,!1,i]}var Fo=Do(ko,1048576,7),bo=Do(function(e,r,n,t){return function(e,r,n){for(var t=0,o=n,a=Math.min(r.length,n+e);o<a;o+=1){var i=r[o];if(!yo(i))break;t=26*t+Lo(i)}return o===a&&yo(r[o])?[0,n]:[t,o]}(r,n,t)},16384,3),Uo=Mo(!0,1048576,7),wo=Mo(!1,16384,5);function Po(e,r,n,t,o,a){var i,u,c,l,s,f=function(e,r,n,t,o){if(r===Oo.A1&&null!=n){var a=n.range,i=_o(e,a.col,a.row,bo,Fo,t,o),u=i[0],c=i[1],l=i[2],s=i[3];if((null!=c&&null!=u||null!=c&&c.kind===Ao.Abs||null!=u&&u.kind===Ao.Abs||(null!=c||null!=u)&&(":"===t[o-1]||":"===t[s]))&&(l||s>=t.length||!Tt(e,t[s])))return[Oo.A1,c,u,s]}var f=_o(e,void 0,void 0,Uo,wo,t,o),d=f[0],E=f[1],p=f[2],v=f[3];if((null!=d||null!=E)&&(p||v>=t.length||!Tt(e,t[v])))return[Oo.R1C1,d,E,v]}(e,r,n,t,o);if(null!=f){var d=f[0],E=f[1],p=f[2],v=f[3],h=t.substring(v,o);return Co(v-o,d===Oo.A1?function(e,r,n,t){var o=null==n&&null!=t&&t.kind===kn.PosKind.Rel,a=null==t&&null!=n&&n.kind===kn.PosKind.Rel,i=!(null!=n&&n.kind!==kn.PosKind.Rel||null!=t&&t.kind!==kn.PosKind.Rel);return no(e,r,n,t,kn.RefStyle.A1,o,a,i)}(o,h,E,p):(i=o,u=h,l=p,s=!(!1!==(c=E)&&null!=c&&c.kind!==kn.PosKind.Abs||!1!==l&&null!=l&&l.kind!==kn.PosKind.Abs),no(i,u,!1===c?kn.pos(kn.PosKind.Rel,0):c,!1===l?kn.pos(kn.PosKind.Rel,0):l,kn.RefStyle.R1C1,!1,!1,s)),a)}}var Bo=yn.numErrorOper,xo="+-*/^%&=<>:";function Vo(e){return xo.indexOf(e)>=0}var Go={"+":co,"-":lo,"*":so,"/":fo,"^":Eo,"%":po,"&":vo,"=":ho,"<":go,">":To,":":Io},Wo={"<>":mo,"<=":So,">=":Ro};function Ho(e,r,n){if(r<e.length-1){var t=Wo[e.substr(r,2)];if(null!=t)return Co(2,t(r),n)}var o=Go[e[r]];if(null!=o)return Co(1,o(r),n);return S.ULS.assertTag(595980822,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function Ko(e,r,n,t){function o(n){var t=n,o=r[t];if("e"!==o&&"E"!==o)return n;if((t+=1)>=r.length)return n;if("+"===(o=r[t])||"-"===o){if((t+=1)>=r.length)return n;o=r[t]}if(!e.isNumeral(o))return n;for(t+=1;t<r.length&&e.isNumeral(r[t]);t+=1);return t}function a(n,t){var a=n,i=r[a];if(i===e.decimalSeparator){if((a+=1)>=r.length)return t?n:a;i=r[a]}if(!e.isNumeral(i))return t?n:o(a);for(a+=1;a<r.length;a+=1)if(!e.isNumeral(r[a]))return o(a);return a}for(var i=n;i<r.length;i+=1)if(!e.isNumeral(r[i])){i=a(i,i===n);break}if(i>n){var u=r.substring(n,i),c=e.parseNumber(u);return Co(i-n,to(n,u,Sr(c)?c:Bo,!0),t),i}}function jo(e,r,n){var t=It(e,r+1,function(e){return'"'!==e},'"',function(e){return'"'===e}),o=t[0],a=t[1],i=e.substring(r,a+1);return a<e.length?Co(a+1-r,to(r,i,o,!0),n):Co(a-r,to(r,i,o,!1),n)}function Qo(e,r,n,t){for(var o=1;o<e.errorNames.length;o+=1){var a=e.errorNames[o],i=r.substr(n,a.length),u=oo[o];if(0===e.stringCompareCI(a,i)&&null!=u)return Co(a.length,u(n,i),t)}}var Xo=Object.getOwnPropertyNames(ro);function Jo(e,r,n,t){for(var o=0;o<Xo.length;o+=1){var a=Xo[o],i=r.substr(n,a.length);if(i.toUpperCase()===a)return Co(a.length,ro[a](n,i),t)}}function Yo(e,r){return"'"!==r&&"#"!==r&&r!==e.leftBracket&&r!==e.rightBracket}function qo(e,r,n,t){var o=Co(1,Kt(n,r[n]),t);"#"===r[o]&&(null!=(l=Jo(0,r,o,t))&&(o=l));for(var a=function(r){return Yo(e,r)},i=function(r){return!Yo(e,r)},u=mt("calc.parse.tokenizeBracketedColRef",o);o<r.length;){u(o);var c=r[o];if(c===e.rightBracket)return Co(1,Jt(o,c),t);if(Rt(r,o,a,"'",i)>0){var l,s=It(r,o,a,"'",i),f=s[0];o=Co((l=s[1])-o,Gt(o,f),t)}else o=Co(1,Vt(o,c),t)}return o}function zo(e,r){return!ht(r)&&"'"!==r&&"#"!==r&&":"!==r&&r!==e.listSeparator&&r!==e.leftBracket&&r!==e.rightBracket}function Zo(e,r,n,t){var o=Co(1,Kt(n,r[n]),t);"#"===r[o]&&(null!=(f=Jo(0,r,o,t))&&(o=f));for(var a=function(r){return zo(e,r)},i=function(r){return!zo(e,r)},u=mt("calc.parse.tokenizeBracketedRef",o);o<r.length;){u(o);var c=r[o];if(c===e.rightBracket)return Co(1,Jt(o,c),t);if(Rt(r,o,a,"'",i)>0){var l=It(r,o,a,"'",i),s=l[0];o=Co((f=l[1])-o,Gt(o,s),t)}else if(ht(c)){var f,d=St(r,o,ht);s=d[0];o=Co((f=d[1])-o,xt(o,s),t)}else o=":"!==c?c!==e.listSeparator?c!==e.leftBracket?Co(1,Vt(o,c),t):qo(e,r,o,t):Co(1,zt(o,c),t):Co(1,Io(o),t)}return o}var $o,ea="':*?";function ra(e,r,n,t){for(var o=Co(1,Qt(n),t),a=function(r){return function(e,r){return ea.indexOf(r)<0&&r!==e.leftBracket&&r!==e.rightBracket}(e,r)},i=function(e){return"'"===e},u=mt("calc.parse.tokenizeQuotedQualifier",o);o<r.length;){u(o);var c=r[o];if("'"===c&&"'"!==r[o+1])return Co(1,qt(o),t);if(":"!==c)if(c!==e.leftBracket)if(Rt(r,o,a,"'",i)>0){var l=It(r,o,a,"'",i),s=l[0];o=Co(l[1]-o,Gt(o,s),t)}else o=Co(1,Vt(o,c),t);else o=Zo(e,r,o,t);else o=Co(1,Io(o),t)}return o}function na(e,r,n,t){for(var o=e[r],a=r+1;a<e.length;a+=1){var i=e[a];if(i.kind!==n)break;o=t(o,i)}return[o,a]}function ta(e,r){return Vt(e.start,e.chars+r.chars)}function oa(e,r,n,t,o){for(var a=function(e,r,n,t,o){for(var a=[],i=[],u=$o.Decimal,c=o,l=mt("calc.parse.tokenize",c);c<t.length;){l(c);var f=Po(e,r,n,t,c,a);if(null==f){var d=t[c];if(u===$o.Decimal&&d===e.decimalSeparator||e.isNumeral(d)){var E=Ko(e,t,c,a);if(null!=E){c=E,u=$o.FieldAccess;continue}if(d!==e.decimalSeparator){var p="calc.parse.tokenize: failed to tokenize numeral at "+c;return S.ULS.assertTag(595980823,s.LogCategory.msoulscat_ES_EWAJS,!1,p)}}if('"'!==d)if(gt(e,d)){var v=St(t,c,function(r){return Tt(e,r)}),h=v[0];c=Co(v[1]-c,ao(e,c,h),a),u=$o.FieldAccess}else if("#"!==d)if(Vo(d))c=Ho(t,c,a),u=$o.Decimal;else if(ht(d)){var g=St(t,c,ht);h=g[0],c=Co(g[1]-c,xt(c,h),a),u=$o.Decimal}else if("("!==d)if(")"!==d)if(d!==e.leftBrace)if(d!==e.rightBrace)if(d!==e.leftBracket)if(d!==e.rightBracket){if(i.length>0&&i[i.length-1]===At.Brace){if(d===e.columnSeparator){c=Co(1,Zt(c,d),a),u=$o.Decimal;continue}if(d===e.rowSeparator){c=Co(1,$t(c,d),a),u=$o.Decimal;continue}}d!==e.listSeparator?"!"!==d?"'"!==d?(c=Co(1,Vt(c,d),a),u=$o.Decimal):(c=ra(e,t,c,a),u=$o.Decimal):(c=Co(1,eo(c),a),u=$o.Decimal):(c=Co(1,zt(c,d),a),u=$o.Decimal)}else c=Co(1,Jt(c,d),a),u=$o.FieldAccess;else c=Zo(e,t,c,a),u=$o.FieldAccess;else i.length>0&&i[i.length-1]===At.Brace&&i.pop(),c=Co(1,Yt(c,d),a),u=$o.FieldAccess;else i.push(At.Brace),c=Co(1,jt(c,d),a),u=$o.Decimal;else i.length>0&&i[i.length-1]===At.Paren&&i.pop(),c=Co(1,Xt(c),a),u=$o.FieldAccess;else i.push(At.Paren),c=Co(1,Ht(c),a),u=$o.Decimal;else{var T=Qo(e,t,c,a);if(null!=T){c=T,u=$o.FieldAccess;continue}c=Co(1,Vt(c,d),a),u=$o.Decimal}else c=jo(t,c,a),u=$o.FieldAccess}else c=f,u=$o.FieldAccess}return a}(e.config.localeInfo,r,n,t,o),i=[],u=0;u<a.length;){var c=a[u];if(c.kind!==Ct.Unexpected)i.push(c),u+=1;else{var l=na(a,u,Ct.Unexpected,ta),f=l[0],d=l[1];i.push(f),u=d}}return i.push(Bt(t.length)),i}function aa(e,r,n,t){var o=void 0;if(function(e){for(var r=e;null!=r;)r=r()}(e(r,n,t,function(e,r){o=[e,r]},function(){o=!1})),null==o){var a="calc.parse.runParser: internal error: parser did not call resolve or reject on "+v(r);return S.ULS.assertTag(595980827,s.LogCategory.msoulscat_ES_EWAJS,!1,a)}return o}function ia(e){return function(r,n,t,o,a){return o(e,n)}}!function(e){e[e.Decimal=1]="Decimal",e[e.FieldAccess=2]="FieldAccess"}($o||($o={}));var ua,ca=function(e,r,n,t,o){return o};function la(e,r){return function(n,t,o,a,i){return e(n,t,o,function(e,t){return r(o,e)(n,t,o,a,i)},i)}}function sa(e,r){return function(n,t,o,a,i){return e(n,t,o,a,function(){return r(n,t,o,a,i)})}}function fa(e){return 0===e.length?ca:e.reduce(sa)}function da(e,r){return function(n,t,o,a,i){return e(n,t,o,a,function(){return a(r,t)})}}function Ea(e,r){return function(n,t,o,a,i){var u=n[t];if(null==u)return i;var c=e(o,u);return null==c?i:a(c,t+r)}}function pa(e){return Ea(e,1)}function va(e){return Ea(e,0)}function ha(e){return function(r,n,t,o,a){var i=r[n],u=r[n+1];if(null==i||null==u)return a;var c=e(t,i,u);return null==c?a:o(c,n+1)}}function ga(e,r,n){return function(t,o,a,i,u){var c=n,l=o;function f(){return e(t,l,a,d,E)}function d(e,n){if(n<=l){var o=v(t),i="calc.parse.reduce: internal error: no progress made at index "+l+" on "+o;return S.ULS.assertTag(595980829,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}return c=r(a,e,c),l=n,f}function E(){return i(c,l)}return f}}function Ta(e,r){return ga(e,function(e,r,n){return n.push(r),n},r)}function ma(e){return function(r,n,t,o,a){return Ta(e,[])(r,n,t,o,a)}}function Sa(e,r){return la(e,function(e,n){return Ta(r,[n])})}function Ra(e){var r=e.length;return function(n,t,o,a,i){var u=t,c=[];function l(){return e[c.length](n,u,o,s,i)}function s(e,n){return u=n,c.push(e),c.length<r?l:a(c,u)}return l}}function Ia(e,r){return Ra([e,r])}function Ca(e,r,n,t,o){return Ra([e,r,n,t,o])}function Aa(e,r){return function(n,t,o,a,i){return e(n,t,o,function(e,n){return a(r(o,e),n)},i)}}function Na(e,r,n){return Aa(Ra([e,r]),function(e,r){return n(e,r[0],r[1])})}function Oa(e,r,n,t){return Aa(Ra([e,r,n]),function(e,r){return t(e,r[0],r[1],r[2])})}function ya(e,r,n,t,o){return Aa(Ra([e,r,n,t]),function(e,r){return o(e,r[0],r[1],r[2],r[3])})}function La(e,r,n,t,o,a){return Aa(Ra([e,r,n,t,o]),function(e,r){return a(e,r[0],r[1],r[2],r[3],r[4])})}function ka(e,r){return Na(e,r,function(e,r,n){return r})}function Da(e,r){return Na(e,r,function(e,r,n){return n})}function Ma(e,r){var n=e.spans[r.label];if(null==n){var t="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+v(r);return S.ULS.assertTag(595980824,s.LogCategory.msoulscat_ES_EWAJS,!1,t)}return n}function _a(e,r,n,t,o){var a=e.label;return e.label+=1,e.spans[a]=kn.formulaSpan(r,n,t,o),a}function Fa(e,r,n,t){var o=Ma(e,n);return o.pre=r,o.post=t,n}function ba(e,r,n){return function(t,o,a,i,u){var c=a.leftDelim,l=a.listSep;return a.leftDelim=e,a.listSep=r,n(t,o,a,function(e,r){return a.leftDelim=c,a.listSep=l,i(e,r)},function(){return a.leftDelim=c,a.listSep=l,u})}}function Ua(e,r){return r.kind===Ct.Spaces||r.kind===Ct.End?r.start:Ma(e,r).start}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(ua||(ua={}));var wa=da(pa(function(e,r){return r.kind===Ct.Spaces?r.chars:void 0}),"");function Pa(e){return Oa(wa,pa(e),wa,Fa)}var Ba=Pa(function(e,r){return r.kind!==kn.NodeKind.Operator||r.id!==Mn.OperatorId.Add&&r.id!==Mn.OperatorId.Sub?void 0:r}),xa=Na(pa(function(e,r){if(r.kind===kn.NodeKind.Operator){if(r.id===Mn.OperatorId.Add)return kn.operatorNode(Mn.OperatorId.Pos,r.label);if(r.id===Mn.OperatorId.Sub)return kn.operatorNode(Mn.OperatorId.Neg,r.label)}}),wa,function(e,r,n){return Fa(e,"",r,n)}),Va=Pa(function(e,r){return r.kind!==kn.NodeKind.Operator||r.id!==Mn.OperatorId.Mul&&r.id!==Mn.OperatorId.Div?void 0:r}),Ga=Pa(function(e,r){return r.kind===kn.NodeKind.Operator&&r.id===Mn.OperatorId.Pow?r:void 0}),Wa=function(e){return Na(wa,pa(e),function(e,r,n){return Fa(e,r,n,"")})}(function(e,r){return r.kind===kn.NodeKind.Operator&&r.id===Mn.OperatorId.Percent?r:void 0}),Ha=Pa(function(e,r){return r.kind===kn.NodeKind.Operator&&r.id===Mn.OperatorId.Concat?r:void 0}),Ka=Pa(function(e,r){return r.kind===kn.NodeKind.Operator&&r.id>=Mn.OperatorId.Eq&&r.id<=Mn.OperatorId.Ge?r:void 0}),ja=Pa(function(e,r){return r.kind===kn.NodeKind.Operator&&r.id===Mn.OperatorId.Range?r:void 0}),Qa=Pa(function(e,r){return r.kind===kn.NodeKind.Operator&&r.id===Mn.OperatorId.Union?r:void 0}),Xa=ha(function(e,r,n){if(r.kind===Ct.Spaces&&n.kind!==Ct.End&&n.kind!==kn.NodeKind.Operator){var t=_a(e,r.start,Ua(e,n),r.chars,"");return kn.operatorNode(Mn.OperatorId.Isect,t)}});function Ja(e,r,n){return Na(e,ma(Ia(r,e)),function(e,r,t){return 0===t.length?r:t.reduce(n(e),r)})}function Ya(e){return function(r,n){var t=n[0],o=n[1],a=Ma(e,r).start,i=Ma(e,o).end,u=_a(e,a,i,"","");return kn.appNode(t,[r,o],!0,u)}}function qa(e,r){var n=_a(e,Ma(e,r[0]).start,Ma(e,r[r.length-1]).end,"","");return kn.badNode(kn.BadType.Sequence,r,n)}var za,Za,$a=Ja(Na(function(e,r,n,t,o){var a=e[r];if(null==a){var i="calc.parse.pStart: internal error: expected term at "+r+" in "+v(e);return S.ULS.assertTag(595980864,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}return t(Ua(n,a),r)},ma(pa(function(e,r){return r.kind!==kn.NodeKind.Operator&&r.kind!==Ct.Spaces&&r.kind!==Ct.End?r:void 0})),function(e,r,n){return 0===n.length?kn.literalNode(yn.missingOper,!0,_a(e,r,r,"","")):1===n.length?n[0]:qa(e,n)}),ja,Ya),ei=Ja($a,Xa,Ya),ri=Ja(ei,Qa,Ya),ni=Ja((za=ri,Za=function(e){var r=!0;return function(n,t){var o=Ma(e,t).start,a=Ma(e,n).end,i=_a(e,o,a,"","");if(r&&(r=!1,n.kind===kn.NodeKind.Literal&&"number"==typeof n.oper)){var u=t.id===Mn.OperatorId.Pos?n.oper:-n.oper;return kn.literalNode(u,!0,i)}return kn.appNode(t,[n],!0,i)}},Na(ma(xa),za,function(e,r,n){return 0===r.length?n:r.reduceRight(Za(e),n)})),Wa,function(e){return function(r,n){var t=n[0],o=n[1],a=Ma(e,r).start,i=Ma(e,t).end,u=_a(e,a,i,"",""),c=kn.appNode(t,[r],!0,u);return o.kind===kn.NodeKind.Literal&&Fn.operKind(o.oper)===yn.OperKind.Missing?c:qa(e,[c,o])}}),ti=Ja(ni,Ga,Ya),oi=Ja(ti,Va,Ya),ai=Ja(oi,Ba,Ya),ii=Ja(ai,Ha,Ya),ui=Ja(ii,Ka,Ya);var ci=da(pa(function(e,r){return r.kind===Ct.Spaces?r.chars:void 0}),""),li=function(e,r,n,t,o){var a=e[r];if(null==a){var i="calc.parse.pStart: internal error: expected token at "+r+" in "+v(e);return S.ULS.assertTag(595980830,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}return t(a.start,r)};function si(e){return pa(function(r,n){return n.kind===Ct.Sep&&n.value===e||void 0})}function fi(e){return pa(function(r,n){return n.kind===Ct.Left&&n.value===e?n.start:void 0})}function di(e){return pa(function(r,n){return n.kind===Ct.Right&&n.value===e||void 0})}var Ei,pi=si(Nt.List),vi=si(Nt.Row),hi=si(Nt.Col),gi=si(Nt.Qual),Ti=fi(At.Paren),mi=di(At.Paren),Si=fi(At.Brace),Ri=di(At.Brace),Ii=fi(At.SQuote),Ci=di(At.SQuote),Ai=pa(function(e,r){return r.kind===Ct.Operator&&r.value===Mn.OperatorId.Range||void 0}),Ni=Ei={impl:function(e,r,n,t,o){return S.ULS.assertTag(595980828,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.delayed: internal error: unassigned DelayedParser")},parser:function(e,r,n,t,o){return function(){return Ei.impl(e,r,n,t,o)}}},Oi=Oa(ci,Ni.parser,ci,Fa),yi=ya(Ti,ba(At.Paren,ua.Union,Oi),da(mi,!1),li,function(e,r,n,t,o){var a=_a(e,r,o,"","");return kn.parenNode(n,t,a)}),Li=Sa(Oi,Da(hi,Oi)),ki=Sa(Li,Da(vi,Li)),Di=ya(Si,ba(At.Brace,ua.Union,ki),da(Ri,!1),li,function(e,r,n,t,o){var a=_a(e,r,o,"","");return kn.arrayNode(n,t,a)}),Mi=pa(function(e,r){if(r.kind===Ct.Ident||r.kind===Ct.CellRef&&r.isQualPart||r.kind===Ct.Literal&&r.isQualPart||r.kind===Ct.Operator&&r.value===Mn.OperatorId.Dot)return r.chars}),_i=Sa(Mi,Mi),Fi=pa(function(e,r){return r.kind===Ct.Ident?r.chars:void 0});function bi(e){return e.kind===Ct.Literal&&"object"==typeof e.oper&&e.oper.kind===yn.OperKind.Error&&e.oper.type===yn.ErrorType.REF}function Ui(e,r,n,t){return null==r?[kn.identQualifier(e,n,t),n?"'"+e+"'":e]:[kn.sheetRangeQualifier(e,r,n,t),n?"'"+e+":"+r+"'":e+":"+r]}var wi=ya(li,_i,da(Da(Ai,_i),void 0),li,function(e,r,n,t,o){var a=_a(e,r,o,"","");return Ui(n.join(""),null!=t?t.join(""):void 0,!1,a)}),Pi=La(Ii,Fi,da(Da(Ai,Fi),void 0),Ci,li,function(e,r,n,t,o,a){return Ui(n,t,!0,_a(e,r,a,"",""))}),Bi=ya(Ii,ma(pa(function(e,r){return r.kind===Ct.End||r.kind===Ct.Right&&r.value===At.SQuote?void 0:r.chars})),da(Ia(Ci,da(ka(gi,ci),!1)),[!1,!1]),li,function(e,r,n,t,o){var a=t[0],i=t[1],u="'"+n.join("")+(a?"'":"")+(i?"!":""),c=_a(e,r,o,"","");return[kn.badNode(kn.BadType.Qualifier,u,c),u]}),xi=ha(function(e,r,n){if(bi(r)){var t=_a(e,r.start,n.start,"","");return[kn.errorQualifierLabeled(t),r.chars]}}),Vi=Na(fa([wi,Pi,va(function(e,r){var n=_a(e,r.start,r.start,"","");return[kn.relativeQualifierLabeled(n),""]})]),ka(gi,ci),function(e,r,n){return[r[0],r[1]+"!"]}),Gi=fa([xi,Vi,Bi]);function Wi(e,r){return r.kind===Ct.CellRef&&e.refStyle===r.refStyle}var Hi=ha(function(e,r,n){return Wi(e,r)?[r,n.start]:void 0});function Ki(e,r){if(null!=e.row&&null!=e.col)return kn.cellRefSingle(e.row,e.col,r);if(null!=e.row)return kn.cellRefRow(e.row,e.row,r);if(null!=e.col)return kn.cellRefCol(e.col,e.col,r);var n="calc.parse.cellRefToken2cellRef: bad token "+v(e);return S.ULS.assertTag(595980831,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}var ji=ha(function(e,r,n){if(Wi(e,r)&&(r.refStyle!==kn.RefStyle.A1||null!=r.row&&null!=r.col))return Ki(r,t=_a(e,r.start,n.start,"",""));if(bi(r)){var t=_a(e,r.start,n.start,"","");return kn.cellRefErrorLabeled(t)}}),Qi=sa(la(Ca(Hi,ci,Ai,ci,Hi),function(e,r){var n=r[0],t=n[0],o=n[1],a=r[1],i=(r[2],r[3]),u=r[4],c=u[0],l=u[1],s=_a(e,t.start,o,"",a),f=_a(e,c.start,l,i,""),d=Ki(t,s),E=Ki(c,f),p=void 0;if(d.kind===kn.CellRefKind.Single&&E.kind===kn.CellRefKind.Single){var v=_a(e,t.start,l,"","");p=kn.cellRefRange(d,E,v)}else if(0===a.length&&0===i.length)if(d.kind===kn.CellRefKind.Row&&E.kind===kn.CellRefKind.Row){v=_a(e,t.start,l,"","");p=kn.cellRefRow(d.row1,E.row1,v)}else if(d.kind===kn.CellRefKind.Col&&E.kind===kn.CellRefKind.Col){v=_a(e,t.start,l,"","");p=kn.cellRefCol(d.col1,E.col1,v)}return null==p?ca:t.isQualPart&&c.isQualPart?va(function(e,r){return r.kind===Ct.Sep&&r.value===Nt.Qual?void 0:p}):ia(p)}),ji),Xi=pa(function(e,r){return r.kind===Ct.Ident||r.kind===Ct.CellRef&&r.isName?r.chars:void 0}),Ji=la(Ca(li,Gi,li,da(sa(Qi,Xi),void 0),li),function(e,r){var n=r[0],t=r[1],o=t[0],a=t[1],i=r[2],u=r[3],c=r[4];if(null==u)return o.kind!==kn.QualifierKind.SheetRange||o.isQuoted?o.kind===kn.QualifierKind.Error?ia(kn.literalNode(yn.refErrorOper,!0,o.label)):ia(o.kind===kn.NodeKind.Bad?o:kn.badNode(kn.BadType.Qualifier,a,o.label)):ca;if("string"==typeof u){if(o.kind===kn.QualifierKind.SheetRange&&!o.isQuoted)return ca;var l=_a(e,n,c,"","");if(o.kind===kn.NodeKind.Bad||o.kind===kn.QualifierKind.Error||o.kind===kn.QualifierKind.SheetRange){var s=o.kind===kn.NodeKind.Bad?o:kn.badNode(kn.BadType.Qualifier,a,o.label),f=kn.nameNode(u,void 0,_a(e,i,c,"",""));return ia(kn.badNode(kn.BadType.Sequence,[s,f],l))}return ia(kn.nameNode(u,o,l))}var d=_a(e,n,c,"","");if(o.kind===kn.NodeKind.Bad||o.kind===kn.QualifierKind.Document){var E=o.kind===kn.NodeKind.Bad?o:kn.badNode(kn.BadType.Qualifier,a,o.label);f=kn.cellRefNode(u,void 0,_a(e,i,c,"",""));return ia(kn.badNode(kn.BadType.Sequence,[E,f],d))}var p=o.kind===kn.QualifierKind.Ident?kn.sheetQualifier(o.name,void 0,o.isQuoted,o.label):o;return ia(kn.cellRefNode(u,p,d))}),Yi=Oa(li,sa(Qi,Xi),li,function(e,r,n,t){var o=_a(e,r,t,"","");return"string"==typeof n?kn.nameNode(n,void 0,o):n.kind===kn.CellRefKind.Error?kn.literalNode(yn.refErrorOper,!0,o):kn.cellRefNode(n,void 0,o)}),qi=ha(function(e,r,n){if(r.kind===Ct.Literal)return kn.literalNode(r.oper,r.hasRight,_a(e,r.start,n.start,"",""));if(r.kind===Ct.CellRef&&r.isNumber&&"object"==typeof r.row&&null!=e.range){var t=r.row.index+e.range.range.row+1;return kn.literalNode(t,!0,_a(e,r.start,n.start,"",""))}});function zi(e){return ha(function(r,n,t){if(e(n)){var o=_a(r,n.start,t.start,"","");return kn.badNode(kn.BadType.Unexpected,n.chars,o)}})}var Zi=zi(function(e){return e.kind===Ct.Left&&e.value===At.Bracket}),$i=zi(function(e){return e.kind===Ct.Right&&e.value===At.Bracket}),eu=La(li,Zi,ba(At.Bracket,ua.Union,Oi),da($i,void 0),li,function(e,r,n,t,o,a){var i=[n,t];null!=o&&i.push(o);var u=_a(e,r,a,"","");return kn.badNode(kn.BadType.Sequence,i,u)}),ru=ha(function(e,r,n){switch(r.kind){case Ct.End:case Ct.Operator:case Ct.Spaces:return;case Ct.Sep:if(r.value!==Nt.Qual&&(e.leftDelim===At.Brace||r.value!==Nt.Col&&r.value!==Nt.Row))return;break;case Ct.Right:if(r.value===e.leftDelim)return}var t=r.kind===Ct.CellRef?kn.BadType.CellRef:kn.BadType.Unexpected,o=_a(e,r.start,n.start,"","");return kn.badNode(t,r.chars,o)}),nu=ha(function(e,r,n){if((r.kind===Ct.Ident||r.kind===Ct.CellRef||r.kind===Ct.Literal&&"boolean"==typeof r.oper)&&n.kind===Ct.Left&&n.value===At.Paren&&null!=e.localeInfo.getWorksheetFuncId(r.chars)){var t=_a(e,r.start,n.start,"","");return kn.nameNode(r.chars,void 0,t)}}),tu=ya(Ti,ba(At.Paren,ua.Arg,Sa(Oi,Da(pi,Oi))),da(mi,!1),li,function(e,r,n,t,o){return[n,t,o]}),ou=Na(nu,tu,function(e,r,n){var t=n[0],o=n[1],a=n[2],i=_a(e,Ma(e,r).start,a,"","");return kn.appNode(r,t,o,i)}),au=Na(fa([ou,Ji,Yi,qi,yi,Di,eu,ru]),ma(tu),function(e,r,n){var t=Ma(e,r).start;return n.reduce(function(r,n){var o=n[0],a=n[1],i=n[2],u=_a(e,t,i,"","");return kn.appNode(r,o,a,u)},r)}),iu=ha(function(e,r,n){var t=void 0;if(r.kind===Ct.Operator&&(t=r.value),r.kind===Ct.Sep&&r.value===Nt.List&&e.listSep===ua.Union&&(t=Mn.OperatorId.Union),null!=t){var o=_a(e,r.start,n.start,"","");return kn.operatorNode(t,o)}}),uu=pa(function(e,r){return r.kind===Ct.Spaces?r:void 0}),cu=sa(au,iu),lu=la(cu,function(e,r){return ga(Ia(da(uu,void 0),cu),function(e,r,n){var t=r[0],o=r[1];return null!=t&&n.push(t),n.push(o),n},[r])}),su=Na(da(lu,void 0),li,function(e,r,n){if(null==r){var t=_a(e,n,n,"","");return kn.literalNode(yn.missingOper,!0,t)}if(1===r.length){var o=r[0];if(o.kind!==kn.NodeKind.Operator&&o.kind!==Ct.Spaces)return o}return r.push(Bt(n)),function(e,r){var n=e.length-1;if(n<0){var t="calc.parse.parseTerms: internal error: expected at least 1 term";return S.ULS.assertTag(595980865,s.LogCategory.msoulscat_ES_EWAJS,!1,t)}if(e[0].kind===Ct.Spaces)return t="calc.parse.parseTerms: internal error: array[0].kind === Spaces in "+v(e),S.ULS.assertTag(595980866,s.LogCategory.msoulscat_ES_EWAJS,!1,t);if(n-1>=0&&e[n-1].kind===Ct.Spaces)return t="calc.parse.parseTerms: internal error: array[n-1].kind === Spaces in "+v(e),S.ULS.assertTag(595980867,s.LogCategory.msoulscat_ES_EWAJS,!1,t);if(e[n].kind!==Ct.End)return t="calc.parse.parseTerms: internal error: array[n].kind !== End in "+v(e),S.ULS.assertTag(595980868,s.LogCategory.msoulscat_ES_EWAJS,!1,t);var o=aa(ui,e,0,r);if(!1===o)return t="calc.parse.parseTerms: internal error: failed to parse "+v(e),S.ULS.assertTag(595980869,s.LogCategory.msoulscat_ES_EWAJS,!1,t);var a=o[0],i=o[1];if(i<n)return t="calc.parse.parseTerms: internal error: consumed "+i+" out of "+n+" in "+v(e),S.ULS.assertTag(595980870,s.LogCategory.msoulscat_ES_EWAJS,!1,t);return a}(r,e)});function fu(e,r,n,t,o){var a=o.length-1;if(a<0){var i="calc.parse.parseTokens: internal error: expected at least 1 token";return S.ULS.assertTag(595980832,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}if(o[a].kind!==Ct.End){i="calc.parse.parseTokens: internal error: array[n] !== End in "+v(o);return S.ULS.assertTag(595980833,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}var u=function(e,r,n,t){return{localeInfo:e,refStyle:r,range:n,source:t,leftDelim:void 0,listSep:ua.Union,label:1,spans:{}}}(e.config.localeInfo,r,n,t),c=aa(Oi,o,0,u);if(!1===c){i="calc.parse.parseTokens: internal error: failed to parse "+v(o);return S.ULS.assertTag(595980834,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}var l=c[0],f=c[1];if(f<a){i="calc.parse.parseTokens: internal error: consumed "+f+" out of "+a+" in "+v(o);return S.ULS.assertTag(595980835,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}return kn.formula(l,u.spans)}Ni.impl=su;var du={"=":1,"+":0,"-":0,"@":-1};function Eu(e){return{parseFormula:function(r,n,t,o){return function(e,r,n,t,o){var a=o[0],i=null!=a?du[a]:void 0;if(null==i)return Fn.failure(pt("first character is not '=', '+', '-' or '@'"));if(i<0)return Fn.failure(ft(["Lotus 1-2-3 syntax"]));if(r===kn.RefStyle.A1&&null==n)return S.ULS.assertTag(595980825,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.parseFormula: in A1 style, expected range to be defined");var u=fu(e,r,n,t,oa(e,r,n,o,i));return Fn.success(u)}(e,r,n,t,o)},formatFormula:function(e,r,n,t){return function(e,r,n,t,o){if(r===kn.RefStyle.A1&&null==n)return S.ULS.assertTag(595980826,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.formatFormula: in A1 style, expected range to be defined");return Fn.failure(ft(["formatFormula"]))}(0,e,r)}}}var pu=kn.QualifierKind,vu=kn.CellRefKind,hu=kn.NodeKind,gu=Fn.ResultKind;function Tu(e){return e.kind===gu.Success}function mu(e,r){var n=e[r];return null==n?C("ParseResultHelper.getFormulaSpan: expected span for label "+r+" to be defined"):n}function Su(e,r,n){return!!Tu(e)&&(function(e,r,n){if(null==e||null==n)return;var t={};null!=r?r.forEach(function(e){t[e]=!0}):t["*"]=!0;var o=[];o.push(e.node);for(;o.length>0;){var a=o.pop();if(null!=a)switch(a.kind){case hu.Literal:c("literal")&&n("literal",{label:a.label,value:a});break;case hu.Array:a.nodes.map(function(e){return e.map(function(e){o.push(e)})});break;case hu.App:if("object"!=typeof a.head)c("literal")&&n("literal",{label:a.label,value:a.head});else{var i=a.head;switch(i.kind){case hu.Operator:c("operator")&&n("operator",{label:a.label,value:i.id});break;case hu.Name:c("function")&&n("function",{label:a.label,name:i.whole,isClosed:a.isClosed,args:a.args});break;default:o.push(i)}}a.args.map(function(e){o.push(e)});break;case hu.Paren:o.push(a.node);break;case hu.Name:if(c("namedRange")){var u=a.whole.split(".");n("namedRange",{label:a.label,name:u[0],names:u.slice(1),qualifier:l(a)})}break;case hu.CellRef:c("range")&&s(a);break;case hu.Bad:break;default:return I("calc.parse.traverseFormula",a)}}function c(e){return t[e]||t["*"]}function l(e){if(null!=e.qualifier){var r={};switch(e.qualifier.kind){case pu.Sheet:var n=e.qualifier;r.type=pu.Sheet,r.sheet=n.sheet,null!=n.document&&(r.document=n.document.document,null!=n.document.path&&(r.documentPath=n.document.path));break;case pu.SheetRange:var t=e.qualifier;r.type=pu.SheetRange,r.sheet1=t.sheet1,r.sheet2=t.sheet2;break;case pu.Ident:var o=e.qualifier;r.type=pu.Ident,r.name=o.name;break;case pu.Document:var a=e.qualifier;r.document=a.document,null!=a.path&&(r.documentPath=a.path)}return r}}function s(r){if(null!=e&&null!=n)switch(r.ref.kind){case vu.Error:break;case vu.Col:var t=r.ref;n("range",{label:r.label,type:"col",startIndex:t.col1,endIndex:t.col2,span:mu(e.spans,t.label),qualifier:l(r)});break;case vu.Row:var o=r.ref;n("range",{label:r.label,type:"row",startIndex:o.row1,endIndex:o.row2,span:mu(e.spans,o.label),qualifier:l(r)});break;case vu.Single:var a=r.ref;n("range",{label:r.label,type:"cell",row:a.row,col:a.col,span:mu(e.spans,a.label),qualifier:l(r)});break;case vu.Range:var i=r.ref;n("range",{label:r.label,type:"range",top:i.ref1.row,left:i.ref1.col,bottom:i.ref2.row,right:i.ref2.col,topLeftSpan:mu(e.spans,i.ref1.label),bottomRightSpan:mu(e.spans,i.ref2.label),qualifier:l(r)})}}}(e.value,r,n),!0)}var Ru,Iu={isSuccess:Tu,traverse:Su,extractReferences:function(e){if(Tu(e)){var r=[];return Su(e,["range","namedRange"],function(n,t){var o={kind:n,ref:t,span:mu(e.value.spans,t.label)};r.push(o)}),r.sort(function(e,r){return e.span.start-r.span.start}),r}}};function Cu(e){return{config:e}}!function(e){e[e.SyntaxError=0]="SyntaxError",e[e.TypeError=1]="TypeError"}(Ru||(Ru={}));var Au={Unclosed_expression:{code:1,category:Ru.SyntaxError},Illegal_array_literal_element:{code:2,category:Ru.SyntaxError},Empty_array_literal:{code:3,category:Ru.SyntaxError},Irregular_array_shape:{code:4,category:Ru.SyntaxError},Empty_parenthesis:{code:5,category:Ru.SyntaxError},Missing_operation_argument:{code:6,category:Ru.SyntaxError},Bad_node:{code:7,category:Ru.SyntaxError},Invalid_binder:{code:8,category:Ru.SyntaxError},Empty_formula:{code:9,category:Ru.SyntaxError},Invalid_rel_sheet_qualifier_in_cell:{code:10,category:Ru.SyntaxError},Types_not_related:{code:1001,category:Ru.TypeError},Unexpected_application_head:{code:1002,category:Ru.TypeError},Unexpected_application_head_with_fix:{code:1003,category:Ru.TypeError},Incorrect_number_of_operator_arguments:{code:1004,category:Ru.TypeError},Excess_function_arguments:{code:1005,category:Ru.TypeError},Insufficient_function_arguments:{code:1006,category:Ru.TypeError}},Nu=kn.NodeKind,Ou=kn.QualifierKind,yu=kn.BadType,Lu=kn.CellRefKind,ku=Nn.FormulaSource,Du=yn.OperKind,Mu=yn.ErrorType,_u=Mn.SignatureType,Fu=Mn.SpecialPrecs,bu=Mn.getOperatorType,Uu=Mn.WorksheetFuncId,wu=Mn.getWorksheetFuncType,Pu=Fn.operKind,Bu=Fn.getArguments,xu=Fn.getArgType,Vu=Fn.defaultLiteralVisitor,Gu=Fn.defaultFormulaVisitor,Wu=Fn.dispatch,Hu=Fn.startVisit,Ku={};function ju(e,r){return{context:e,result:r}}function Qu(e){return function(r){return r.kind===Nu.Literal&&e(r.oper)}}var Xu=Qu(function(e){return Pu(e)===Du.Missing}),Ju=Qu(function(e){return Pu(e)===Du.Error&&e.type===Mu.REF}),Yu=Qu(function(e){return 0!=(Pu(e)&(Du.String|Du.Error|Du.Boolean))});function qu(e){return e.kind===Nu.Name&&void 0===e.qualifier}function zu(e,r,n,t){void 0===t&&(t=!1),t||(e.errorData=e.reportError(r,n,e.errorData))}function Zu(e,r){return r!==Du.Range||0!=(e&Du.Range)}function $u(e,r){if(r.kind===Nu.Literal)switch(zu(e,r,Au.Unclosed_expression,r.isClosed),Pu(r.oper)){case Du.Number:case Du.Boolean:case Du.String:case Du.Error:return;default:return void zu(e,r,Au.Illegal_array_literal_element)}zu(e,r,Au.Illegal_array_literal_element)}function ec(e,r,n){zu(e,r,Au.Types_not_related,Zu(Du.Array,n)),zu(e,r,Au.Unclosed_expression,r.isClosed);var t=r.nodes.length>0;if(zu(e,r,Au.Empty_array_literal,t),!t)return ju(e,n);for(var o=r.nodes[0].length,a=0;a<r.nodes.length;a+=1){var i=r.nodes[a],u=i.length;zu(e,r,Au.Irregular_array_shape,u===o);for(var c=0;c<u;c+=1)$u(e,i[c])}return ju(e,n)}function rc(e,r,n){if(e.earlyExit&&!e.isOk())throw Ku;switch(r.kind){case Nu.Array:return ec(e,r,n);case Nu.Paren:return zu(e,r,Au.Unclosed_expression,r.isClosed),zu(e,r,Au.Empty_parenthesis,!Xu(r.node)),rc(e,r.node,n);case Nu.Bad:case Nu.Name:case Nu.CellRef:case Nu.App:case Nu.Literal:var t=oc(e,r);return zu(e,r,Au.Types_not_related,Zu(t.result,n)),t.result=n,t;default:return I("calc.analyze.checker.check: unhandled formula case",r)}}function nc(e,r,n){var t,o=wu(r),a=n.args,i=a.length,u=Bu(n),c=u.length,l=e.isOk();c<o.minArgs&&zu(e,void 0===(t=a[i-1])?n:t,Au.Insufficient_function_arguments);0===o.restTypes.length&&c>o.headTypes.length&&zu(e,void 0===(t=a[i-1])?n:t,Au.Excess_function_arguments);o.restTypes.length>1&&r!==Uu.SWITCH&&((c-o.headTypes.length)%o.restTypes.length!=0&&zu(e,void 0===(t=a[i-1])?n:t,Au.Insufficient_function_arguments));for(var s=0;s<c;s+=1)rc(e,u[s],xu(o,s));var f=!l||e.isOk();return f&&(e.specialDependencies|=o.staticPrecs,function(e,r,n){switch(r){case Uu.LET:var t=n[0];return void 0!==t?zu(e,t,Au.Invalid_binder,qu(t)):I("calc.anaylze.checker.applySpecificWorksheetFunctionChecks: undefined binder",t);case Uu.FUN:for(var o=0;o<n.length-1;o+=1){var a=n[o];zu(e,a,Au.Invalid_binder,qu(a))}}}(e,r,a)),ju(e,f?o.returnType:_u.All)}function tc(e,r){zu(e,r,Au.Unclosed_expression,r.isClosed);var n=r.args;if(r.head.kind===Nu.Operator)return function(e,r,n){var t=bu(r.id),o=n.length,a=o===t.minArgs;zu(e,r,Au.Incorrect_number_of_operator_arguments,a);for(var i=0;i<o;i+=1){var u=n[i];Xu(u)&&(a=!1,zu(e,u,Au.Missing_operation_argument)),rc(e,u,xu(t,i))}return a?(e.specialDependencies|=t.staticPrecs,ju(e,t.returnType)):ju(e,_u.All)}(e,r.head,n);if(qu(r.head)){var t=e.globals.config.localeInfo.getWorksheetFuncId(r.head.whole.toLocaleUpperCase());if(void 0!==t)return nc(e,t,r)}for(var o=0;o<n.length;o+=1)rc(e,n[o],_u.All);var a=r.head,i=oc(e,a);return Zu(i.result,Du.Range)||i.result===Du.Error&&function(e){for(var r=e;r.kind===Nu.Paren;)r=r.node;return Ju(r)}(a)?ju(e,_u.All):(zu(e,a,Yu(a)||a.kind===Nu.Array?Au.Unexpected_application_head:Au.Unexpected_application_head_with_fix),ju(e,_u.All))}function oc(e,r){if(e.earlyExit&&!e.isOk())throw Ku;switch(r.kind){case Nu.App:return tc(e,r);case Nu.Array:return ec(e,r,Du.Array);case Nu.Bad:return zu(e,r,Au.Bad_node),ju(e,_u.All);case Nu.CellRef:return e.source!==ku.Cell&&e.source!==ku.Range||void 0===r.qualifier||r.qualifier.kind!==Ou.Relative?ju(e,Du.Range):(zu(e,r,Au.Invalid_rel_sheet_qualifier_in_cell),ju(e,_u.All));case Nu.Literal:return zu(e,r,Au.Unclosed_expression,r.isClosed),ju(e,Pu(r.oper));case Nu.Name:return ju(e,_u.All);case Nu.Paren:return zu(e,r,Au.Unclosed_expression,r.isClosed),zu(e,r,Au.Empty_parenthesis,!Xu(r.node)),oc(e,r.node);default:return I("calc.analyze.checker.infer: unhandled formula case",r)}}var ac={ok:!0,isOk:Hr,collect:function(e,r,n){return!1}};function ic(e,r,n,t,o){void 0===o&&(o=!0);var a={globals:e,location:r,source:n,reportError:t.collect,isOk:function(){return t.isOk(a.errorData)},earlyExit:o,specialDependencies:Fu.None,errorData:t.ok};return a}function uc(e,r){try{return zu(e,r.node,Au.Empty_formula,!Xu(r.node)),rc(e,r.node,_u.All)}catch(r){return r!==Ku&&S.ULS.traceTag(595952020,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Exception in calc.analyze.check.runChecker: "+v(r)),ju(e,_u.All)}}function cc(e,r){if(r.kind!==Nu.Bad||r.type!==yu.Sequence||3!==r.contents.length)return!1;var n=r.contents[0],t=r.contents[2];return n.kind===Nu.Bad&&n.type===yu.Unexpected&&n.contents===e.leftBracket&&(t.kind===Nu.Bad&&t.type===yu.Unexpected&&t.contents===e.rightBracket)}function lc(e,r){if(2===r.length){var n,t=r[0],o=r[1];return cc(e,t)?(n=o).kind===Nu.Name&&null!=n.qualifier&&n.qualifier.kind===Ou.Ident?Nu.Name:function(e){return e.kind===Nu.CellRef&&null!=e.qualifier&&e.qualifier.kind===Ou.Sheet&&null==e.qualifier.document}(o)?Nu.CellRef:void 0:function(e,r){return r.kind===Nu.Bad&&r.type===yu.Qualifier&&r.contents.indexOf(e.leftBracket)>=0}(e,t)?qu(o)?Nu.Name:function(e){return e.kind===Nu.CellRef&&null==e.qualifier}(o)?Nu.CellRef:void 0:void 0}}function sc(e){if(e.kind===Nu.Literal&&e.isClosed)switch(Pu(e.oper)){case Du.Number:case Du.Boolean:case Du.String:case Du.Error:return!0;default:return!1}return!1}function fc(e,r){var n=r.head,t=n.kind!==Nu.Operator;if(!r.isClosed||r.args.some(function(r){return!dc(e,r,t)}))return!1;if(n.kind===Nu.Operator)return(a=bu(n.id)).minArgs===r.args.length;if(!dc(e,n,!1))return!1;if(qu(n)){var o=e.config.localeInfo.getWorksheetFuncId(n.whole.toLocaleUpperCase());if(void 0!==o){var a=wu(o),i=Bu(r).length;if(i<a.minArgs)return!1;if(0===a.restTypes.length&&i>a.headTypes.length)return!1;if(a.restTypes.length>1&&o!==Uu.SWITCH)if((i-a.headTypes.length)%a.restTypes.length!=0)return!1;return function(e,r){switch(e){case Uu.LET:return qu(r[0]);case Uu.FUN:return r.slice(0,r.length-1).every(qu);default:return!0}}(o,r.args)}}return!0}function dc(e,r,n){switch(r.kind){case Nu.Literal:return r.isClosed&&(!!n||Pu(r.oper)!==Du.Missing);case Nu.Name:case Nu.CellRef:return!0;case Nu.Array:return r.isClosed&&r.nodes.length>0&&r.nodes.every(function(e){return n=e,t=r.nodes[0].length,n.length===t&&n.every(sc);var n,t});case Nu.App:return fc(e,r);case Nu.Paren:return r.isClosed&&dc(e,r.node,!1);case Nu.Bad:return!1;default:return I("calc.analyze.isWF",r)}}function Ec(e,r,n){switch(r.kind){case Nu.Literal:case Nu.Name:break;case Nu.CellRef:r.ref.kind===Lu.Row&&(n.rowRef+=1),r.ref.kind===Lu.Col&&(n.colRef+=1);break;case Nu.Array:r.nodes.forEach(function(r){return r.forEach(function(r){return Ec(e,r,n)})});break;case Nu.App:r.head.kind!==Nu.Operator&&Ec(e,r.head,n),r.args.forEach(function(r){return Ec(e,r,n)});break;case Nu.Paren:Ec(e,r.node,n);break;case Nu.Bad:if(r.type===yu.Sequence){var t=r.contents;if(function(e,r){return 2===r.length&&qu(r[0])&&cc(e,r[1])}(e,t))n.structRef+=1;else{var o=lc(e,t);null!=o?(o===Nu.Name?n.docQualName+=1:o===Nu.CellRef&&(n.docQualCellRef+=1),Ec(e,t[1],n)):t.forEach(function(r){return Ec(e,r,n)})}}else r.type===yu.Qualifier&&(n.badQual+=1);break;default:return I("calc.analyze.collectRefStats",r)}}var pc=Gu(Vu(function(e){return 1}),function(e){return 1},{vArray:function(e){var r=-1;return e.nodes.forEach(function(e){e.forEach(function(e){var n=Wu(e,pc);r=Math.max(r,n)})}),1+r},vRange:function(e){var r=Wu(e.ref1,pc),n=Wu(e.ref2,pc);return 1+Math.max(r,n)},vBad:function(e){if(e.type===yu.Sequence){var r=-1;return e.contents.forEach(function(e){var n=Wu(e,pc);r=Math.max(r,n)}),1+r}return 1},vCellRef:function(e){var r=-1;if(void 0!==e.qualifier){var n=Wu(e.qualifier,pc);r=Math.max(r,n)}return 1+Math.max(r,Wu(e.ref,pc))},vParen:function(e){return 1+Wu(e.node,pc)},vApp:function(e){var r=-1;return e.args.forEach(function(e){var n=Wu(e,pc);r=Math.max(r,n)}),1+r}});var vc=[];function hc(e,r,n,t,o){var a,i={rowRef:0,colRef:0,structRef:0,docQualName:0,docQualCellRef:0,badQual:0};if(Ec(e.config.localeInfo,t.node,i),i.rowRef+i.colRef+i.structRef+i.docQualName+i.docQualCellRef+i.badQual>0&&S.ULS.traceTag(595961670,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.analyze.checkFormula: possible unsupported references; operation: "+o+"; anonymize: "+v(t.node)+"; stats = "+JSON.stringify(i)),Gr(wr.CalcStrictFormulaChecking))if(vc.length<10){var u=(a=t.node,Hu(a,pc,-1));vc.push(u)}else S.ULS.traceTag(595957962,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.analyze.checkFormula: 10 tree depths = "+vc.join("; ")),vc=[];var c=Gr(wr.CalcStrictFormulaChecking)?function(e,r,n,t){return uc(ic(e,r,n,ac),t).context.errorData}(e,r,n,t):dc(e,t.node,!1);return c||function(e){e.kind!==Nu.App||e.isClosed||S.ULS.traceTag(595949718,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.analyze.tracePossibleFixes: formula missing paren that could be automatically closed")}(t.node),it({},t,{isWellFormed:c})}var gc,Tc,mc=yn.SpecialPrecs,Sc=yn.precedents;function Rc(e){return{findStaticPrecedents:function(e){return Sc([],[],mc.All,!1)},checkFormula:function(r,n,t,o){return hc(e,r,n,t,void 0!==o?o:"undefined")},checkFormulaWithCodes:function(r,n,t){return function(e,r,n,t){return uc(ic(e,r,n,{ok:[],isOk:function(e){return 0===e.length},collect:function(e,r,n){return n.push({label:e.label,errorCode:r.code}),n}},!1),t).context.errorData}(e,r,n,t)},findBestFormat:function(e,r,n){n.node}}}!function(e){e.WorksheetFunction="WorksheetFunction"}(gc||(gc={})),function(e){e.RangeValues="RangeValues"}(Tc||(Tc={}));var Ic=yn.div0ErrorOper,Cc=yn.numErrorOper,Ac=Math.pow(2,-52),Nc=Math.pow(2,-1022);function Oc(e){return Math.abs(e)<Nc?0:e}function yc(e){return isFinite(e)?Oc(e):Cc}var Lc=Math.pow(2,32)-2;function kc(e,r){var n=Math.pow(e,r);return isFinite(n)?Oc(n):r<0?Ic:Cc}var Dc,Mc,_c,Fc={sqrt:function(e){return yc(Math.sqrt(e))},sqrtpi:function(e){return yc(function(e){var r=e*Math.PI;return isFinite(r)?Math.sqrt(r):Math.sqrt(e)*Math.sqrt(Math.PI)}(e))},exp:function(e){return yc(Math.exp(e))},power:function(e,r){return 0===r?0===e?Cc:1:0===e?r<0?Ic:0:e>0?kc(e,r):function(e){if(e<-Lc||e>Lc)return!1;if(e===Math.floor(e))return!0;var r=Math.abs(e);return 1+-22.5*Ac<=r&&r<=1+2*Ac}(r)?kc(e,Math.round(r)):Cc},ln:function(e){return yc(Math.log(e))},log10:function(e){return yc(Math.log(e)/Math.LN10)},log:function(e,r){if(e<=0||r<=0)return Cc;var n=Math.log(e)/Math.log(r);return isFinite(n)?Oc(n):Ic},sin:function(e){return Math.abs(e)<Math.pow(2,27)?yc(Math.sin(e)):Cc},cos:function(e){return Math.abs(e)<Math.pow(2,27)?yc(Math.cos(e)):Cc},tan:function(e){return Math.abs(e)<Math.pow(2,27)?yc(Math.tan(e)):Cc},asin:function(e){return yc(Math.asin(e))},acos:function(e){return yc(Math.acos(e))},atan:function(e){return yc(Math.atan(e))},atan2:function(e,r){return 0===e&&0===r?Ic:Oc(Math.atan2(r,e))}};!function(e){e[e.Array=-2147483648]="Array",e[e.Fun=-2147483647]="Fun",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483643]="Name",e[e.CellRef=-2147483642]="CellRef",e[e.Ident=-2147483641]="Ident",e[e.If=-2147483640]="If"}(_c||(_c={}));var bc=(Dc=Wr(Hr,Hr)).wrap,Uc=Dc.unwrap,wc=(Mc=Wr(function(e){return-e},function(e){return-e})).wrap,Pc=Mc.unwrap;function Bc(e){return e>0}function xc(e){return{kind:e,data:void 0,children:void 0}}function Vc(e,r,n){var t=xc(_c.Array);return t.children=n,t.data={rows:e,cols:r},t}function Gc(e,r){var n=xc(_c.Fun);return n.children=r,n.data=e,n}function Wc(e,r,n){var t=xc(_c.Let);return t.children=[r,n],t.data=e,t}function Hc(e,r,n){var t=xc(_c.App);return t.children=n,t.data={funName:e,funType:r},t}function Kc(e){var r=xc(_c.Ident);return r.data=e,r}function jc(e,r,n){var t=xc(_c.If);return t.children=[e,r,n],t}function Qc(e){return"object"!=typeof e||e.kind>0}function Xc(e,r){for(var n,t=0;t<e.length;t+=1){var o=e[t],a=r(o);void 0===n?a!==o&&(n=e.slice(0,t)).push(a):n.push(a)}return void 0!==n?n:e}function Jc(e,r){return Xc(e,function(e){return function(r){return Xc(r,e)}}(r))}function Yc(e,r){return r(function(e,r){if(Qc(e))return e;switch(e.kind){case _c.Let:var n=e.children,t=n[0],o=n[1],a=r(t),i=r(o);return t===a&&o===i?e:Wc(e.data,a,i);case _c.App:var u=Xc(e.children,r);return u===e.children?e:Hc(e.data.funName,e.data.funType,u);case _c.If:var c=e.children,l=c[0],s=c[1],f=c[2],d=r(l),E=r(s),p=r(f);return l===d&&s===E&&f===p?e:jc(d,E,p);case _c.Fun:var v=r(e.children);return v===e.children?e:Gc(e.data,v);case _c.Array:var h=Jc(e.children,r);return h===e.children?e:Vc(e.data.rows,e.data.cols,h);case _c.Name:case _c.CellRef:case _c.Ident:return e}}(e,function(e){return Yc(e,r)}))}var qc=function(){function e(e,r,n){A("calc.common.StrictArray2D",e),A("calc.common.StrictArray2D",r);var t=n.length;t<e&&C("calc.common.StrictArray2D: expected elements.length >= "+e+"; given "+t);for(var o=0;o<t;o+=1){var a=n[o].length;a<r&&C("calc.common.StrictArray2D: expected elements["+o+"].length >= "+e+"; given "+a)}this.rows=e,this.cols=r,this.elements=n}return e.prototype.get=function(e,r){return O("calc.common.StrictArray2D.get",e,this.rows),O("calc.common.StrictArray2D.get",r,this.cols),this.elements[e][r]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var r=this;return new zc(this.rows,this.cols,function(n,t){return e(r.elements[n][t])})},e}();var zc=function(){function e(e,r,n){A("calc.common.NonstrictArray2D",e),A("calc.common.NonstrictArray2D",r),this.rows=e,this.cols=r,this.func=n}return e.prototype.get=function(e,r){return O("calc.common.NonstrictArray2D.get",e,this.rows),O("calc.common.NonstrictArray2D.get",r,this.cols),this.func(e,r)},e.prototype.strict=function(){var e=Zc(this.rows,this.cols,this.func);return new qc(this.rows,this.cols,e)},e.prototype.map=function(r){var n=this;return new e(this.rows,this.cols,function(e,t){return r(n.func(e,t))})},e}();function Zc(e,r,n){for(var t=[],o=0;o<e;o+=1){for(var a=[],i=0;i<r;i+=1)a[i]=n(o,i);t[o]=a}return t}function $c(e){return Zc(e.rows,e.cols,e.get.bind(e))}function el(e,r,n){for(var t=[],o=[],a=0;a<r;a+=1)o[a]=n;for(var i=0;i<e;i+=1)t[i]=o;return t}function rl(e,r,n){return new zc(e,r,function(e,r){return n})}var nl,tl=Nn.FormulaSource,ol=Fn.ResultKind,al=Fn.isGridCell,il=Fn.ReasonKind,ul=Fn.notImplemented,cl=Fn.unavailable;!function(e){e.Timeout="Timeout",e.Stopped="Stopped",e.Unevaluated="Unevaluated",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.JavaScriptError="JavaScriptError",e.IllFormedFormula="IllFormedFormula"}(nl||(nl={}));var ll,sl,fl=it({},il,nl);function dl(e,r){return{config:e,mathpack:r}}function El(e){return{kind:fl.IllFormedFormula,message:e}}function pl(e){return{kind:ll.FinalValue,oper:e}}function vl(e){return{kind:ll.PendingValue,anchor:e}}function hl(e,r,n){return r!==tl.Cell||al(e.range)||C("calc.runtime.cellFormula: expected single-cell range; given "+v(e)),{kind:ll.Formula,range:e,source:r,formula:n}}!function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue",e.Formula="Formula"}(ll||(ll={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(sl||(sl={}));var gl={kind:fl.Stopped};function Tl(e){return 0===e.length&&C("calc.runtime.unevaluated: expected nonempty array"),{kind:fl.Unevaluated,anchors:e}}function ml(e,r,n,t,o,a,i,u,c,l,s,f,d,E,p,v){return void 0===v&&(v=function(e){return Ir(ul(["getUsedRange"]))}),{config:e,mathpack:r,getDocumentLoc:function(e,r){return Or(n(e,r))},getSheetIndex:t,getCellValue:o,getCellValues:a,getFirstOrderFunc:i,getNameFormula:u,getCellFormula:c,interruptToken:[sl.Continue],schedulerInfo:null!=p?p:{},setCellValue:l,setCellValues:s,setCellFailure:f,setDynamicPrecs:d,loadObjects:E,getUsedRange:v}}function Sl(e){return{kind:fl.NameCycle,names:e}}function Rl(e){return{kind:fl.CellCycle,cells:e}}function Il(e){return{kind:fl.PreviousFailure,range:e}}function Cl(e){return{kind:fl.JavaScriptError,error:e}}function Al(e){return{kind:ol.Paused,reason:fl.Timeout,resume:e}}function Nl(e){if(e.kind===ol.Failure)return e.reason.kind}var Ol=Nn.gridCell,yl=Nn.gridRange,Ll=yn.arrayOper,kl=yn.naErrorOper,Dl=yn.OperKind,Ml=Dl.Number|Dl.String|Dl.Boolean|Dl.Error|Dl.Rich|Dl.Array,_l=Dl.Number|Dl.String|Dl.Boolean|Dl.Error|Dl.Blank|Dl.Rich,Fl=_l|Dl.Array;function bl(e,r,n){var t=e+": generated Excel error, type "+r+"; "+n;S.ULS.traceTag(596120270,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,t)}function Ul(e){return"object"==typeof e&&e.kind===Dl.Error}function wl(e){return"object"==typeof e&&e.kind===Dl.Blank}function Pl(e){return"object"==typeof e&&e.kind===Dl.Array}function Bl(e){return e.kind===je.Success?e.value:void 0}function xl(e,r){switch(e.kind){case je.Success:return Rr(pl(e.value));case je.Failure:return Ir(Il(r))}}function Vl(e,r,n){var t=Pl(n)?function(e,r,n,t,o,a){if(e===n&&r===t)return o;if(1===e&&1===r)return el(n,t,void 0===o[0]?a:o[0][0]);var i,u=[];i=1===e?function(e,n){return n<r?o[0][n]:a}:1===r?function(r,n){return r<e?o[r][0]:a}:function(n,t){return n<e&&t<r?o[n][t]:a};for(var c=0;c<n;c+=1){u.push([]);for(var l=0;l<t;l+=1)u[c][l]=i(c,l)}return u}(n.rows,n.cols,e,r,n.opers,kl):el(e,r,n);return Ll(e,r,t)}function Gl(e,r){var n=e.row,t=e.col,o=e.rows,a=e.cols,i=r.row,u=r.col,c=r.rows,l=r.cols,s=Math.min(n,i),f=Math.min(t,u),d=Math.max(n+o,i+c)-s,E=Math.max(t+a,u+l)-f;return yl(s,f,d,E)}function Wl(e){return 0===e.length&&C("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(Gl)}function Hl(e,r){var n=e.row,t=e.col,o=e.rows,a=e.cols,i=r.row,u=r.col,c=r.rows,l=r.cols,s=Math.max(n,i),f=Math.max(t,u),d=Math.min(n+o,i+c)-s,E=Math.min(t+a,u+l)-f;if(!(d<=0||E<=0))return yl(s,f,d,E)}function Kl(e){return e.rows*e.cols}var jl,Ql=kn.NodeKind,Xl=Fn.getArguments,Jl=yn.arrayOper,Yl=Mn.WorksheetFuncId,ql=Fn.success,zl=(jl=0,function(){var e=jl;return jl+=1,e});function Zl(e){return"object"!=typeof e||Qc(e)&&("object"!=typeof(r=e)||r.kind===Dl.Error||r.kind===Dl.Array||r.kind===Dl.Rich);var r}function $l(e,r,n){var t=Xl(n).map(function(n){return es(e,r,n)}),o=Mn.getWorksheetFuncType(Yl._UDF);return Hc(wc(Yl._UDF),o,[es(e,r,n.head)].concat(t))}function es(e,r,n){switch(n.kind){case Ql.Array:var t=n.nodes.map(function(n){return n.map(function(n){return es(e,r,n)})});return g=(h=t).length,T=void 0===h[0]?0:h[0].length,h.every(function(e){return e.every(Zl)})?Jl(g,T,h):Vc(g,T,h);case Ql.App:var o=n.head;if(o.kind===Ql.Operator){var a=Xl(n).map(function(n){return es(e,r,n)}),i=Mn.getOperatorType(o.id);return Hc(bc(o.id),i,a)}if(o.kind===Ql.Name&&null==o.qualifier)if(null!=(c=e.config.localeInfo.getWorksheetFuncId(o.whole.toLocaleUpperCase()))){var u=void 0;switch(c){case Yl.LET:u=function(e,r,n){if(3===n.args.length){var t=n.args[0];if(t.kind===Ql.Name&&null==t.qualifier){var o=t.whole,a=zl(),i=jr(r);return i[o]=a,Wc(a,es(e,r,n.args[1]),es(e,i,n.args[2]))}}}(e,r,n);break;case Yl.FUN:u=function(e,r,n){var t=n.args.slice(0,n.args.length-1);if(t.length>0&&t.every(function(e){return e.kind===Ql.Name&&null==e.qualifier})){for(var o=t.map(function(e){return e.whole}),a=o.map(zl),i=jr(r),u=0;u<o.length;u+=1)i[o[u]]=a[u];return Gc(a,es(e,i,n.args[t.length-1]))}}(e,r,n);break;case Yl.IF:u=function(e,r,n){var t=n.args;return 3===t.length?jc(es(e,r,t[0]),es(e,r,t[1]),es(e,r,t[2])):2===t.length?jc(es(e,r,t[0]),es(e,r,t[1]),!1):void 0}(e,r,n);break;default:a=Xl(n).map(function(n){return es(e,r,n)}),i=Mn.getWorksheetFuncType(c);u=Hc(wc(c),i,a)}return void 0===u?$l(e,r,n):u}return $l(e,r,n);case Ql.Paren:return es(e,r,n.node);case Ql.Name:var c;if(null==n.qualifier)if(void 0!==(c=r[n.whole]))return Kc(c);return f=n.whole,d=n.whole.split("."),E=n.qualifier,(p=xc(_c.Name)).data={whole:f.toLocaleUpperCase(),split:d.map(function(e){return e.toLocaleUpperCase()}),qualifier:E},p;case Ql.CellRef:return function(e,r){var n=xc(_c.CellRef);return n.data={ref:e,qualifier:r},n}(n.ref,n.qualifier);case Ql.Literal:return n.oper;case Ql.Bad:var l="calc.runtime.compile: unexpected bad node "+v(n);return S.ULS.assertTag(595980820,s.LogCategory.msoulscat_ES_EWAJS,!1,l);default:return I("calc.runtime.compile",n)}var f,d,E,p,h,g,T}var rs=function(e){if(!Qc(e)&&e.kind===_c.App&&!Bc(e.data.funName)){var r=Pc(e.data.funName);if(r===Yl.IFERROR||r===Yl.IFNA){var n=zl(),t=Kc(n),o=r===Yl.IFERROR?Yl.ISERROR:Yl.ISNA,a=Mn.getWorksheetFuncType(o),i=jc(Hc(wc(o),a,[t]),e.children[1],t);return Wc(n,e.children[0],i)}}return e};var ns,ts="__compiledFormulaBrand__";function os(e,r){return r.kind!==ts?I(e+": expected known compiled formula type; given "+v(r),r):r.term}function as(e,r,n,t){var o=es(e,Kr(),t.node),a=Yc(o,rs);return ql(function(e){return{kind:ts,term:e}}(a))}function is(e){return{compileFormula:function(r,n,t){return as(e,0,0,t)}}}function us(e,r){return 0==(e&r)}function cs(e,r){return(e|r-1)&~r}!function(e){e[e.Empty=0]="Empty",e[e.Lf=1]="Lf",e[e.Br=2]="Br"}(ns||(ns={}));var ls={kind:ns.Empty};function ss(e){return e===ls}function fs(e,r){return{kind:ns.Lf,key:e,value:r}}function ds(e,r,n,t){return{kind:ns.Br,prefix:e,mask:r,l:n,r:t}}function Es(e,r,n,t){var o=function(e,r){return n=e^r,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,(n|=n>>>16)^n>>>1;var n}(e,n),a=cs(e,o),i=us(e,o);return ds(a,o,i?r:t,i?t:r)}var ps,vs=ls,hs=function e(r,n,t){switch(t.kind){case ns.Empty:return fs(r,n);case ns.Lf:var o=fs(r,n);return t.key===r?o:Es(r,o,t.key,t);case ns.Br:return function(e,r,n){return cs(e,n)===r}(r,t.prefix,t.mask)?us(r,t.mask)?ds(t.prefix,t.mask,e(r,n,t.l),t.r):ds(t.prefix,t.mask,t.l,e(r,n,t.r)):Es(r,fs(r,n),t.prefix,t)}},gs=function(e,r){for(var n=r;n.kind===ns.Br;)n=us(e,n.mask)?n.l:n.r;if(!ss(n))return e===n.key?n.value:void 0},Ts=Nn.FormulaSource,ms=Fn.isSheetGridCell,Ss=function(e){this.reason=e,this.name="EvaluationError",this.stack="EvaluationError",this.message=e.kind};function Rs(e){throw new Ss(e)}function Is(e,r,n,t){return{range:e,source:r,precedents:n,visitedCellMap:t}}function Cs(e,r,n,t){if(r===Ts.Cell){if(ms(e))return Is(e,r,n,t);C("calc.runtime.evalLocals: expected single-cell range; given "+v(e))}return Is(e,r,n,t)}Ss.prototype=Object.create(Error.prototype),Ss.prototype.constructor=Ss,function(e){e[e.Default=1]="Default",e[e.Dependency=2]="Dependency",e[e.Call=3]="Call",e[e.Write=4]="Write",e[e.Return=5]="Return"}(ps||(ps={}));var As={kind:ps.Default},Ns=function(){function e(e){this.context=e,this.latestTransition=ps.Default}return e.prototype.cleanup=function(){},e.prototype.performDefaultTransition=function(){return this.latestTransition=ps.Default,As},e.prototype.performDependencyTransition=function(e){return this.latestTransition=ps.Dependency,{kind:ps.Dependency,machines:e}},e.prototype.performCallTransition=function(e){return this.latestTransition=ps.Call,{kind:ps.Call,machine:e}},e.prototype.performWriteTransition=function(e,r){return this.latestTransition=ps.Write,{kind:ps.Write,result:e,locals:r}},e.prototype.performReturnTransition=function(e){return this.latestTransition=ps.Return,{kind:ps.Return,result:e}},e}(),Os={newVisitedMap:Ls,visit:function(e,r,n){return ks(bs,e,r,n)},unVisit:function(e,r,n){return Ds(bs,e,r,n)},lookup:function(e,r){return Ms(bs,e,r)},runFrom:function(e,r){return _s(bs,e,r)}},ys={newVisitedMap:Ls,visit:function(e,r,n){return ks(Us,e,r,n)},unVisit:function(e,r,n){return Ds(Us,e,r,n)},lookup:function(e,r){return Ms(Us,e,r)},runFrom:function(e,r){return _s(Us,e,r)}};function Ls(){return{run:[],visited:Kr()}}function ks(e,r,n,t){var o=e(r);t.visited[o]=n,t.run.push([o,r])}function Ds(e,r,n,t){var o=e(r);t.visited[o]=n,t.run.pop()}function Ms(e,r,n){return n.visited[e(r)]}function _s(e,r,n){for(var t=[],o=n.run,a=0;a<o.length;){var i=o[a][0];if(e(r)===i)break;a+=1}for(;a<o.length;)t.push(o[a][1]),a+=1;return t}function Fs(e){var r=e.document,n=e.index,t="$";return null!=r.path&&(t+=r.path),t+=";",t+=r.name,t+=";",null!=n&&(t+=n,t+=";"),t}function bs(e){var r=Fs(e.scope);return r+=";",r+=e.name}function Us(e){var r=Fs(e.sheet);return r+=";",r+=e.range.row,r+=";",r+=e.range.col}var ws=yn.SpecialPrecs,Ps=yn.precedents,Bs=yn.OperKind,xs=Fn.failure,Vs=Fn.sheetGridRangeAnchor,Gs=Fn.success,Ws=Fn.ResultKind,Hs=function(e){function r(r,n){var t=e.call(this,r)||this;return t.cell=n,t.locals=void 0,t}return at(r,e),r.prototype.getRealReason=function(e){if(e.kind!==fl.PreviousFailure)return e;var r=Vs(e.range),n=ys.lookup(r,this.context.visitedCellMap);return"object"==typeof n&&n.kind===Ws.Failure?n.reason:e},r.prototype.visitAnchor=function(e){var r=Vs(e.range),n=ys.lookup(r,this.context.visitedCellMap);if(null!=n){var t="calc.runtime.CellEvaluationMachine.visitAnchor: "+("unexpected visitValue at "+v(r)+"; given "+v(n));return S.ULS.assertTag(595980812,s.LogCategory.msoulscat_ES_EWAJS,!1,t)}ys.visit(r,ll.PendingValue,this.context.visitedCellMap);var o=Ps([],[],ws.None,!0);return this.locals=Cs(e.range,e.source,o,this.context.visitedCellMap),this.locals},r.prototype.unVisitAnchor=function(e){var r=this.locals;if(null!=r){var n=Vs(r.range);return ys.unVisit(n,e,this.context.visitedCellMap),this.locals=void 0,r}},r.prototype.next=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===Ws.Failure)return this.performReturnTransition(xs(this.getRealReason(e.reason)));var r=e.value;if(r.kind===ll.FinalValue)return this.performReturnTransition(Gs(r.oper));var n=this.context.globals.getCellFormula(r.anchor);if(n.kind===Ws.Failure){var t="calc.runtime.CellEvaluationMachine.next: returning Failure from getCellFormula is deprecated";return S.ULS.assertTag(595980813,s.LogCategory.msoulscat_ES_EWAJS,!1,t)}var o=n.value;if(null==o){t="calc.runtime.CellEvaluationMachine.next: "+("client error: expected getCellFormula("+v(r.anchor)+") != null");return S.ULS.assertTag(595980814,s.LogCategory.msoulscat_ES_EWAJS,!1,t)}var a=this.visitAnchor(o),i=this.context.createFormulaEvaluationMachine(this.context,a,o.formula);return this.performCallTransition(i)},r.prototype.receiveSuccess=function(e){var r=e.value;if("object"==typeof r&&(r.kind===Bs.Range||r.kind===Bs.Missing)){var n="calc.runtime.CellEvaluationMachine.receiveSuccess: "+("expected ReadOper; given "+v(r));return S.ULS.assertTag(595980815,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}var t=this.unVisitAnchor(void 0);if(null==t){n="calc.runtime.CellEvaluationMachine.receiveSuccess: expected this.locals != null";return S.ULS.assertTag(595980816,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}return this.performWriteTransition(e,t)},r.prototype.receiveFailure=function(e){var r=this.getRealReason(e.reason);if(r.kind===fl.Unevaluated){var n="calc.runtime.CellEvaluationMachine.receiveFailure: "+("unexpected reason "+v(r));return S.ULS.assertTag(595980817,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}var t=r===e.reason?e:xs(r),o=this.unVisitAnchor(t);if(null==o){n="calc.runtime.CellEvaluationMachine.receiveFailure: expected this.locals != null";return S.ULS.assertTag(595980818,s.LogCategory.msoulscat_ES_EWAJS,!1,n)}return this.performWriteTransition(t,o)},r.prototype.cleanup=function(){this.unVisitAnchor(void 0)},r}(Ns);function Ks(e,r){return new Hs(e,r)}function js(e,r){if(0===r.length)return[];for(var n=vd(e),t=[],o=0;o<r.length;o+=1)t.push(Ks(n.machineContext,r[o]));return function e(r,n){var t=r.evaluate(n);return t instanceof Array?t:Al(function(t){return e(r,"number"==typeof t?t:n)})}(new Td(n,t),Ed(dd(e.schedulerInfo)))}var Qs=Nn.FormulaSource,Xs=Nn.sheetGridCell,Js=Nn.sheetGridRange,Ys=yn.OperKind,qs=yn.ErrorType,zs=yn.refErrorOper,Zs=yn.valueErrorOper,$s=yn.arrayOper,ef=Fn.ResultKind,rf=Fn.isGridCell,nf=Fn.isSheetIndex,tf=Fn.getArgType;function of(e,r){if(ys.lookup(e,r.visitedCellMap)===ll.PendingValue)return Rs(Rl(ys.runFrom(e,r.visitedCellMap)))}function af(e,r,n,t){r.precedents.cells.push(n);var o=e.getCellValue(n);if(o.kind===ef.Failure)return Rs(o.reason);var a=o.value;if(a.kind===ll.FinalValue)return a.oper;of(a.anchor,r),t.push(a.anchor)}function uf(e,r,n,t){r.precedents.cells.push(n);var o=e.getCellValues(n);if(o.kind===ef.Failure)return Rs(o.reason);var a=t.length,i=function(e,r,n){for(var t=[],o=r.length,a=0,i=0;i<o;i+=1){t.push([]);var u=r[i].length;a=0===a?u:Math.min(u,a);for(var c=0;c<u;c+=1){var l=r[i][c];ll.FinalValue===l.kind?t[i][c]=l.oper:(of(l.anchor,e),n.push(l.anchor),t[i][c]=zs)}}return new qc(o,a,t)}(r,o.value,t);return a===t.length?i:void 0}function cf(e,r,n,t){var o=uf(e,r,n,t);if(null!=o)return $s(o.rows,o.cols,$c(o.map(function(e){return wl(e)?0:e})))}function lf(e,r,n,t,o){if(0!=(t&Ys.Range))return n;if("object"!=typeof n||n.kind!==Ys.Range)return n;var a=n.sheets;if(!nf(a))return bl("calc.runtime.dereference",qs.REF,"3D range, oper = "+v(n)),zs;if(1!==n.ranges.length)return bl("calc.runtime.dereference",qs.VALUE,"union range, oper = "+v(n)),Zs;var i=n.ranges[0];if(0!=(t&_l)){if(rf(i))return af(e,r,Xs(a,i),o);if(r.source===Qs.Cell){var u=function(e,r){var n=e.row,t=e.col,o=r.row,a=r.col,i=r.rows,u=r.cols,c=o<=n&&n<o+i,l=a<=t&&t<a+u;return c&&l?Ol(n,t):c&&1===u?Ol(n,a):l&&1===i?Ol(o,t):void 0}(r.range.range,i);return null==u?(bl("calc.runtime.dereference",qs.VALUE,"empty intersection, oper = "+v(n)),Zs):af(e,r,Xs(a,u),o)}return cf(e,r,Js(a,i),o)}return 0!=(t&Ys.Array)?cf(e,r,Js(a,i),o):(bl("calc.runtime.dereference",qs.VALUE,"bad target type "+t),Zs)}function sf(e,r,n,t){for(var o=[],a=0;a<n.length;a+=1){var i=lf(e,r,n[a],tf(t,a),o);null!=i&&(n[a]=i)}if(o.length>0)return Rs(Tl(o))}var ff=yn.OperKind,df=yn.valueErrorOper,Ef=yn.arrayOper,pf=Fn.operKind,vf=[df,0,"",!1,!1],hf=ff.Number|ff.String|ff.Boolean;function gf(e){var r=e&hf;return vf[r&-r]}function Tf(e,r,n){var t=function e(r,n,t){if("number"==typeof n)return 0!=(t&ff.Number)?n:0!=(t&ff.String)?r.formatNumber(n):0!=(t&ff.Boolean)?0!==n:0!=(t&ff.Array)?Ef(1,1,[[n]]):df;if("string"==typeof n){if(0!=(t&ff.String))return n;if(0!=(t&ff.Number)){if(0===n.length)return df;var o=r.parseNumber(n);return Sr(o)?o:df}return 0!=(t&ff.Boolean)?0===r.stringCompareCI(n,r.trueName)||0!==r.stringCompareCI(n,r.falseName)&&df:df}if("boolean"==typeof n)return 0!=(t&ff.Boolean)?n:0!=(t&ff.Number)?n?1:0:0!=(t&ff.String)?n?r.trueName:r.falseName:df;if(0!=(t&n.kind))return n;switch(n.kind){case ff.Error:return n;case ff.Missing:return 0!=(t&ff.Blank)?yn.blankOper:gf(t);case ff.Blank:return gf(t);case ff.Rich:return e(r,n.getFallback(),t);default:return df}}(e.config.localeInfo,r,n);return Ul(t)&&!Ul(r)&&bl("calc.runtime.coerceOper",t.type,"kind = "+pf(r)),t}var mf=Nn.sheetIndex,Sf=yn.OperKind,Rf=yn.rangeSeqOper,If=yn.ErrorType,Cf=yn.valueErrorOper,Af=yn.div0ErrorOper,Nf=yn.nullErrorOper,Of=Mn.OperatorId,yf=Fn.operKind,Lf=Fn.isSheetIndex;function kf(e,r){switch(e){case Of.Eq:return 0===r;case Of.Ne:return 0!==r;case Of.Lt:return r<0;case Of.Gt:return r>0;case Of.Le:return r<=0;case Of.Ge:return r>=0}}function Df(e,r,n){return kf(e,r-n)}function Mf(e,r,n){return kf(e,r.toLocaleUpperCase().localeCompare(n.toLocaleUpperCase()))}function _f(e,r,n){return kf(e,r<n?-1:r>n?1:0)}function Ff(e,r,n){if(Lf(r.sheets))if(Lf(n.sheets))if(r.sheets.document===n.sheets.document){if(r.sheets.index===n.sheets.index)return mf(r.sheets.document,r.sheets.index);t="different sheet, range1 = "+v(r)+", range2 = "+v(n);bl(e,If.VALUE,t)}else{var t="different document, range1 = "+v(r)+", range2 = "+v(n);bl(e,If.VALUE,t)}else bl(e,If.VALUE,"3D reference, range2 = "+v(n));else bl(e,If.VALUE,"3D reference, range1 = "+v(r))}function bf(e,r,n){if(1===n.length){var t=n[0];switch(r){case Of.Percent:return Oc(t/100);case Of.Neg:return-t;case Of.Pos:return t;default:var o="bad application of "+r+" to 1 argument";return bl("calc.runtime.applyOperator",If.VALUE,o),Cf}}if(2===n.length){t=n[0];var a=n[1];switch(r){case Of.Add:return yc(t+a);case Of.Sub:return yc(t-a);case Of.Mul:return yc(t*a);case Of.Div:return 0===a?(bl("calc.runtime.applyOperator",If.DIV0,"division by zero"),Af):yc(t/a);case Of.Pow:return e.mathpack.power(t,a);case Of.Concat:return t+a;case Of.Eq:case Of.Ne:case Of.Lt:case Of.Le:case Of.Gt:case Of.Ge:return function(e,r,n){var t=yf(r),o=yf(n);if(t!==o){if(t===Sf.Blank)switch(o){case Sf.Number:return _f(e,0,n);case Sf.String:return Mf(e,"",n);case Sf.Boolean:return Df(e,!1,n)}if(o===Sf.Blank)switch(t){case Sf.Number:return _f(e,r,0);case Sf.String:return Mf(e,r,"");case Sf.Boolean:return Df(e,r,!1)}return kf(e,t-o)}switch(t){case Sf.Number:return _f(e,r,n);case Sf.String:return Mf(e,r,n);case Sf.Boolean:return Df(e,r,n);case Sf.Blank:return kf(e,0);default:return!1}}(r,t,a);case Of.Range:return function(e,r){var n=Ff("calc.runtime.applyRangeOp",e,r);if(null==n)return Cf;var t=[Gl(Wl(e.ranges),Wl(r.ranges))];return Rf(n,t)}(t,a);case Of.Isect:return function(e,r){var n=Ff("calc.runtime.applyIsectOp",e,r);if(null==n)return Cf;for(var t=[],o=0;o<e.ranges.length;o+=1)for(var a=0;a<r.ranges.length;a+=1){var i=Hl(e.ranges[o],r.ranges[a]);null!=i&&t.push(i)}if(0===t.length){var u="empty intersection, range1 = "+v(e)+", range2 = "+v(r);return bl("calc.runtime.applyIsectOp",If.NULL,u),Nf}return Rf(n,t)}(t,a);case Of.Union:return null==(l=Ff("calc.runtime.applyUnionOp",u=t,c=a))?Cf:Rf(l,u.ranges.concat(c.ranges));case Of.And:return t&&a;case Of.Or:return t||a;case Of.Xor:return t!==a;case Of.Min:return Math.min(t,a);case Of.Max:return Math.max(t,a);default:var i="bad application of "+r+" to 2 arguments";return bl("calc.runtime.applyOperator",If.VALUE,i),Cf}}var u,c,l,s="bad application of "+r+" to "+n.length+" arguments";return bl("calc.runtime.applyOperator",If.VALUE,s),Cf}var Uf=Nn.sheetIndex,wf=Nn.sheetGridRange,Pf=yn.arrayOper,Bf=yn.nameErrorOper,xf=yn.naErrorOper,Vf=yn.numErrorOper,Gf=yn.valueErrorOper,Wf=yn.OperKind,Hf=yn.ErrorType,Kf=yn.SpecialPrecs,jf=Mn.functionType,Qf=Mn.FunctionFlags,Xf=Mn.SignatureType,Jf=Mn.WorksheetFuncId,Yf=Mn.getOperatorType,qf=Mn.getWorksheetFuncType,zf=Fn.operKind,Zf=Fn.ResultKind,$f=Fn.success,ed=Fn.getArgType,rd=Fn.isValidArgsLength,nd=Wf.Number|Wf.String|Wf.Boolean|Wf.Rich|Wf.Error|Wf.Blank,td=jf(3,[Wf.Boolean,nd,nd],[],Xf.All,Kf.None,Qf.None),od=function(){function e(e,r){this.globals=e,this.locals=r}return e.prototype.getMathpack=function(){return this.globals.mathpack},e.prototype.applyFunction=function(e,r){var n=qf(e),t=r.some(function(e){return"object"==typeof e&&e.kind===Wf.Range})?r.slice(0):r;return sf(this.globals,this.locals,t,n),this.runFunctionToCompletion(wc(e),n,t)},e.prototype.applyOperatorOrFunction=function(e,r){if(Bc(e))return bf(this.globals,Uc(e),r);var n=Pc(e);if(n===Jf._UDF)return Rs(ul(["call UDF"]));var t=this.globals.getFirstOrderFunc(n);if(t.kind===Zf.Failure)return Rs(t.reason);var o=t.value;if(null==o){var a="nonexistent worksheet function "+n;return bl("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",Hf.NAME,a),Bf}var i=o(this,r);if("object"==typeof i&&i.kind===Wf.Error){a="worksheet function "+n+" return value";bl("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",i.type,a)}return i},e.prototype.arrayLift=function(e,r,n){for(var t=this,o=0,a=0,i=0;i<n.length;i+=1){var u=n[i];Pl(u)&&0==(ed(e,i)&Wf.Array)?(o=Math.max(o,u.rows),a=Math.max(a,u.cols)):(o=Math.max(o,1),a=Math.max(a,1))}var c=n.map(function(r,n){return t.broadcastOper(o,a,r,ed(e,n))}),l=new zc(o,a,function(e,n){return r(c.map(function(r){return r.get(e,n)}))}).map(function(e){var r;if("object"!=typeof(r="object"==typeof e&&e.kind===gc.WorksheetFunction?t.runFunctionMachineToCompletion(e):e))return r;switch(r.kind){case Wf.Range:return Gf;case Wf.Missing:case Wf.Blank:return 0;default:return r}});return Pf(l.rows,l.cols,$c(l))},e.prototype.dispatchFunction=function(e,r,n){var t=this;if(!rd(r,n.length)){var o=JSON.stringify(r),a="bad application of "+JSON.stringify(e)+" to "+n.length+" arguments, ftype = "+o;return bl("calc.runtime.FunctionDispatcher.dispatchFunction",Hf.NUM,a),Vf}for(var i=n.length,u=Xf.None,c=0;c<i;c+=1){var l=zf(n[c]);0==(l&ed(r,c))&&(u|=l)}if(u===Xf.None)return this.applyOperatorOrFunction(e,n);if(0!=(u&Wf.Array)){return this.arrayLift(r,function(n){return t.dispatchFunction(e,r,n)},n)}u&=~Wf.Array;var s=[];for(c=0;c<i;c+=1){var f=n[c];if(0!=(u&zf(f))){var d=ed(r,c);if(f=this.coerceOper(f,d),zf(f)===Wf.Error&&0==(d&Wf.Error))return f}s[c]=f}return this.applyOperatorOrFunction(e,s)},e.prototype.dispatchStrictIf=function(e){var r=this,n=e[0];if("object"!=typeof n){var t=this.coerceOper(n,Wf.Boolean);return!0===t?e[1]:!1===t?e[2]:t}switch(n.kind){case Wf.Error:return n;case Wf.Missing:case Wf.Blank:return e[2];case Wf.Array:return this.arrayLift(td,function(e){return r.dispatchStrictIf(e)},e);case Wf.Rich:return Rs(ul(["calc.runtime.evalFunction.FunctionDispatcher.dispatchStrictIf: Strict IF with a rich value condition"]));case Wf.Range:var o="calc.runtime.FunctionDispatcher.dispatchStrictIf: "+("internal error: range condition "+v(n));return S.ULS.assertTag(595980809,s.LogCategory.msoulscat_ES_EWAJS,!1,o);default:return I("calc.runtime.FunctionDispatcher.dispatchStrictIf",n)}},e.prototype.dereferenceOper=function(e,r){return function(e,r,n,t){var o=[],a=lf(e,r,n,t,o);if(null==a){if(o.length>0)return Rs(Tl(o));var i="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = "+v(n);return S.ULS.assertTag(595980819,s.LogCategory.msoulscat_ES_EWAJS,!1,i)}return a}(this.globals,this.locals,e,r)},e.prototype.dereferenceOpers=function(e,r){sf(this.globals,this.locals,e,r)},e.prototype.dereferenceAllOpers=function(e){for(var r=[],n=[],t=0;t<e.length;t+=1){var o=e[t];if("object"==typeof o&&o.kind===Wf.Range){for(var a=[],i=o.sheets,u=i.index,c=i.length,l=0;l<c;l+=1)for(var s=Uf(o.sheets.document,l+u),f=0;f<o.ranges.length;f+=1){var d=wf(s,o.ranges[f]),E=uf(this.globals,this.locals,d,r);null!=E&&a.push(E)}n.push({kind:Tc.RangeValues,arrays:a})}else n.push(o)}return r.length>0?Rs(Tl(r)):n},e.prototype.makeOperatorReducer=function(e,r){var n=this.getBinaryOperator(e);return function(e,t){return void 0===e?null!=r?r(t):t:n(e,t)}},e.prototype.makeBranchOperatorReducer=function(e,r){var n=this;return function(t,o){var a=n.makeOperatorReducer(e,r)(t,o);return void 0!==t&&!0===a?t:o}},e.prototype.reduceDerefOpers=function(e,r,n){function t(n,t){if(Pl(t))return o(n,new qc(t.rows,t.cols,t.opers));var a=r(t);return null==a?n:e(n,a)}function o(e,r){for(var n=e,o=0;o<r.rows;o+=1)for(var a=0;a<r.cols;a+=1)n=t(n,r.get(o,a));return n}return n.reduce(function(e,r){return"object"==typeof r&&r.kind===Tc.RangeValues?r.arrays.reduce(o,e):t(e,r)},void 0)},e.prototype.broadcastOper=function(e,r,n,t){if("object"!=typeof n)return rl(e,r,n);switch(n.kind){case Wf.Missing:case Wf.Blank:return rl(e,r,0);case Wf.Array:return 0!=(t&Wf.Array)?rl(e,r,n):function(e,r,n,t){return n.rows===e&&n.cols===r?n:1===n.rows&&1===n.cols?rl(e,r,n.get(0,0)):1===n.rows?new zc(e,r,function(e,r){return r<n.cols?n.get(0,r):t}):1===n.cols?new zc(e,r,function(e,r){return e<n.rows?n.get(e,0):t}):new zc(e,r,function(e,r){return e<n.rows&&r<n.cols?n.get(e,r):t})}(e,r,new qc(n.rows,n.cols,n.opers),xf);case Wf.Range:default:return rl(e,r,n)}},e.prototype.coerceOper=function(e,r){return Tf(this.globals,e,r)},e.prototype.getBinaryOperator=function(e){var r=this,n=Yf(e),t=[0,0];return function(o,a){return t[0]=o,t[1]=a,sf(r.globals,r.locals,t,n),r.runFunctionToCompletion(bc(e),n,t)}},e.prototype.getUnaryOperator=function(e){var r=this,n=Yf(e),t=[0];return function(o){return t[0]=o,sf(r.globals,r.locals,t,n),r.runFunctionToCompletion(bc(e),n,t)}},e.prototype.runFunctionToCompletion=function(e,r,n){var t=this.dispatchFunction(e,r,n);return"object"==typeof t&&t.kind===gc.WorksheetFunction?this.runFunctionMachineToCompletion(t):t},e.prototype.runFunctionMachineToCompletion=function(e){for(;;){var r=e.next();if(null!=r)return r}},e}(),ad=function(e){function r(r,n){var t=e.call(this,r)||this;return t.func=n,t}return at(r,e),r.prototype.next=function(){var e=this.func.next();return null==e?this.performDefaultTransition():this.performReturnTransition($f(e))},r.prototype.receiveSuccess=function(e){return S.ULS.assertTag(595980810,s.LogCategory.msoulscat_ES_EWAJS,!1,"calc.runtime.FunctionEvaluationMachine.receiveSuccess: received unexpected result")},r.prototype.receiveFailure=function(e){var r=e.reason;switch(r.kind){case fl.Unevaluated:for(var n=[],t=r.anchors,o=t.length-1;o>=0;o-=1){var a=this.context.createCellEvaluationMachine(this.context,t[o]);n.push(a)}return this.performDependencyTransition(n);default:return this.performReturnTransition(e)}},r}(Ns);function id(e,r){return new ad(e,r)}var ud=Nn.FormulaSource,cd=yn.naErrorOper,ld=Fn.failure,sd=Fn.ResultKind,fd=Fn.createResolver;function dd(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:Date.now()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function Ed(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var r=Date.now()+e.yieldIntervalMs;return void 0===e.endTimeMs?r:Math.min(e.endTimeMs,r)}}var pd={kind:fl.Timeout};function vd(e){return{globals:e,timer:{doTimeout:function(e){return void 0!==e&&Date.now()>=e}},machineContext:hd(e)}}function hd(e){return{globals:e,visitedCellMap:ys.newVisitedMap(),resolver:fd(e),createCellEvaluationMachine:Ks,createFormulaEvaluationMachine:jd,createFunctionEvaluationMachine:id}}var gd,Td=function(){function e(e,r){N("calc.runtime.EvaluationRuntime",r.length),this.context=e,this.inputMachines=r.slice(),this.evaluationStack=[],this.results=[],this.nextIndex=0,this.currentResult=void 0}return e.prototype.evaluateAsync=function(e){var r=this;if(this.context.globals.interruptToken[0]===sl.Stop)return this.generatePartialResults(),S.ULS.traceTag(595953880,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime cancelled."),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var n=this.evaluate(Ed(e));return n instanceof Array?(S.ULS.traceTag(595953881,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime complete."),Promise.resolve(n)):(S.ULS.traceTag(595953882,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime yielding."),new Promise(function(n){return e.scheduleFunction(function(){return S.ULS.traceTag(595964228,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Resuming async evaluation."),n(r.evaluateAsync(e))})}))}catch(e){return Promise.reject(ld(e))}},e.prototype.evaluate=function(e){try{for(;;){if(0===this.evaluationStack.length){if(!(this.nextIndex<this.inputMachines.length))return this.results;this.evaluationStack.push(this.inputMachines[this.nextIndex]),this.nextIndex+=1}if(this.context.timer.doTimeout(e))return pd;var r=this.evaluationStack[this.evaluationStack.length-1],n=this.evaluateMachine(r);switch(this.currentResult=void 0,n.kind){case ps.Default:break;case ps.Dependency:for(var t=0;t<n.machines.length;t+=1)this.evaluationStack.push(n.machines[t]);break;case ps.Call:this.evaluationStack.push(n.machine);break;case ps.Return:case ps.Write:this.performResultTransition(n);break;case fl.JavaScriptError:this.stopEvaluatingWithJavaScriptError(n);break;default:return I("calc.runtime.EvaluationRuntime.evaluate",n)}}}catch(e){var o="calc.runtime.EvaluationRuntime.evaluate: unhandled error "+e.message;return S.ULS.assertTag(595980807,s.LogCategory.msoulscat_ES_EWAJS,!1,o)}},e.prototype.evaluateMachine=function(e){try{if(null==this.currentResult)return e.next();if(this.currentResult.kind===sd.Success)return e.receiveSuccess(this.currentResult)}catch(e){if(!(e instanceof Ss))return Cl(e);this.currentResult=ld(e.reason)}try{return e.receiveFailure(this.currentResult)}catch(e){return Cl(e)}},e.prototype.performResultTransition=function(e){if(e.kind===ps.Write)try{this.writeResult(e.locals,e.result)}catch(e){return this.stopEvaluatingWithJavaScriptError(Cl(e))}var r=this.evaluationStack.pop();if(null!=r&&r.cleanup(),0===this.evaluationStack.length)this.results.push(e.result);else if(e.result.kind===sd.Success){(n=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===ps.Call&&(this.currentResult=e.result)}else{for(;this.evaluationStack.length>0;){var n;if((n=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===ps.Dependency)break;if(n.latestTransition===ps.Call){this.currentResult=e.result;break}var t=this.evaluationStack.pop();null!=t&&t.cleanup()}if(0===this.evaluationStack.length){var o="calc.runtime.EvaluationRuntime.evaluate: "+("internal error: empty stack while returning "+v(e.result));return S.ULS.assertTag(595980808,s.LogCategory.msoulscat_ES_EWAJS,!1,o)}}},e.prototype.writeResult=function(e,r){switch(r.kind){case sd.Success:this.setFormulaValue(e,r.value);break;case sd.Failure:this.context.globals.setCellFailure(e.range,r.reason)}this.context.globals.setDynamicPrecs(e.range,e.precedents)},e.prototype.setFormulaValue=function(e,r){var n=wl(r)?0:r;if(e.source===ud.Cell){if(Pl(n)){var t=void 0===n.opers[0]?cd:n.opers[0][0];return this.context.globals.setCellValue(e.range,t)}return this.context.globals.setCellValue(e.range,n)}var o=e.range.range,a=Vl(o.rows,o.cols,n).opers;return this.context.globals.setCellValues(e.range,a)},e.prototype.generatePartialResults=function(){for(var e=this.inputMachines.length-this.results.length,r=0;r<e;r+=1)this.results.push(ld(gl))},e.prototype.stopEvaluatingWithJavaScriptError=function(e){for(;;){var r=this.evaluationStack.pop();if(null==r)break;r.cleanup()}this.results.push(ld(e))},e}(),md=Nn.documentScope,Sd=Nn.nameLoc,Rd=Nn.sheetIndex,Id=Nn.sheetRange,Cd=Nn.gridCell,Ad=kn.documentQualifier,Nd=kn.QualifierKind,Od=kn.PosKind,yd=kn.CellRefKind,Ld=yn.ErrorType,kd=yn.nameErrorOper,Dd=yn.refErrorOper,Md=yn.OperKind,_d=yn.arrayOper,Fd=yn.range3DOper,bd=yn.rangeSeqOper,Ud=Fn.gridCellRange,wd=Fn.ResultKind,Pd=Fn.success,Bd=Fn.failure,xd=Fn.sheetGridRangeAnchor,Vd=Fn.createResolutionHandler,Gd=Fn.createNameFinder,Wd=[void 0,kd],Hd=vs;!function(e){e.Document="document",e.Sheet="sheet",e.Ident="sheet, then document"}(gd||(gd={}));var Kd=function(e){function r(r,n,t){var o=e.call(this,r)||this;return o.nameEvaluator=Vd(Gd(function(e){var r=o.getNameFormulaAsTerm(o.locals,e);return void 0!==r&&o.checkForNameCycle(e,o.visitedNameMap),r},Wd),function(e){var r="name resolution; qualifier = "+v(e);return bl("calc.runtime.FormulaEvaluationMachine.evalName",Ld.NAME,r),Wd},Rs),o.cellEvaluator=Vd(function(e){return Fd(e.sheet,e.range)},function(e){var r="error ref, qualifier = "+v(e.data.qualifier);return bl("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Ld.REF,r),Dd},Rs),o.term=os("calc.runtime.FormulaEvaluationMachine",t),o.locals=n,o.continuation=[],o.env=Hd,o.visitedNameMap=Os.newVisitedMap(),o.dispatcher=new od(o.context.globals,n),o}return at(r,e),r.prototype.next=function(){if(Qc(this.term)){var e=this.continuation;if(0===e.length){var r=this.dispatcher.dereferenceOper(this.term,Fl),n=this.dispatcher.coerceOper(r,Fl);return this.performReturnTransition(Pd(n))}var t=e[e.length-1];return this.applyContinuation(this.term,t)}return this.reduceFormula(this.term)},r.prototype.receiveSuccess=function(e){return this.updateTermTransition(e.value)},r.prototype.receiveFailure=function(e){var r=e.reason;switch(r.kind){case fl.Unevaluated:for(var n=[],t=r.anchors,o=t.length-1;o>=0;o-=1){var a=this.context.createCellEvaluationMachine(this.context,t[o]);n.push(a)}return this.performDependencyTransition(n);default:return this.performReturnTransition(e)}},r.prototype.applyContinuation=function(e,r){var n=r.context;switch(n.kind){case _c.App:var t=r.holeIndex,o=n.children.length;if((c=r.locals)[t]=e,t+1<o)return this.nextHoleTransition(r,n.children[t+1]);var a=n.data.funName,i=n.data.funType;this.dispatcher.dereferenceOpers(c,i);var u=this.dispatcher.dispatchFunction(a,i,c);return"object"==typeof u&&u.kind===gc.WorksheetFunction?this.evaluateFunctionTransition(u,r.env):this.popContextTransition(r.env,u);case _c.If:var c;if(0===(t=r.holeIndex)){var l=this.dispatcher.dereferenceOper(e,Md.Boolean);if("object"!=typeof l){var f=this.dispatcher.coerceOper(l,Md.Boolean),d=!0===f?n.children[1]:!1===f?n.children[2]:f;return this.popContextTransition(r.env,d)}switch(l.kind){case Md.Error:return this.popContextTransition(r.env,l);case Md.Missing:case Md.Blank:return this.popContextTransition(r.env,n.children[2]);case Md.Array:return r.locals=[l],this.nextHoleTransition(r,n.children[t+1]);case Md.Rich:return this.performReturnTransition(Bd(ul(["IF with a rich value condition"])));case Md.Range:var E="calc.runtime.FormulaEvaluationMachine.applyContinuation: "+("internal error: range condition "+v(l));return S.ULS.assertTag(595980811,s.LogCategory.msoulscat_ES_EWAJS,!1,E);default:return I("calc.runtime.FormulaEvaluationMachine.applyContinuation (if)",l)}}if((c=r.locals)[t]=e,1===t)return this.nextHoleTransition(r,n.children[t+1]);this.dispatcher.dereferenceOpers(c,td);var p=this.dispatcher.dispatchStrictIf(c);return this.popContextTransition(r.env,p);case _c.Name:var h=r.locals;return Os.unVisit(h,void 0,this.visitedNameMap),this.popContextTransition(r.env,e);case _c.Let:var g=n.data,T=e,m=r.env;return this.popContextTransition(hs(g,T,m),n.children[1]);case _c.Array:var R=this.dispatcher.dereferenceOper(e,Ml),C=n.data,A=C.rows,N=C.cols,O=r.holeIndex,y=O%N,L=N===y+1,k=(O-y)/N,D=r.locals;if(D[k][y]=this.dispatcher.coerceOper(R,Ml),A===k+1&&L)return this.popContextTransition(r.env,_d(A,N,D));var M=L?k+1:k,_=L?0:y+1;return this.nextHoleTransition(r,n.children[M][_]);default:return I("calc.runtime.FormulaEvaluationMachine.applyContinuation",n)}},r.prototype.reduceFormula=function(e){switch(e.kind){case _c.CellRef:return this.updateTermTransition(this.evalCellRefTerm(this.locals,e));case _c.App:var r=e.data.funName;if(!Bc(r)){var n=this.context.globals.getFirstOrderFunc(Pc(r));if(n.kind===wd.Failure)return Rs(n.reason)}if(0===e.children.length){var t=this.dispatcher.dispatchFunction(r,e.data.funType,[]);return"object"==typeof t&&t.kind===gc.WorksheetFunction?this.evaluateFunctionTransition(t,void 0):this.updateTermTransition(t)}return this.pushContextTransition(e,e.children[0],[]);case _c.If:case _c.Let:return this.pushContextTransition(e,e.children[0],void 0);case _c.Name:var o=this.evalName(this.locals,e.data.qualifier,e.data.whole,this.visitedNameMap);return void 0!==o[0]?this.pushContextTransition(e,o[1],o[0]):this.updateTermTransition(o[1]);case _c.Ident:var a=gs(e.data,this.env);if(null==a){var i="undefined local "+e.data;bl("calc.runtime.FormulaEvaluationMachine.reduceFormula",Ld.NAME,i)}return this.updateTermTransition(void 0===a?kd:a);case _c.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map(function(){return[]}));case _c.Fun:return this.performReturnTransition(Bd(ul(["Step: FunNode to closure"])));default:return I("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},r.prototype.pushContextTransition=function(e,r,n){var t=function(e,r,n){return{context:e,holeIndex:0,env:r,locals:n}}(e,this.env,n);return this.continuation[this.continuation.length]=t,this.updateTermTransition(r)},r.prototype.popContextTransition=function(e,r){return this.env=e,this.continuation.pop(),this.updateTermTransition(r)},r.prototype.evaluateFunctionTransition=function(e,r){void 0!==r&&(this.env=r,this.continuation.pop());var n=this.context.createFunctionEvaluationMachine(this.context,e);return this.performCallTransition(n)},r.prototype.nextHoleTransition=function(e,r){return e.holeIndex+=1,this.env=e.env,this.updateTermTransition(r)},r.prototype.updateTermTransition=function(e){return this.term=e,this.performDefaultTransition()},r.prototype.evalDocumentQualifier=function(e){var r=this.context.globals.getDocumentLoc(e.path,e.document);return null!=r?r:gd.Document},r.prototype.getSheetIndex=function(e,r){var n=this.context.globals.getSheetIndex(e,r);return n.kind===wd.Failure?Rs(n.reason):null==n.value?void 0:n.value},r.prototype.evalSheetQualifier=function(e,r){var n=null==r.document?e.range.sheet.document:this.evalDocumentQualifier(r.document);if("string"==typeof n)return n;var t=this.getSheetIndex(n,r.sheet);return null==t?gd.Sheet:Rd(n,t)},r.prototype.evalNameQualifier=function(e,r){var n;switch(r.kind){case Nd.Document:return"string"!=typeof(n=this.evalDocumentQualifier(r))?md(n):n;case Nd.Sheet:return this.evalSheetQualifier(e,r);case Nd.Ident:n=e.range.sheet.document;var t=this.getSheetIndex(n,r.name);return null!=t?Rd(n,t):"string"!=typeof(n=this.evalDocumentQualifier(Ad(r.name)))?md(n):gd.Ident;default:return I("calc.runtime.FormulaEvaluationMachine.evalNameQualifier",r)}},r.prototype.getNameFormulaAsTerm=function(e,r){e.precedents.names.push(r);var n=this.context.globals.getNameFormula(r);if(n.kind===wd.Failure)return Rs(n.reason);var t=n.value;return null!=t?os("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",t):void 0},r.prototype.checkNameCycle=function(e,r,n){return void 0!==Os.lookup(e,n)?Rs(Sl(Os.runFrom(e,n))):(Os.visit(e,!0,n),[e,r])},r.prototype.checkForNameCycle=function(e,r){if(void 0!==Os.lookup(e,r))return Rs(Sl(Os.runFrom(e,r)));Os.visit(e,!0,r)},r.prototype.evalName=function(e,r,n,t){if(Gr(wr.CalcUnifyRangeResolutionCode)){var o=xd(e.range),a=this.context.resolver.resolveName(o,r,n);return this.nameEvaluator(r,a)}if(null==r||r.kind===Nd.Relative){var i=e.range.sheet,u=Sd(i,n);if(null!=(s=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,s,t);if(u=Sd(md(i.document),n),null!=(s=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,s,t);var c="name resolution; qualifier = "+v(r);return bl("calc.runtime.FormulaEvaluationMachine.evalName",Ld.NAME,c),[void 0,kd]}var l=this.evalNameQualifier(e,r);if("string"!=typeof l){var s;u=Sd(l,n);if(null!=(s=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,s,t);var f=null==l.index?"document":"sheet",d="name resolution, qualifier = "+v(r)+", resolved to "+f;return bl("calc.runtime.FormulaEvaluationMachine.evalName",Ld.NAME,d),[void 0,kd]}var E="qualifier resolution, qualifier = "+v(r)+", failed on "+l;return bl("calc.runtime.FormulaEvaluationMachine.evalname",Ld.NAME,E),[void 0,kd]},r.prototype.evalPos=function(e,r){return r.kind===Od.Abs?r.index:e+r.index},r.prototype.evalCellRefSingle=function(e,r){return Cd(this.evalPos(e.row,r.row),this.evalPos(e.col,r.col))},r.prototype.evalCellRef=function(e,r){var n=e.range.range;switch(r.kind){case yd.Error:return;case yd.Single:var t=this.evalCellRefSingle(n,r);return Ud(t,t);case yd.Range:var o=this.evalCellRefSingle(n,r.ref1),a=this.evalCellRefSingle(n,r.ref2);return Ud(o,a);case yd.Row:return Rs(ul(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]));case yd.Col:return Rs(ul(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]))}},r.prototype.evalCellRefTerm=function(e,r){if(Gr(wr.CalcUnifyRangeResolutionCode)){var n=xd(this.locals.range),t=this.context.resolver.resolveCellRef(n,r.data.qualifier,r.data.ref);return this.cellEvaluator(r,t)}var o=e.range.sheet.document,a=r.data.qualifier,i=this.evalCellRef(e,r.data.ref);if(null==i){var u="error ref, qualifier = "+v(a);return bl("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Ld.REF,u),Dd}if(null!=a&&a.kind===Nd.Error){u="qualifier resolution, qualifier = "+v(a);return bl("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Ld.REF,u),Dd}if(null!=a&&a.kind===Nd.SheetRange){var c=this.getSheetIndex(o,a.sheet1);if(null==c){u="qualifier resolution, qualifier = "+v(a)+", sheet 1";return bl("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Ld.REF,u),Dd}var l=this.getSheetIndex(o,a.sheet2);if(null==l){u="qualifier resolution, qualifier = "+v(a)+", sheet 2";return bl("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Ld.REF,u),Dd}if(c===l)return bd(Rd(o,c),[i]);var s=Id(o,Math.min(c,l),Math.abs(l-c)+1);return Fd(s,i)}var f=null==a||a.kind===Nd.Relative?e.range.sheet:this.evalSheetQualifier(e,a);if("string"==typeof f){u="qualifier resolution, qualifier = "+v(a)+", failed on "+f;return bl("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Ld.REF,u),Dd}return bd(f,[i])},r}(Ns);function jd(e,r,n){return new Kd(e,r,n)}function Qd(e,r,n,t){var o=vd(e),a=jd(o.machineContext,r,n);return function e(r,n){var t=r.evaluate(n);return t instanceof Array?t[0]:Al(function(t){return e(r,"number"==typeof t?t:n)})}(new Td(o,[a]),t)}var Xd=yn.SpecialPrecs,Jd=yn.precedents;function Yd(e){var r=ys.newVisitedMap();return{evalFormula:function(n,t,o,a){var i=Cs(n,t,Jd([],[],Xd.None,!0),r);return Qd(e,i,o,a)},evalCells:function(r){return js(e,r)},evalCellsAsync:function(r){return function(e,r){if(0===r.length)return Promise.resolve([]);for(var n=vd(e),t=[],o=0;o<r.length;o+=1)t.push(Ks(n.machineContext,r[o]));var a=new Td(n,t),i=dd(e.schedulerInfo);return a.evaluateAsync(i)}(e,r)}}}var qd=kn.formulaSpan,zd=kn.RefStyle,Zd=Nn.FormulaSource,$d=Fn.getSubExpressionFromPosition,eE=Fn.isSuccess,rE=Fn.failure,nE=Fn.ResultKind,tE=qd(0,0,"","");function oE(e){var r,n,t,o,a=e.config,i=e.mathpack,u=dt(a),c=Cu(a),l=dl(a,i),s=Rc(c),f=is(l),d=Yd(e),E=Eu(u).parseFormula,p=!1,v=void 0,h=-1,g=!1;function T(){p=!1,t=void 0,h=-1,v=void 0,o=void 0,g=!1}function m(){if(!p){if(p=!0,void 0===r||void 0===n)return;var e=E(zd.A1,r,Zd.Cell,n);eE(e)&&(t=e.value)}}function S(e){if(m(),void 0!==t&&e!==h){var r=v;v=void 0,e>=0&&e<n.length&&(v=$d(t,e)),v!==r&&(o=void 0,g=!1),h=e}}function R(){if(void 0!==v&&!g&&void 0!==t){var e=r,n=s.checkFormula(e,Zd.Cell,{node:v,spans:t.spans});if(n.isWellFormed){var a=f.compileFormula(e,Zd.Cell,n);if(eE(a)){var i=d.evalFormula(e,Zd.Cell,a.value,void 0);i.kind!==nE.Paused&&(o=i)}}g=!0}}return{setCellAndFormula:function(e,t){r=e,n=t,T()},getSubExpressionSpanFromFormulaCharacterIndex:function(e){if(S(e),void 0!==t&&void 0!==v){var r=t.spans[v.label];if(void 0!==r)return r}return tE},evaluateSubExpressionFromFormulaCharacterIndex:function(e){return S(e),R(),void 0!==o?Promise.resolve(o):Promise.resolve(rE(Cl("formula Inspector Service.evaluateSubExpressionFromFormulaCharacterIndex : No valid formula to evaluate.")))},evaluateSubExpression:function(){return m(),void 0!==t&&(v=t.node,o=void 0,g=!1),R(),void 0!==o?Promise.resolve(o):Promise.resolve(rE(Cl("formula Inspector Service.evaluateSubExpression : No valid formula to evaluate.")))}}}var aE=yn.OperKind,iE=yn.valueErrorOper,uE=yn.div0ErrorOper,cE=Mn.OperatorId,lE=Fn.isSheetIndex,sE=32767;function fE(e){if("object"!=typeof e)return"number"==typeof e?e:void 0;switch(e.kind){case aE.Error:return e;case aE.Missing:case aE.Blank:return;case aE.Rich:return fE(e.getFallback());default:return I("calc.funcs.arithmeticOperationCoerce",e)}}function dE(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(cE.Concat,function(r){return e.coerceOper(r,aE.String)}),function(e){return e},n);if(null==t){var o="calc.funcs.concat: returned undefined; args = "+v(r);return S.ULS.assertTag(595969627,s.LogCategory.msoulscat_ES_EWAJS,!1,o)}return"string"==typeof t&&t.length>sE?yn.valueErrorOper:t}function EE(e){var r="object"==typeof e&&e.kind===aE.Blank;return(r=r||""===e)?1:0}function pE(e){return"object"!=typeof e||e.kind!==aE.Blank?1:0}function vE(e,r){var n=r[0];if("object"!=typeof n||n.kind!==aE.Range||!lE(n.sheets)||1!==n.ranges.length)return iE;var t=e.dereferenceAllOpers(r),o=e.makeOperatorReducer(cE.Add),a=e.reduceDerefOpers(o,pE,t);return null==a?0:a}function hE(e){return function r(n){if("boolean"==typeof n)return n;if("number"==typeof n)return e.coerceOper(n,aE.Boolean);if("string"!=typeof n)switch(n.kind){case aE.Error:return n;case aE.Missing:case aE.Blank:return;case aE.Rich:return r(n.getFallback());default:return I("funcs.aggregationFuncs: booleanOperationCoerce",n)}}}function gE(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(cE.And),hE(e),n);return null==t?iE:t}function TE(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(cE.Or),hE(e),n);return null==t?iE:t}function mE(e,r){var n=e.dereferenceAllOpers(r),t=[];var o=e.reduceDerefOpers(function(e,r){return void 0===e?r:("number"==typeof e&&t.push(e),Ul(e)?e:r)},function(e){if("number"==typeof e)return e;if("boolean"!=typeof e&&"string"!=typeof e)switch(e.kind){case aE.Error:return e;case aE.Missing:case aE.Blank:case aE.Rich:return;default:return I("funcs.makeMedianCoerce",e)}},n);if("number"==typeof o&&t.push(o),null==o)return re;if(Ul(o))return o;if(0===t.length)return re;if(1===t.length)return t[0];if((t=t.sort(function(e,r){return e-r})).length%2==0){var a=t.length/2;return(t[a-1]+t[a])/2}var i=(t.length-1)/2;return t[i]}function SE(e){return function(r,n){return e(r)(n[0])}}function RE(e){return function(r,n){return e(r)(n[0],n[1])}}var IE=yn.numErrorOper,CE=yn.div0ErrorOper,AE=180/Math.PI,NE=Math.PI/180;function OE(e,r){return Math.PI}var yE=SE(function(e){return e.getMathpack().sqrt}),LE=SE(function(e){return e.getMathpack().exp}),kE=RE(function(e){return e.getMathpack().power}),DE=SE(function(e){return e.getMathpack().ln}),ME=SE(function(e){return e.getMathpack().log10});function _E(e,r){var n=r[0],t=r.length<2?10:r[1];return e.getMathpack().log(n,t)}var FE=SE(function(e){return e.getMathpack().sin}),bE=SE(function(e){return e.getMathpack().cos}),UE=SE(function(e){return e.getMathpack().tan}),wE=SE(function(e){return e.getMathpack().asin}),PE=SE(function(e){return e.getMathpack().acos}),BE=SE(function(e){return e.getMathpack().atan}),xE=RE(function(e){return e.getMathpack().atan2});function VE(e,r){var n=r,t=n[0],o=n[1],a=Math.pow(10,Math.ceil(o));return t<0?-Math.round(-t*a)/a:Math.round(t*a)/a}function GE(e,r){var n=r,t=n[0],o=n[1],a=Math.pow(10,o<0?-Math.floor(-o):Math.floor(o));return t<0?-Math.ceil(-t*a)/a:Math.ceil(t*a)/a}function WE(e,r){var n=r,t=n[0],o=n[1],a=Math.pow(10,o<0?-Math.floor(-o):Math.floor(o));return t<0?-Math.floor(-t*a)/a:Math.floor(t*a)/a}function HE(e,r){var n=r,t=n[0],o=n[1];return 0===o?0:o<0&&t>0?IE:o*Math.ceil(t/o)}function KE(e,r){var n=r,t=n[0],o=n[1];return 0===o?0===t?0:CE:o<0&&t>0?IE:o*Math.floor(t/o)}function jE(e,r){var n=r[0];return 2*(n<0?Math.floor(n/2):Math.ceil(n/2))}function QE(e,r){var n=r[0];return Math.abs(n)}function XE(e,r){var n=r[0];return n>0?1:0===n?0:n<0?-1:IE}function JE(e,r){return r[0]*AE}function YE(e,r){return r[0]*NE}var qE=170;function zE(e,r){var n=r[0];if(!isFinite(n)||n<0)return IE;var t=Math.floor(n+2147483648-2147483648);return t>qE?IE:function e(r){return A("call just Fact with non Natural value",r),0===r?1:r*e(r-1)}(t)}function ZE(e,r){var n=r[0];if(Fn.operKind(n)===yn.OperKind.Range){var t=n.sheets,o=n.ranges[0];if(1!==t.length||1!==o.rows||1!==o.cols)return yn.valueErrorOper;n=e.dereferenceOper(n,yn.OperKind.Number)}switch(Fn.operKind(n)===yn.OperKind.String&&(n=e.coerceOper(n,yn.OperKind.Number)),Fn.operKind(n)){case yn.OperKind.Number:return 0==(1&Math.floor(Math.abs(n)));case yn.OperKind.Error:return n;case yn.OperKind.Missing:return yn.naErrorOper;case yn.OperKind.Blank:return!0;case yn.OperKind.Rich:return ZE(e,[n.getFallback()]);default:return yn.valueErrorOper}}var $E=yn.valueErrorOper;function ep(e){return[e[0],Math.floor(e.length>1?e[1]:1)]}function rp(e,r){var n=ep(r),t=n[0],o=n[1];return o<0?$E:o>=t.length?t:t.substr(t.length-o,o)}function np(e,r){var n=ep(r),t=n[0],o=n[1];return o<0?$E:o>=t.length?t:t.substr(0,o)}function tp(e,r){var n=r[0],t=r[1]-1,o=Math.floor(r[2]);return t<0||o<0?$E:n.substr(t,o)}function op(e,r){return r[0].length}function ap(e,r){if(2!==r.length)return oe;var n,t=r[0],o=r[1];if("object"==typeof(n=t)&&n.kind===Dl.Rich&&"string"==typeof o){var a=t.getField(o);if(void 0!==a)return a}return oe}function ip(e,r){return up(e,[Z].concat(r))}function up(e,r){for(var n=r[0],t={},o=1;o<r.length;o+=2){var a=r[o],i=r[o+1];t[a.toLowerCase()]=i}return new cp(t,n)}var cp=function(){return function(e,r){var n=this;void 0===e&&(e={}),void 0===r&&(r=Z),this._fields=e,this._fallback=r,this.kind=w.Rich,this.getFallback=function(){return n._fallback},this.getField=function(e){var r=e.toLowerCase(),t=n._fields[r];if(void 0!==t)return t}}}(),lp=Fn.success,sp=Fn.failure,fp={};fp[Mn.WorksheetFuncId.SUM]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(cE.Add),fE,n);return null==t?0:t},fp[Mn.WorksheetFuncId.PRODUCT]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(cE.Mul),fE,n);return null==t?0:t},fp[Mn.WorksheetFuncId.AVERAGE]=function(e,r){var n,t=e.makeOperatorReducer(cE.Add),o=e.dereferenceAllOpers(r),a=e.reduceDerefOpers(t,fE,o),i=e.reduceDerefOpers(t,(n=fE,function(e){if(null!=n(e))return 1}),o);if(null!=a&&null!=i)return e.getBinaryOperator(cE.Div)(a,i);if(null==a&&null==i)return uE;var u="calc.funcs.average: (sumOper == null) !== (countOper == null); args = "+v(r);return S.ULS.assertTag(595980871,s.LogCategory.msoulscat_ES_EWAJS,!1,u)},fp[Mn.WorksheetFuncId.CONCAT]=dE,fp[Mn.WorksheetFuncId.CONCATENATE]=dE,fp[Mn.WorksheetFuncId.COUNTBLANK]=function(e,r){var n=r[0];if("object"!=typeof n||n.kind!==aE.Range||!lE(n.sheets)||1!==n.ranges.length)return iE;var t=e.dereferenceAllOpers(r),o=e.makeOperatorReducer(cE.Add),a=e.reduceDerefOpers(o,EE,t);return null==a?0:a},fp[Mn.WorksheetFuncId.MAX]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.makeBranchOperatorReducer(cE.Gt,function(e){return!1}),o=e.reduceDerefOpers(t,fE,n);return null==o?0:o},fp[Mn.WorksheetFuncId.MIN]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.makeBranchOperatorReducer(cE.Lt,function(e){return!1}),o=e.reduceDerefOpers(t,fE,n);return null==o?0:o},fp[Mn.WorksheetFuncId.ISERROR]=function(e,r){return Fn.operKind(r[0])===yn.OperKind.Error},fp[Mn.WorksheetFuncId.ISERR]=function(e,r){var n=r[0];return Fn.operKind(n)===yn.OperKind.Error&&n.type!==yn.ErrorType.NA},fp[Mn.WorksheetFuncId.ISBLANK]=function(e,r){return Fn.operKind(r[0])===yn.OperKind.Blank},fp[Mn.WorksheetFuncId.ISLOGICAL]=function(e,r){return Fn.operKind(r[0])===yn.OperKind.Boolean},fp[Mn.WorksheetFuncId.ISNA]=function(e,r){var n=r[0];return Fn.operKind(n)===yn.OperKind.Error&&n.type===yn.ErrorType.NA},fp[Mn.WorksheetFuncId.ISNONTEXT]=function(e,r){return Fn.operKind(r[0])!==yn.OperKind.String},fp[Mn.WorksheetFuncId.ISTEXT]=function(e,r){return Fn.operKind(r[0])===yn.OperKind.String},fp[Mn.WorksheetFuncId.ISNUMBER]=function(e,r){return Fn.operKind(r[0])===yn.OperKind.Number},fp[Mn.WorksheetFuncId.ISREF]=function(e,r){return Fn.operKind(r[0])===yn.OperKind.Range},fp[Mn.WorksheetFuncId.ISEVEN]=ZE,fp[Mn.WorksheetFuncId.ISODD]=function(e,r){var n=ZE(e,r);return Fn.operKind(n)===yn.OperKind.Boolean?!n:n};var dp,Ep,pp=!1;function vp(e){return pp||(pp=!0,Gr(wr.CalcNewFunctions)&&(fp[Mn.WorksheetFuncId.AND]=gE,fp[Mn.WorksheetFuncId.OR]=TE,fp[Mn.WorksheetFuncId.COUNTA]=vE,fp[Mn.WorksheetFuncId.ABS]=QE,fp[Mn.WorksheetFuncId.CEILING]=HE,fp[Mn.WorksheetFuncId.DEGREES]=JE,fp[Mn.WorksheetFuncId.FLOOR]=KE,fp[Mn.WorksheetFuncId.RADIANS]=YE,fp[Mn.WorksheetFuncId.ROUND]=VE,fp[Mn.WorksheetFuncId.ROUNDUP]=GE,fp[Mn.WorksheetFuncId.ROUNDDOWN]=WE,fp[Mn.WorksheetFuncId.EVEN]=jE,fp[Mn.WorksheetFuncId.SIGN]=XE,fp[Mn.WorksheetFuncId.PI]=OE,fp[Mn.WorksheetFuncId.SQRT]=yE,fp[Mn.WorksheetFuncId.EXP]=LE,fp[Mn.WorksheetFuncId.POWER]=kE,fp[Mn.WorksheetFuncId.LN]=DE,fp[Mn.WorksheetFuncId.LOG10]=ME,fp[Mn.WorksheetFuncId.LOG]=_E,fp[Mn.WorksheetFuncId.SIN]=FE,fp[Mn.WorksheetFuncId.COS]=bE,fp[Mn.WorksheetFuncId.TAN]=UE,fp[Mn.WorksheetFuncId.ASIN]=wE,fp[Mn.WorksheetFuncId.ACOS]=PE,fp[Mn.WorksheetFuncId.ATAN]=BE,fp[Mn.WorksheetFuncId.ATAN2]=xE,fp[Mn.WorksheetFuncId.FACT]=zE,fp[Mn.WorksheetFuncId.LEFT]=np,fp[Mn.WorksheetFuncId.RIGHT]=rp,fp[Mn.WorksheetFuncId.MID]=tp,fp[Mn.WorksheetFuncId.LEN]=op),Gr(wr.CalcWorksheetFunctions)&&(fp[Mn.WorksheetFuncId.MEDIAN]=mE),Gr(wr.CalcFieldValueFunction)&&(fp[Mn.WorksheetFuncId.FIELDVALUE]=ap),Gr(wr.CalcRecordFunctions)&&(fp[Mn.WorksheetFuncId.RECORD]=ip,fp[Mn.WorksheetFuncId.RECORDTEST]=up)),fp[e]}function hp(e){return function(r){if("number"==typeof r){var n=vp(r);return null!=n?lp(n):sp(ul([e.getWorksheetFuncName(r)]))}return lp(void 0)}}(Ep=dp||(dp={})).DerefOperKind=Tc,Ep.FuncKind=gc;var gp={},Tp=0;function mp(e){var r=gp[e];gp[e]=(void 0===r?0:r)+1,(Tp+=1)%100==0&&(S.ULS.traceTag(595858520,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"hashUtils.logCollision: "+JSON.stringify(gp)+"."),gp={})}function Sp(e){if(null==e)return"";var r,n=Or(e.sheet.document);n===y?r="illegalDocument":r=(null==n.path?"":"p:"+n.path.toLocaleUpperCase()+",")+"n:"+n.name.toLocaleUpperCase();return r+",i:"+e.sheet.index+",r:"+e.range.row+",c:"+e.range.col}function Rp(e){var r=1;return r=31*(r=31*(r=31*(r=31*r+e.sheet.index)+e.range.col)+e.range.row)+e.sheet.document.name.length,void 0!==e.sheet.document.path&&(r=31*r+e.sheet.document.path.length),r}function Ip(e,r){var n,t,o=e.sheet.document,a=r.sheet.document;return o.name.toLocaleUpperCase()===a.name.toLocaleUpperCase()&&(n=o.path,t=a.path,null==n?null==t:null==t?null==n:n.toLocaleUpperCase()===t.toLocaleUpperCase())&&e.sheet.index===r.sheet.index&&e.range.col===r.range.col&&e.range.row===r.range.row}function Cp(){return{map:{},keyToHash:Rp,keyEquals:Ip,nelements:0,add:function(e){var r=this.keyToHash(e);if(Xr(this.map[r]))this.map[r]=[e],this.nelements+=1;else{for(var n=this.map[r],t=0;t<n.length;t+=1)if(this.keyEquals(e,n[t]))return;mp("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),n.push(e),this.nelements+=1}},contains:function(e){var r=this.keyToHash(e),n=this.map[r];if(Xr(n))return!1;for(var t=0;t<n.length;t+=1)if(this.keyEquals(e,n[t]))return!0;return mp("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),!1},forEach:function(e){var r=this;Object.keys(this.map).forEach(function(n){r.map[+n].forEach(function(r){e(r)})})},size:function(){return this.nelements},remove:function(e){var r=this,n=this.keyToHash(e),t=this.map[n];if(Xr(t))return!1;var o=[],a=!1;return t.forEach(function(n){r.keyEquals(e,n)?(r.nelements-=1,a=!0):o.push(n)}),this.map[n]=o,a||mp("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),a}}}var Ap=Fn.createResolutionHandler,Np=Fn.createNameFinder,Op={};function yp(e){Gr(wr.CalcLogStopWatch)&&(Op[e]=Br(e))}function Lp(e){if(Gr(wr.CalcLogStopWatch)){var r=Op[e];void 0!==r&&r.stop()}}function kp(e,r){return void 0===e&&void 0===r||void 0!==e&&void 0!==r&&Dp(e.name,r.name)&&Dp(e.path,r.path)}function Dp(e,r){return null==e&&null==r||null!=e&&null!=r&&e.toLocaleUpperCase()===r.toLocaleUpperCase()}function Mp(e,r,n,t){var o=function(e,r){if(void 0===e){var n=r.getCurrentDocumentLoc(),t=r.getCurrentSheetIndex();if(null==n||null==t)return;return M(n,t)}switch(e.kind){case le.Error:return;case le.Relative:var n=r.getCurrentDocumentLoc(),t=r.getCurrentSheetIndex();if(null==n||null==t)return;return M(n,t);case le.Sheet:var o=void 0!==e.document?L(e.document.path,e.document.document):r.getCurrentDocumentLoc();if(null==o)return;var a=r.getSheetIndex(o,e.sheet);if(null==a)return;return M(o,a);case le.SheetRange:if(null==(o=r.getCurrentDocumentLoc()))return;var i=r.getSheetIndex(o,e.sheet1),u=r.getSheetIndex(o,e.sheet2);if(null==i||null==u)return;return i===u?M(o,i):D(o,Math.min(i,u),Math.abs(i-u)+1);default:return I("calc.calc.qualifierToSheet",e)}}(e.qualifier,n);if(void 0!==o)if(kp(r.sheet.document,o.document)||(t.crossDocRefs+=1),ur(o))switch(o.index!==r.sheet.index&&(t.crossSheetRefs+=1),e.ref.kind){case se.Error:return void(t.errRefs+=1);case se.Col:return void(t.columnRefs+=1);case se.Row:return void(t.rowRefs+=1);case se.Range:var a=Er(_p(e.ref.ref1,r),_p(e.ref.ref2,r));return n.maxRangeSize>0&&Kl(a)>n.maxRangeSize?void(t.largeRanges+=1):H(o,a);case se.Single:var i=_p(e.ref,r);return K(o,i);default:return I("calc.calc.cellRefToGridLoc",e.ref)}else t.crossSheetRefs+=1;else t.errRefs+=1}function _p(e,r){return b(Fp(e.row,r.range.row),Fp(e.col,r.range.col))}function Fp(e,r){switch(e.kind){case fe.Abs:return e.index;case fe.Rel:return e.index+r}}function bp(e,r){var n=void 0;if(void 0===e.qualifier){var t=r.getCurrentDocumentLoc(),o=r.getCurrentSheetIndex();if(null==t||null==o)return;n=M(t,o)}else switch(e.qualifier.kind){case le.Document:n=j(L(e.qualifier.path,e.qualifier.document));break;case le.Relative:t=r.getCurrentDocumentLoc(),o=r.getCurrentSheetIndex();if(null==t||null==o)return;n=M(t,o);break;case le.Ident:var a=r.getCurrentDocumentLoc();if(null==a)return;var i=r.getSheetIndex(a,e.qualifier.name);n=null==i?j(L(void 0,e.qualifier.name)):M(a,i);break;case le.Sheet:if(null==(a=void 0!==e.qualifier.document?L(e.qualifier.document.path,e.qualifier.document.document):r.getCurrentDocumentLoc()))return;if(null==(i=r.getSheetIndex(a,e.qualifier.sheet)))return;n=M(a,i);break;default:return I("calc.calc.nameNodeToNameLoc",e.qualifier)}return Q(n,e.whole)}function Up(e,r){switch(r.ref.kind){case se.Error:e.errRefs+=1;break;case se.Col:e.columnRefs+=1;break;case se.Row:e.rowRefs+=1}}function wp(e,r){var n=r[e];return void 0===n&&(n=0),n}function Pp(){var e={columnRefs:0,crossDocRefs:0,crossSheetRefs:0,dependents:[],errRefs:0,functionsCount:Kr(),largeRanges:0,nameRefs:0,operatorsCount:{},parserErrors:0,rowRefs:0,tableRefs:0,merge:function(r){e.columnRefs+=r.columnRefs,e.crossDocRefs+=r.crossDocRefs,e.crossSheetRefs+=r.crossSheetRefs,e.largeRanges+=r.largeRanges,e.nameRefs+=r.nameRefs,e.parserErrors+=r.parserErrors,e.rowRefs+=r.rowRefs,e.tableRefs+=r.tableRefs,e.errRefs+=r.errRefs,function(e,r){if(yp("calc_ts_merge_sets"),Gr(wr.CalcHashSet)){var n=Cp();e.forEach(function(e){n.add(e)}),r.forEach(function(r){n.contains(r)||e.push(r)})}else{var t=Kr();e.forEach(function(e){t[Sp(e)]=!0}),r.forEach(function(r){var n=Sp(r);t[n]||(e.push(r),t[n]=!0)})}Lp("calc_ts_merge_sets")}(e.dependents,r.dependents),Object.keys(r.functionsCount).forEach(function(n){var t=e.functionsCount[n];void 0===t&&(t=0),e.functionsCount[n]=t+r.functionsCount[n]}),Object.keys(r.operatorsCount).forEach(function(n){var t=Number(n),o=e.operatorsCount[t];void 0===o&&(o=0),e.operatorsCount[t]=o+r.operatorsCount[t]})}};return e}function Bp(e){var r={_logger:e,_dependencyGraph:Kr(),haveDependents:function(e){return void 0!==r._dependencyGraph[Sp(e)]},directDependents:function(e){var n=[],t=r._dependencyGraph[Sp(e)];return void 0!==t&&t.forEach(function(e){n.push(e)}),n},allDependents:function(e){return r.getDependents(e,!1)},rootDependents:function(e){return r.getDependents(e,!0)},reset:function(){r._dependencyGraph=Kr()},add:function(e,n,t){var o=it({},e);o.getCurrentDocumentLoc=function(){return Or(e.getCurrentDocumentLoc())};var a=Pp();if(null==t)return a;var i=void 0,u=void 0;Gr(wr.CalcUnifyRangeResolutionCode)&&(i=function(e,r,n,t){return Ap(Np(function(o){var a=r.nameRefToSheetGridRange(e,o);return null==a?a:(n.addDependency(a,e,r.maxRangeSize,t),a)},void 0),Hr,function(){})}(n,o,r,a),u=function(e,r,n,t){return Ap(function(o){ur(o.sheet)||(t.crossSheetRefs+=1),kp(e.sheet.document,o.sheet.document)||(t.crossDocRefs+=1),o.sheet.index!==e.sheet.index&&(t.crossSheetRefs+=1),lr(o)&&n.addDependency(o,e,r.maxRangeSize,t)},function(e){return Up(t,e)},function(e,r){e.kind===Qe.NotImplemented?Up(t,r):t.errRefs+=1})}(n,o,r,a));var c,l,f,d=[];for(d.push(t.node);d.length>0;){var E=d.pop();if(null!=E)switch(E.kind){case de.Literal:break;case de.Array:E.nodes.map(function(e){return e.map(function(e){d.push(e)})});break;case de.App:if("object"==typeof E.head){var p=E.head;switch(p.kind){case de.Operator:a.operatorsCount[p.id]=(c=p.id,l=a.operatorsCount,f=void 0,void 0===(f=l[c])&&(f=0),f+1);break;case de.Name:a.functionsCount[p.whole]=wp(p.whole,a.functionsCount)+1;break;default:d.push(p)}}E.args.map(function(e){d.push(e)});break;case de.Paren:d.push(E.node);break;case de.Name:if(a.nameRefs+=1,Gr(wr.CalcUnifyRangeResolutionCode)&&void 0!==i)i(void 0,o.resolver.resolveName(n,E.qualifier,E.whole));else if(void 0===i){var v=bp(E,o);if(void 0!==v)null!=(h=o.nameRefToSheetGridRange(n,v))&&r.addDependency(h,n,o.maxRangeSize,a)}else S.ULS.traceTag(595952269,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Error,"Unreachable code hit: nameMapper should never be defined when Resolution BRS is off");break;case de.CellRef:if(Gr(wr.CalcUnifyRangeResolutionCode)&&void 0!==u)u(E,o.resolver.resolveCellRef(n,E.qualifier,E.ref));else if(void 0===u){var h;void 0!==(h=Mp(E,n,o,a))&&r.addDependency(h,n,o.maxRangeSize,a)}else S.ULS.traceTag(595952270,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Error,"Unreachable code hit: cellMapper should never be defined when Resolution BRS is off");break;case de.Bad:a.parserErrors+=1;break;default:return I("calc.calc.recalcMapperImpl",E)}}return a},merge:function(e){r.mergeGraph(e.dependencyGraph())},dependencyGraph:function(){var e=Bp(r._logger);return e.mergeGraph(r._dependencyGraph),e._dependencyGraph},mergeGraph:function(e){yp("calc_ts_merge_graph");var n=function(n){var t=r._dependencyGraph[n],o=e[n];void 0===t&&(t=[]);var a=t;if(Gr(wr.CalcHashSet)){var i=Cp();a.forEach(function(e){i.add(e)}),o.forEach(function(e){i.contains(e)||a.push(e)})}else{var u=Kr();a.forEach(function(e){u[Sp(e)]=!0}),o.forEach(function(e){u[Sp(e)]||a.push(e)})}r._dependencyGraph[n]=a};for(var t in e)n(t);Lp("calc_ts_merge_graph")},addDependency:function(e,n,t,o){if(sr(e)){var a=Sp(e);r.updateDependency(a,n)&&o.dependents.push(e)}else if(Kl(e.range)>t)o.largeRanges+=1;else for(var i=e.range.row;i<e.range.row+e.range.rows;i+=1)for(var u=e.range.col;u<e.range.col+e.range.cols;u+=1){var c=K(e.sheet,b(i,u));r.addDependency(c,n,t,o)}},updateDependency:function(e,n){var t=r._dependencyGraph[e];return void 0===t&&(t=[]),!t.some(function(e){return t=n,o=(r=e).sheet,a=t.sheet,o.document===a.document&&o.index===a.index&&function(e,r){return e.row===r.row&&e.col===r.col}(r.range,t.range);var r,t,o,a})&&(t.push(n),r._dependencyGraph[e]=t,!0)},getDependents:function(e,n){if(yp("calc_ts_get_dependents"),Gr(wr.CalcHashSet)){for(var t=Cp(),o=[],a=r.directDependents(e);a.length>0;){if(void 0!==(l=a.shift()))if(!t.contains(l))t.add(l),(s=r.directDependents(l)).length>0&&s.forEach(function(e){a.push(e)}),n&&0!==s.length||o.push(l)}return o}for(var i=Kr(),u=[],c=r.directDependents(e);c.length>0;){var l;if(void 0!==(l=c.shift())){var s,f=Sp(l);if(!i[f])i[f]=!0,(s=r.directDependents(l)).length>0&&(c=c.concat(s)),n&&0!==s.length||u.push(l)}}return Lp("calc_ts_get_dependents"),u},stats:function(){var e=Object.keys(r._dependencyGraph);if(void 0===e||0===e.length)return xp(0,0);var n=e.length,t=0;return e.forEach(function(e){var n=r._dependencyGraph[e];t+=n.length}),xp(n,t)}};return r}function xp(e,r){return{nodes:e,arcs:r}}var Vp=Fn.createResolver,Gp=Fn.success;function Wp(e){return R(e),Bp(e)}function Hp(e,r,n,t,o,a,i,u,c,l){return{maxRangeSize:e,nameRefs:r,rowRefs:n,columnRefs:t,crossSheetRefs:o,crossDocRefs:a,getCurrentDocumentLoc:i,getCurrentSheetIndex:u,getSheetIndex:c,nameRefToSheetGridRange:l,resolver:Vp({getSheetIndex:function(e,r){return Gp(c(e,r))},getDocumentLoc:i})}}var Kp=Nn.FormulaSource,jp=Nn.sheetGridCell,Qp=Nn.gridCell,Xp=Nn.documentLoc,Jp=Nn.sheetIndex,Yp=kn.RefStyle,qp=Fn.ResultKind,zp=Fn.failure;function Zp(e,r,n,t){return{getNumberFormatCategory:e,getCellFormat:r,knownFormats:n,formatValueTypes:t}}function $p(e,r,n){return{config:e,mathpack:r,formatInfo:n}}function ev(e){var r,n,t,o,a,i,u,c,l,f={globals:e,runtime:(n=(r=e).config,t=r.mathpack,o={config:n},a=it({config:n},r.formatInfo),i={config:n,mathpack:t},u=Eu(o),c=Rc(a),l=is(i),{parser:u,analyzer:c,compiler:l}),cache:Kr(),lazyCreateCacheItem:function(e){var r,n=Sp(e),t=f.cache[n];return void 0===t&&(t={cell:e,rawValue:r,formula:void 0,compiledFormula:void 0,evalResult:void 0,format:void 0},f.cache[n]=t),t},size:function(){var e=0;for(var r in f.cache)e+=1;return e},clear:function(){f.cache=Kr()},cells:function(){var e=Object.keys(f.cache);return void 0===e||0===e.length?[]:e.map(function(e){return f.cache[e].cell})},getItem:function(e){var r=Sp(e);return f.cache[r]},getValue:function(e){var r=f.getItem(e);if(void 0!==r&&null!==r.rawValue)return r.rawValue},getFormula:function(e,r,n){var t=f.getItem(e);if(void 0!==t&&rv(f.runtime,t,r,n)&&nv(t.formula))return t.formula},getFormulaFormat:function(e){var r=f.getItem(e);if(void 0!==r)return r.format},getCompiledFormula:function(e,r){var n=f.getItem(e);if(void 0!==n&&function(e,r,n){if(nv(r.compiledFormula))return!0;if(!rv(e,r,n))return!1;if(void 0!==n&&n)return!1;r.compiledFormula=null;try{var t=e.compiler.compileFormula(r.cell,Kp.Cell,r.formula);return t.kind===qp.Success&&(r.compiledFormula=t.value,!0)}catch(e){return S.ULS.traceTag(595968586,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Exception in formulaCache.lazyCompileFormula: "+v(e)),!1}}(f.runtime,n,r)&&nv(n.compiledFormula))return n.compiledFormula},getEvalResult:function(e){var r=f.getItem(e);if(void 0!==r)return r.evalResult},isEqualValue:function(e,r){var n=f.getItem(e);return void 0!==n&&n.rawValue===r},updateCellValue:function(e,r,n,t,o){if(!f.isEqualValue(e,r)){var a=f.lazyCreateCacheItem(e);if(a.rawValue=r,a.formula=void 0,a.compiledFormula=void 0,a.evalResult=void 0,a.format=void 0,null!=n){var i=n.getValue(e);void 0!==i&&r===i&&(a.formula=n.getFormula(e,!0),a.compiledFormula=n.getCompiledFormula(e,!0),a.evalResult=void 0,a.format=a.format)}null!=o&&(a.format=o),null!=t&&t.forEach(function(e){var r=f.getItem(e);void 0!==r&&(r.evalResult=void 0)})}},updateEvalResult:function(e,r,n){var t=f.lazyCreateCacheItem(e);t.evalResult=r,null!=n&&(t.format=n)},merge:function(e,r){e.cells().forEach(function(n){var t=e.getValue(n);void 0===t||!0!==r&&void 0!==f.getItem(n)||f.updateCellValue(n,t,e)})},parseCompileNameFormula:function(e,r,n){var t,o=void 0===n?Yp.A1:n,a=Kp.NameManager;if(void 0!==r)t=f.runtime.parser.parseFormula(o,r,a,e);else{var i=Jp(Xp(void 0,"Doc"),0),u=Qp(0,0);t=f.runtime.parser.parseFormula(o,jp(i,u),a,e)}var c=v(e);if(t.kind!==qp.Success){var l="calc.formulaCache.parseCompileNameFormula: couldn't parse "+c;return S.ULS.traceTag(595969230,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,l),zp(pt(l))}var d=f.runtime.analyzer.checkFormula(r,Kp.NameManager,t.value);if(d.isWellFormed)return f.runtime.compiler.compileFormula(r,a,d);var E="calc.formulaCache.parseCompileNameFormula: formula "+c+" is not well-formed.";return S.ULS.traceTag(595969231,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,E),zp(El(E))}};return f}function rv(e,r,n,t){if(nv(r.formula))return!0;if(!nv(r.rawValue))return!1;if(void 0!==r.formula&&null===r.formula)return!1;if(void 0!==n&&n)return!1;r.formula=null;var o=r.rawValue;try{var a=e.parser.parseFormula(kn.RefStyle.A1,r.cell,Kp.Cell,o);if(a.kind!==qp.Success)return!1;var i=e.analyzer.checkFormula(r.cell,Kp.Cell,a.value,t);if(!i.isWellFormed)return!1;if(r.formula=i,Gr(wr.CalcFormatCalculations)){var u=e.analyzer.findBestFormat(r.cell,Kp.Cell,i);r.format=void 0===u?void 0:u.iformat}return!0}catch(e){return S.ULS.traceTag(595968585,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Exception in formulaCache.lazyParseFormula: "+v(e)),!1}}function nv(e){return null!=e}var tv,ov,av,iv,uv=6e4,cv=3e4;function lv(e,r){var n,t=[new Promise(function(e,r){return n=[e,r]}),n],o=t[0],a=t[1],i=a[0],u=a[1],c=setTimeout(r,Math.max(0,e));return[o,[function(e){clearTimeout(c),i(e)},function(e){clearTimeout(c),u(e)}]]}function sv(e,r,n){var t=lv(e,function(){return l(r())}),o=t[0],a=t[1],i=a[0],u=a[1],c=!1;function l(e){u(e),c=!0}var s=Promise.resolve().then(function(e){return n(l,function(){return c})});return function(e,r){return e.then(function(e){return r(),e},function(e){return r(),Promise.reject(e)})}(Promise.race([o,s]),i)}function fv(e,r){var n;return new Promise(function(t,o){Promise.resolve(r).then(function r(a){if(void 0!==a){n=a;try{Promise.resolve(e(n)).then(r,o)}catch(e){o(e)}}else t(n)},o)})}function dv(e,r){return{setMessageListeners:function(r){e.onmessage=function(e){return r.onMessage(e.data)},e.onmessageerror=function(e){return r.onMessageError(e.data)}},postMessage:function(r){return e.postMessage(r)},close:function(){return r.call(e)}}}function Ev(e){return null!=e&&(e instanceof Error||"string"==typeof e.name&&"string"==typeof e.message&&(void 0===e.stack||"string"==typeof e.stack))}!function(e){e.FunctionCall="FunctionCall",e.MessageChannel="MessageChannel",e.Dedicated="Dedicated"}(tv||(tv={})),function(e){e.PostCallError="PostCallError",e.PostNotifyError="PostNotifyError",e.PostResultError="PostResultError",e.UnhandledNotifyError="UnhandledNotifyError",e.UnhandledError="UnhandledError"}(ov||(ov={})),function(e){e.App="App",e.Result="Result",e.Close="Close"}(av||(av={})),function(e){e[e.Fulfilled=0]="Fulfilled",e[e.Rejected=1]="Rejected"}(iv||(iv={}));var pv,vv={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function hv(e){return[e.name,e.message,e.stack]}function gv(e){var r,n=e[0],t=e[1],o=e[2],a=vv[n];return null!=a?r=new a(t):(r=new Error(t)).name=n,void 0!==o&&(r.stack=o),r}function Tv(e){return Ev(e)?[pv.Error,hv(e)]:[pv.Unknown,e]}function mv(e,r,n,t){var o=new Error(e);return o.stack=e+"\n    at "+r+":"+n+":"+t,o}!function(e){e[e.Unknown=0]="Unknown",e[e.Error=1]="Error"}(pv||(pv={}));var Sv="__START_ERROR__",Rv="__END_ERROR__";function Iv(e){var r=e.message.indexOf(Sv),n=e.message.indexOf(Rv);return r>=0&&n>=0?gv(JSON.parse(e.message.substring(r+Sv.length,n))):null!=e.error?e.error:mv(e.message,e.filename,e.lineno,e.colno)}function Cv(e,r,n,t,o,a){var i={port:r,callbacks:{},lastAppId:-1,modules:{}};function u(){if(null==i)throw new Error("endpoint is closed");return i}function c(e,r,n){if(null!=i){var t=i.callbacks[e];null!=t&&(delete i.callbacks[e],t[r](n))}}function l(e,r,n,t,o){var a;try{a=u()}catch(e){return Promise.reject(e)}var i=a.lastAppId+1,c=[av.App,i,e,r,n,o],l=lv(t,function(){s(c,new Error("exceeded timeout; callTimeout = "+t+"ms"))}),f=l[0],d=l[1];a.callbacks[i]=d,a.lastAppId=i;try{a.port.postMessage(c)}catch(e){s(c,e)}return f}function s(e,r){var n=e[1],t=e[5];null!=i&&(n>=0&&c(n,iv.Rejected,r),t?h(n>=0?ov.PostCallError:ov.PostNotifyError,r,!0):(n<0&&h(ov.PostNotifyError,r,!1),l("","",[],Math.max(g.callTimeout,g.initTimeout),!0).catch(function(e){})))}function f(e){var r=e[1],n=e[2],t=e[3],o=e[4],a=e[5];if(null!=i)if(""!==n||""!==t){var u=Promise.resolve().then(function(e){if(null!=i){var r=n,a=t,u=i.modules[r],c=null!=u?u[a]:void 0;if(null==c)throw new Error("method "+r+"."+a+" has not been exported");return c.apply(u,o)}});r>=0?u.then(function(e){return d(r,iv.Fulfilled,e,a)},function(e){return d(r,iv.Rejected,e,a)}):u.catch(function(e){h(ov.UnhandledNotifyError,function(e,r,n){var t=r+"."+n+".notify: ";if(Ev(e))return e.message=t+e.message,null!=e.stack&&(e.stack=t+e.stack),e;var o=new Error(t+e);return o.stack=void 0,o}(e,n,t),!1)})}else d(r,iv.Fulfilled,void 0,a)}function d(e,r,n,t){if(null!=i){var o=[av.Result,e,r,Tv(n),t];try{i.port.postMessage(o)}catch(e){E(o,e)}}}function E(e,r){var n=e[1],t=e[4];null!=i&&(t?h(ov.PostResultError,r,!0):d(n,iv.Rejected,Tv(r),!0))}function p(e){var r=e[1],n=e[2],t=e[3];null!=i&&c(r,n,function(e){return e[0]===pv.Unknown?e[1]:gv(e[1])}(t))}function v(e){if(void 0===e&&(e=!0),null!=i){var r=i.port,n=i.callbacks;if(i=void 0,e)try{r.postMessage([av.Close])}catch(e){}var t=new Error((e?"this":"other")+" endpoint closed while waiting for a response");for(var o in n)c(Number(o),iv.Rejected,t);try{r.close()}catch(e){}if(null!=a)try{a(g)}catch(t){var u=null!=t.stack?t.stack:t.message;console.log("calc.worker.createPortEndpoint.close: unhandled error: "+u)}}}function h(e,r,n){if(null!=i){var t=void 0;try{o(g,{kind:e,closing:n,error:r})||(t=[r])}catch(r){t=[r]}if(n&&v(),null!=t){var a=t[0],u=null!=a.stack?a.stack:a.message;console.log("calc.worker.createPortEndpoint.dispatchError: unhandled error: "+u)}}}var g={workerKind:e,initTimeout:n,callTimeout:t,setExports:function(e,r){return u().modules[e]=r},getImports:function(e,r){var n={};return r.forEach(function(r){return n[r]=function(e,r){var n={callTimeout:void 0,isCritical:!1,call:function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var a=null!=n.callTimeout?n.callTimeout:g.callTimeout;return l(e,r,t,a,n.isCritical)},notify:function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];!function(e,r,n,t){var o=u(),a=[av.App,-1,e,r,n,t];try{o.port.postMessage(a)}catch(e){s(a,e)}}(e,r,t,n.isCritical)}};return n}(e,r)}),n},close:v,dispatchError:h};return i.port.setMessageListeners({onMessage:function(e){switch(e[0]){case av.App:return f(e);case av.Result:return p(e);case av.Close:return v(!1);default:return I("calc.worker.createPortEndpoint.onMessage",e)}},onMessageError:function(e){var r=new Error("failed to send "+e[0]+" message");switch(e[0]){case av.App:return s(e,r);case av.Result:return E(e,r);case av.Close:return;default:return I("calc.worker.createPortEndpoint.onMessageError",e)}}}),g}function Av(e,r,n){var t=this,o=null!=r.initTimeout?r.initTimeout:uv,a=null!=r.callTimeout?r.callTimeout:cv;return sv(o,function(){return new Error("exceeded timeout; initTimeout = "+o+"ms")},function(i,u){return ut(t,void 0,void 0,function(){function t(e){return function(r,n){return l?null!=e.onError&&(e.onError(r,n),!0):(i(n.error),!0)}}function c(e){return function(r){l&&null!=e.onClosed&&e.onClosed(r)}}var l,s,f;return ct(this,function(i){switch(i.label){case 0:return l=!1,s=Cv(e,n.outside,o,a,t(r.outside),c(r.outside)),f=Cv(e,n.inside,o,a,t(r.inside),c(r.inside)),u()||null==r.inside.onInit?[3,2]:[4,r.inside.onInit(f)];case 1:i.sent(),i.label=2;case 2:return u()||null==r.outside.onInit?[3,4]:[4,r.outside.onInit(s)];case 3:i.sent(),i.label=4;case 4:return l=!0,[2,s]}})})})}function Nv(){return"undefined"!=typeof MessageChannel}var Ov=function(){function e(){this.other=void 0}return e.prototype.onMessage=function(e){return C("calc.worker.FunctionCallPort.onMessage: "+("expected onMessage to be set before receiving messages; received "+JSON.stringify(e)))},e.prototype.open=function(e){this.other=e,e.other=this},e.prototype.setMessageListeners=function(e){null!=this.other&&(this.onMessage=e.onMessage)},e.prototype.postMessage=function(e){null!=this.other&&this.other.onMessage(e)},e.prototype.close=function(){if(null!=this.other){var e=this.other;this.other=e.other=void 0,this.onMessage=e.onMessage=function(){}}},e}();var yv,Lv,kv=100;function Dv(){if(null==Un.getCalcAbsUrl()){return S.ULS.traceTag(595907587,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.worker.isDedicatedWorkerSupported: initCalc was not passed calcAbsUrl"),!1}return"undefined"!=typeof Worker}function Mv(e){setTimeout(function(){try{e.terminate()}catch(e){}},kv)}function _v(){var e={};for(var r in wr){var n=wr[r];null!=n&&(e[r]=Gr(n))}return e}function Fv(e,r){return ut(this,void 0,void 0,function(){var n;return ct(this,function(t){switch(t.label){case 0:n=Br(e),t.label=1;case 1:return t.trys.push([1,,3,4]),[4,r()];case 2:return[2,t.sent()];case 3:return n.stop(),[7];case 4:return[2]}})})}n(8);var bv=((yv={})[tv.FunctionCall]=function(){return!0},yv[tv.MessageChannel]=Nv,yv[tv.Dedicated]=Dv,yv);function Uv(e){return bv[e]()}var wv=((Lv={})[tv.FunctionCall]=function(e){return Av(tv.FunctionCall,e,(r=new Ov,n=new Ov,r.open(n),{outside:r,inside:n}));var r,n},Lv[tv.MessageChannel]=function(e){if(!Nv())return C("calc.worker.createMessageChannelWorker: expected an execution context where message channel workers are supported");var r=function(){var e=new MessageChannel;return{outside:dv(e.port1,e.port1.close),inside:dv(e.port2,e.port2.close)}}();try{return Av(tv.MessageChannel,e,r)}catch(e){try{r.outside.close()}catch(e){}throw e}},Lv[tv.Dedicated]=function(e){var r=this,n=e.outside,t=e.inside,o=e.initTimeout,a=e.callTimeout,i=t.scriptName;if(null==i)return C("calc.worker.createDedicatedWorker: expected workerDef.inside.scriptName to be defined");var u=Un.getCalcAbsUrl();if(!Dv()||null==u)return C("calc.worker.createDedicatedWorker: expected a context where dedicated workers are supported");var c=null!=o?o:uv,l=null!=a?a:cv;return sv(c,function(){return new Error("exceeded timeout; initTimeout = "+c+"ms")},function(e,t){return Fv("calc.worker.createDedicatedWorker (total)",function(){return ut(r,void 0,void 0,function(){function r(r,t){return a?null!=n.onError&&(n.onError(r,t),!0):(e(t.error),!0)}function o(e){a&&null!=n.onClosed&&n.onClosed(e)}var a,f,d,E,p,v,h,g,T;return ct(this,function(e){switch(e.label){case 0:a=!1,R=i+(/\.min\.js$/.test(m=u)?".min.js":".js"),I=m.lastIndexOf("/"),f=m.substring(0,I+1)+R,d="calc.worker.createDedicatedWorker: workerUrl = "+f,S.ULS.traceTag(595907588,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,d),e.label=1;case 1:e.trys.push([1,6,,7]),v=void 0;try{h=new Blob(['importScripts("'+encodeURI(f)+'");'],{type:"application/javascript"}),v=URL.createObjectURL(h)}catch(e){S.ULS.traceTag(595881991,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Warning,"calc.worker.createDedicatedWorker: failed to create url blob from "+f+". Attempting with string url instead..."),v=f}try{E=new Worker(v)}finally{0===v.lastIndexOf("blob",0)&&URL.revokeObjectURL(v)}return g=dv(E,function(){return Mv(E)}),p=Cv(tv.Dedicated,g,c,l,r,o),E.onerror=function(e){var r;e.preventDefault(),r=null==e.message?new Error("worker.onerror received non-ErrorEvent (worker script fetch probably failed); workerUrl = "+f):Iv(e),p.dispatchError(ov.UnhandledError,r,!a)},function(e,r){var n={shipAssertTag:function(e,n,t,o){try{r.ULS.shipAssertTag(e,n,t,o)}catch(e){}},assertTag:function(e,n,t,o){try{r.ULS.assertTag(e,n,t,o)}catch(e){}},traceTag:function(e,n,t,o){try{r.ULS.traceTag(e,n,t,o)}catch(e){}},debugTraceTag:function(e,n,t,o){try{r.ULS.debugTraceTag(e,n,t,o)}catch(e){}}};e.setExports("",n)}(p,S),t()?[3,3]:[4,Fv("calc.worker.createDedicatedWorker (inside)",function(){var e=p.getImports("",["init"]).init;return e.callTimeout=c,e.isCritical=!0,e.call({initTimeout:c,callTimeout:l,calcAbsUrl:u,features:_v()})})];case 2:e.sent(),e.label=3;case 3:return t()||null==n.onInit?[3,5]:[4,n.onInit(p)];case 4:e.sent(),e.label=5;case 5:return a=!0,[2,p];case 6:throw T=e.sent(),null!=p?p.close():null!=E&&Mv(E),T;case 7:return[2]}var m,R,I})})})})},Lv);function Pv(e,r){return wv[e](r)}function Bv(e,r){return ut(this,void 0,void 0,function(){var n,t,o,a,i;return ct(this,function(u){switch(u.label){case 0:n=0,u.label=1;case 1:if(!(n<e.length))return[3,6];if(!Uv(t=e[n]))return[3,5];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,Pv(t,r)];case 3:return[2,u.sent()];case 4:return o=u.sent(),a=null!=o.stack?o.stack:o.message,i="calc.worker.tryCreateWorker: starting "+t+" worker threw "+a,S.ULS.traceTag(595907598,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Error,i),[3,5];case 5:return n+=1,[3,1];case 6:return[2,void 0]}})})}function xv(){setTimeout(function(){try{self.close()}catch(e){}},kv)}function Vv(e,r,n,t){var o=r.initTimeout,a=r.callTimeout,i=r.calcAbsUrl,u=r.features;return ut(this,void 0,void 0,function(){var r,c,l,s,f=this;return ct(this,function(d){switch(d.label){case 0:return function(){if("undefined"==typeof self||null!=self.document)throw new Error("not in a worker execution context")}(),[4,sv(o,function(){return new Error("exceeded timeout; initTimeout = "+o+"ms")},function(e,r){return ut(f,void 0,void 0,function(){function c(r,n){return s?null!=t.onError&&(t.onError(r,n),!0):(e(n.error),!0)}function l(e){s&&null!=t.onClosed&&t.onClosed(e)}var s,f,d,E,p,v;return ct(this,function(e){switch(e.label){case 0:s=!1,e.label=1;case 1:return e.trys.push([1,4,,5]),d=dv(self,xv),f=Cv(tv.Dedicated,d,o,a,c,l),E=function(e){var r=e.getImports("",["shipAssertTag","assertTag","traceTag","debugTraceTag"]);return{shipAssertTag:function(e,n,t,o){if(r.shipAssertTag.notify(e,n,t,o),!t)throw new Error("shipAssertTag: "+o)},assertTag:function(e,n,t,o){if(r.assertTag.notify(e,n,t,o),!t)throw new Error("assertTag: "+o)},traceTag:function(e,n,t,o){r.traceTag.notify(e,n,t,o)},debugTraceTag:function(e,n,t,o){r.debugTraceTag.notify(e,n,t,o)}}}(f),p=function(e){return!0===u[e]},n.config.initCalc(E,p,i),r()||null==t.onInit?[3,3]:[4,t.onInit(f)];case 2:e.sent(),e.label=3;case 3:return s=!0,[3,5];case 4:throw v=e.sent(),null!=f?f.close():xv(),v;case 5:return[2]}})})}).then(function(e){return[iv.Fulfilled,e]},function(e){return[iv.Rejected,e]})];case 1:r=d.sent(),c=r[0],l=r[1],s=[av.Result,e,c,Tv(l),!0];try{self.postMessage(s)}catch(e){throw xv(),e}return[2]}})})}var Gv={onError:function(e,r){var n=null!=r.error.stack?r.error.stack:r.error.message,t="calc.worker.smokeTestInsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:n});S.ULS.traceTag(595908699,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Error,t)},onClosed:function(e){},onInit:function(e){var r=e.getImports("talk",["ping"]);e.setExports("location",Nn),e.setExports("talk",{start:function(e,n,t){return ut(this,void 0,void 0,function(){var o,a=this;return ct(this,function(i){switch(i.label){case 0:return o=Date.now(),[4,fv(function(i){return ut(a,void 0,void 0,function(){return ct(this,function(a){switch(a.label){case 0:return Date.now()>=o+e?[2,void 0]:[4,new Promise(function(e){return setTimeout(function(){return e()},n)})];case 1:return a.sent(),r.ping.notify(i,t),[2,i+1]}})})},0)];case 1:return i.sent(),[2]}})})},memoryTest:function(e){var r=[],n=0;try{for(;n<e;n+=1){var t=new Uint8Array(1024);t[0]=0,t[1023]=255,r.push(t)}}catch(e){}r=[];var o="calc.worker.smokeTestInsideDef.memoryTest: memory allocated = "+n+"KB";S.ULS.traceTag(595906820,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,o)},ping:function(e,r){if(r&&e%1e3==0){var n="calc.worker.smokeTestInsideDef.ping: n = "+e;S.ULS.traceTag(595907656,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,n)}return e+1}})},scriptName:"excelOnlineCalcSmokeTest.worker"},Wv={outside:{onError:function(e,r){var n=null!=r.error.stack?r.error.stack:r.error.message,t="calc.worker.smokeTestOutsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:n});S.ULS.traceTag(595910859,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Error,t)},onClosed:function(e){S.ULS.traceTag(595908701,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"calc.worker.smokeTestOutsideDef.onClose")},onInit:function(e){e.setExports("talk",{ping:function(e,r){if(r&&e%1e3==0){var n="calc.worker.smokeTestOutsideDef.ping: n = "+e;S.ULS.traceTag(595907657,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,n)}return e+1}})}},inside:Gv},Hv=!1,Kv=void 0;function jv(){null!=Kv&&Kv.close(),Hv=!1}var Qv=Promise.resolve();function Xv(e,r,n,t){return void 0===t&&(t=0),Gr(wr.CalcWebWorkerTest)?(jv(),Qv=Qv.then(function(o){return function(e,r,n,t){return ut(this,void 0,void 0,function(){var o,a,i,u,c,l,f,d=this;return ct(this,function(E){switch(E.label){case 0:Hv=!0,E.label=1;case 1:return E.trys.push([1,8,9,10]),f="calc.worker.runSmokeTest: starting; duration = "+e+"ms, pingInterval = "+r+"ms",S.ULS.traceTag(595908687,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,f),[4,Bv([tv.Dedicated,tv.MessageChannel,tv.FunctionCall],Wv)];case 2:if(null==(Kv=E.sent()))throw new Error("could not create any kind of worker");if(!Hv)throw new Error("smoke test canceled during worker creation");return f="calc.worker.runSmokeTest: worker created; outside.workerKind = "+Kv.workerKind,S.ULS.traceTag(595907658,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,f),o=Kv.getImports("talk",["start","memoryTest","ping"]),a=Kv.getImports("location",["gridCell"]),[4,o.ping.call(-1,n)];case 3:return i=E.sent(),[4,a.gridCell.call(2,3)];case 4:if(u=E.sent(),0!==i||2!==u.row||3!==u.col)throw new Error("expected 0, 2, 3; got "+i+", "+u.row+", "+u.col);return t>0&&Kv.workerKind===tv.Dedicated?[4,o.memoryTest.call(t)]:[3,6];case 5:E.sent(),E.label=6;case 6:return o.start.notify(e,r,n),c=Date.now(),[4,fv(function(t){return ut(d,void 0,void 0,function(){return ct(this,function(a){switch(a.label){case 0:return Date.now()>=c+e?[2,void 0]:[4,new Promise(function(e){return setTimeout(function(){return e()},r)})];case 1:return a.sent(),o.ping.notify(t,n),[2,t+1]}})})},0)];case 7:return E.sent(),f="calc.worker.runSmokeTest: success",S.ULS.traceTag(595906821,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Error,f),[3,10];case 8:return l=E.sent(),f="calc.worker.runSmokeTest: failure: "+(null!=l.stack?l.stack:l.message),S.ULS.traceTag(595908702,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Error,f),[3,10];case 9:return jv(),Kv=void 0,[7];case 10:return[2]}})})}(e,r,n,t)})):Promise.resolve()}var Jv={onError:function(e,r){},onInit:function(e){e.setExports("service",{updateRanges:function(){}})},scriptName:"excelOnlineRecalcService.worker"},Yv={outside:{onError:function(e,r){},onClosed:function(e){}},inside:Jv};function qv(){return ut(this,void 0,void 0,function(){var e,r,n,t;return ct(this,function(o){switch(o.label){case 0:return[4,Bv([tv.Dedicated,tv.FunctionCall],Yv)];case 1:if(null==(e=o.sent()))throw new Error("could not create any kind of worker");return r="calc.calc.createRecalcService: worker created; outside.workerKind = "+e.workerKind,S.ULS.traceTag(595731987,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,r),n={onRecalcResults:function(e){},onUpdateRequest:function(e){}},e.setExports("client",n),t=e.getImports("service",["updateRanges"]),[2,{setOnRecalcResults:function(e){n.onRecalcResults=e},setOnUpdateRequest:function(e){n.onUpdateRequest=e},setA1ReferenceStyle:function(){},setLocale:function(){},setNumberFormats:function(){},setSheetNames:function(){},setUsedRanges:function(){},updateRanges:function(e,r){t.updateRanges.notify(e,r)},updateArrays:function(){},editRangeFormulas:function(){},editArrayFormulas:function(){},resumeRecalc:function(){},waitForRecalc:function(){return Promise.resolve()},clearCache:function(){},close:function(){e.close()}}]}})})}function zv(e,r){return{key:e,value:r}}function Zv(e){return{entries:{},keyToString:e,getCount:function(){return Object.keys(this.entries).length},getValue:function(e){var r=this.entries[this.keyToString(e)];return Qr(r)?r.value:void 0},setValue:function(e,r){var n=this.keyToString(e),t=this.entries[n];Qr(t)?t.value=r:this.entries[n]=zv(e,r)},contains:function(e){var r=this.keyToString(e);return void 0!==this.entries[r]&&null!==this.entries[r]},remove:function(e){var r=this.keyToString(e);return void 0!==this.entries[r]&&(delete this.entries[r],!0)},getOrSetValue:function(e,r){var n=this.keyToString(e),t=this.entries[n];if(Qr(t))return t.value;var o=r();return delete this.entries[n],this.entries[n]=zv(e,o),o},forEach:function(e){for(var r in this.entries){var n=this.entries[r];null!=n&&e(n.key,n.value)}}}}var $v=function(){function e(e){this.kind=0,this.result=e}return e.prototype.failed=function(e){throw S.ULS.traceTag(595910681,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"DataCell.failed: Calc.ts cannot fail at handling just data."),"DataCell.failed: Calc.ts cannot fail at handling just data."},e}(),eh=new $v(ve),rh=function(){function e(e){this.kind=1,this.raw=e,this.ir=void 0}return e.prototype.parsed=function(e){this.ir=e},e.prototype.analysed=function(e){this.ir=e},e.prototype.compiled=function(e){this.ir=e},e.prototype.failed=function(e,r){return new nh(this.raw,e,r)},e}(),nh=function(){function e(e,r,n){this.kind=2,this.phase=r,this.formulaText=e,this.reason=n}return e.prototype.failed=function(e){return S.ULS.traceTag(595910682,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Failed.failed: Calc.ts will not attempt at working with a FailedFormula"),this},e}(),th=function(){function e(){this.table={map:{},nentries:0,keyToHash:Rp,keyEquals:Ip,getCount:function(){return this.nentries},getValue:function(e){var r=this.keyToHash(e),n=this.map[r];if(!Xr(n)){for(var t=0;t<n.length;t+=1){var o=n[t];if(this.keyEquals(e,o.key))return o.value}mp("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e)}},contains:function(e){return void 0!==this.getValue(e)},setValue:function(e,r){var n=this.keyToHash(e),t=this.map[n];if(null==t)this.map[n]=[zv(e,r)],this.nentries+=1;else{for(var o=0;o<t.length;o+=1){var a=t[o];if(this.keyEquals(a.key,e))return void(a.value=r)}t.push(zv(e,r)),this.nentries+=1,mp("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e)}},remove:function(e){var r=this.keyToHash(e),n=this.map[r];if(Xr(n))return!1;for(var t=[],o=!1,a=0;a<n.length&&!o;a+=1){var i=n[a];this.keyEquals(e,i.key)?(this.nentries-=1,o=!0):t.push(i)}return this.map[r]=t,o||mp("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),o},getOrSetValue:function(e,r){var n=this.keyToHash(e),t=this.map[n];if(Xr(t)){var o=r();return this.map[n]=[zv(e,o)],this.nentries+=1,o}for(var a=0;a<t.length;a+=1){var i=t[a];if(this.keyEquals(e,i.key))return i.value}var u=r();return t.push(zv(e,u)),this.nentries+=1,mp("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),u},forEach:function(e){var r=this;Object.keys(this.map).forEach(function(n){r.map[+n].forEach(function(r){e(r.key,r.value)})})}},this.usedRange=void 0}return e.prototype.getCellContents=function(e){var r=this.table.getValue(e);return void 0===r?eh:r},e.prototype.setCellContents=function(e,r){if(this.table.setValue(e,r),void 0===this.usedRange)this.usedRange={row:e.range.row,column:e.range.col};else{var n=this.usedRange,t=n.row,o=n.column;this.usedRange={row:Math.max(e.range.row,t),column:Math.max(e.range.col,o)}}},e.prototype.forEach=function(e){this.table.forEach(e)},e.prototype.getUsedRange=function(){return this.usedRange},e}();var oh=function(){function e(e,r){this.workbook=e,this.grid=new th,this.name=r}return e.prototype.updateGrid=function(e,r){this.grid.setCellContents(e,new rh(r))},e.prototype.upgradeGridWithValue=function(e,r){this.grid.setCellContents(e,new $v(r))},e.prototype.parse=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Ir("Sheet.parse: didn't find a formula to parse.");var n=r;if(void 0!==n.ir)return Ir("Sheet.parse: formula has been parsed already.");var t=this.workbook.parser.parseFormula(this.workbook.isA1RefStyle?ce.A1:ce.R1C1,e,h.Cell,n.raw);return t.kind===je.Failure?(this.grid.setCellContents(e,n.failed(0)),Ir("Sheet.parse: parsing of failed.")):t.value.node.kind===de.Bad?(this.grid.setCellContents(e,r.failed(0)),Ir("Sheet.parse: parsing of formula failed (bad formula).")):(n.parsed(t.value),Rr(t.value))},e.prototype.analyse=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Ir("Sheet.analyse: didn't find a formula to analyse.");var n=r,t=n.ir;if(void 0===t||void 0===t.node)return Ir("Sheet.analyse: didn't find AST in this cell.");var o=this.workbook.analyzer.checkFormula(e,h.Cell,t);return o.isWellFormed?(n.analysed(o),Rr(o)):(this.grid.setCellContents(e,r.failed(1)),Ir("Sheet.analyse: formula is not well-formed."))},e.prototype.compile=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Ir("Sheet.compile: didn't find a formula to compile.");var n=r,t=n.ir;if(void 0===t||!0!==t.isWellFormed)return Ir("Sheet.compile: didn't find a well-formed formula in this cell.");var o=this.workbook.compiler.compileFormula(e,h.Cell,t);return o.kind!==je.Success?(this.grid.setCellContents(e,r.failed(3)),Ir("Sheet.compile: formula can't be compiled.")):(n.compiled(o.value),Rr(o.value))},e.prototype.evaluate=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Ir("Sheet.evaluate: didn't find a formula to evaluate.");if(void 0===r.ir)return Ir("Sheet.evaluate: didn't find a compiled term in this cell.");var n=this.workbook.evaluator.evalCells([e]);if(!(n instanceof Array)){if(n.kind===je.Paused)return Ir("Sheet.evaluate: evaluator didn't meet deadline");throw Ir("Sheet.evaluate: something went wrong in the data model.")}var t=n[0];if(t.kind!==je.Success)switch(this.grid.setCellContents(e,r.failed(3,t.reason.kind)),t.reason.kind){case"NotImplemented":return Ir("Sheet.evaluate: unimplemented functions :: "+t.reason.features);case"JavaScriptError":return Ir("Sheet.evaluate: javascript error :: "+t.reason.error);case"NameCycle":return Ir("Sheet.evaluate: name cycle :: "+t.reason.names);case"CellCycle":return Ir("Sheet.evaluate: cell cycle :: "+t.reason.cells);default:return Ir("Sheet.evaluate: failed :: "+t.reason)}return wl(t.value)?Rr(0):Rr(t.value)},e}();function ah(e){return function(r,n){return e.documentLocation}}function ih(e){return function(r,n){return Rr(e.getSheetId(n))}}function uh(e,r){var n=e.worksheets.getValue(r.sheet.index);if(void 0!==n){var t=n.grid.getCellContents(r);if(2===t.kind){var o=e.expectedValue(r);return void 0!==o?pl(o):void 0}return 0===t.kind?pl(t.result):vl(r)}}function ch(e){return function(r){var n=uh(e,r);return void 0===n?Ir(Il(r)):Rr(n)}}function lh(e,r,n){return function(t){var o=t.sheet,a=t.range,i=a.row,u=a.col,c=a.rows,l=a.cols;if(c*l>r*n)return Rr([]);if(void 0!==e.worksheets.getValue(o.index)){for(var s=[],f=i;f<i+c;f+=1){for(var d=[],E=u;E<u+l;E+=1){var p=K(o,b(f,E)),v=uh(e,p);if(void 0===v)return Ir(Il(t));d.push(v)}s.push(d)}return Rr(s)}return Ir(Il(t))}}function sh(e){return function(r){if("number"==typeof r){var n=vp(r);return null!=n?Rr(n):Ir(Ar([e.config.localeInfo.getWorksheetFuncName(r)]))}return Rr(void 0)}}function fh(e){return function(r){var n=r.name.toUpperCase(),t=r.scope;if(void 0===t.index)return Rr(e.globalNames.getValue(n));var o=e.scopedNames.getValue(t.index);return Rr(void 0===o?void 0:o.getValue(n))}}function dh(e){return function(r){var n=e.worksheets.getValue(r.sheet.index);if(void 0===n)return Rr(void 0);var t=n.grid.getCellContents(r);if(0===t.kind||2===t.kind)return Rr(void 0);var o=t.ir;return Rr(hl(r,h.Cell,o))}}function Eh(e){return function(r,n){var t=e.worksheets.getValue(r.sheet.index);void 0!==t&&t.grid.setCellContents(r,new $v(n))}}function ph(e){return function(r,n){for(var t=r.sheet,o=r.range,a=o.row,i=o.col,u=o.rows,c=o.cols,l=0;l<u;l+=1)for(var s=0;s<c;s+=1){var f=K(t,b(l+a,s+i)),d=e.worksheets.getValue(f.sheet.index);void 0!==d&&d.grid.setCellContents(f,new $v(n[l][s]))}}}function vh(e){return function(r,n){for(var t=r.sheet,o=r.range,a=o.row,i=o.col,u=o.rows,c=o.cols,l=0;l<u;l+=1)for(var s=0;s<c;s+=1){var f=K(t,b(l+a,s+i)),d=e.worksheets.getValue(f.sheet.index);if(void 0!==d){var E=d.grid.getCellContents(f);void 0!==E&&d.grid.setCellContents(f,E.failed(3,n.kind))}}}}function hh(e){return function(r){var n=e.worksheets.getValue(r.index);if(void 0===n)return Ir(Nr([r]));var t=n.grid.getUsedRange();if(void 0===t)return Rr(t);var o=F(0,0,t.row+1,t.column+1);return Rr(H(r,o))}}function gh(e,r,n){var t=e.parser.parseFormula(e.isA1RefStyle?ce.A1:ce.R1C1,n,h.NameManager,r);if(t.kind===je.Success){var o=e.analyzer.checkFormula(n,h.NameManager,t.value);return o.isWellFormed?e.compiler.compileFormula(n,h.NameManager,o):Ir(El("compileNamedFormula: formula is not well formed"))}return t}var Th=K(M(L(void 0,""),0),b(0,0)),mh=function(){function e(e,r,n,t,o,a,i,u,c,l){var s=this;void 0===u&&(u=!0),this.documentLocation=L(void 0,e),this.isA1RefStyle=r,this.locale=t,this.config=Un.calcConfig(t),Un.initCalc(l,function(e){return-1!==c.indexOf(e)});var f=Un.calcConfig(t);this.config=f;var d={config:f},E={config:f},p={config:f,mathpack:a};this.parser=Eu(d),this.analyzer=Rc(E),this.compiler=is(p);var h,g,T,m=o?(g=1024,T=1024,{config:(h=this).config,mathpack:Fc,getDocumentLoc:ah(h),getSheetIndex:ih(h),getCellValue:ch(h),getCellValues:lh(h,g,T),getFirstOrderFunc:sh(h),getNameFormula:fh(h),getCellFormula:dh(h),interruptToken:[sl.Continue],schedulerInfo:{},setCellValue:Eh(h),setCellValues:ph(h),setCellFailure:vh(h),getUsedRange:hh(h),setDynamicPrecs:function(e,r){},loadObjects:function(e){return!1}}):function(e){throw"Not being invoked yet."}();this.evaluator=Yd(m),this.globalNames=Zv(Hr),this.scopedNames=Zv(String),this.worksheets=Zv(String),this.sheetId=0,n.forEach(function(e){s.addWorksheet(e)}),this.expectedValue=i,this.preprocess=function(e){return function(r){return e?v(r):"string"==typeof r?r:JSON.stringify(r)}}(u)}return e.prototype.addWorksheet=function(e){this.worksheets.setValue(this.sheetId,new oh(this,e)),this.sheetId+=1},e.prototype.makeHomeCell=function(e){var r=this.parser.parseFormula(this.isA1RefStyle?ce.A1:ce.R1C1,Th,h.Cell,e);if(r.kind===je.Failure)return"Workbook can't create home cell "+this.preprocess(e)+". Reason: "+this.preprocess(r.reason)+".";if(r.value.node.kind===de.Bad)return"Workbook can't create home cell "+this.preprocess(e)+". (Bad Node).";var n=r.value.node.ref,t=r.value.node.qualifier,o=this.getSheetId(t.sheet);return-1===o?"Workbook can't find index of sheet "+this.preprocess(t.sheet)+".":K(M(this.documentLocation,o),b(n.row.index,n.col.index))},e.prototype.getSheetId=function(e){var r=-1;return this.worksheets.forEach(function(n,t){t.name===e&&(r=n)}),r},e.prototype.failedToAddName=function(e,r,n){var t=e?"addGlobalName":"addScopedName";S.ULS.traceTag(595891858,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Workbook."+t+": "+r+" >> "+this.preprocess(n)+".")},e.prototype.addGlobalName=function(e,r,n){var t=this.makeHomeCell(n);if("string"==typeof t)return this.failedToAddName(!0,"failed to parse home cell",n);var o=gh(this,r,t);o.kind===je.Success?this.globalNames.setValue(e,o.value):this.failedToAddName(!0,"failed to compile named formula",r)},e.prototype.addScopedName=function(e,r,n,t){var o=this.makeHomeCell(t);if("string"==typeof o)return this.failedToAddName(!1,"failed to parse home cell",t);var a=gh(this,n,o);a.kind===je.Success?this.scopedNames.getOrSetValue(e,function(){return Zv(Hr)}).getOrSetValue(r,function(){return a.value}):this.failedToAddName(!1,"failed to compile named formula",n)},e.prototype.getSheetAndCell=function(e){var r=this.makeHomeCell(e);if("string"==typeof r)return r;var n=r.sheet.document;if(this.documentLocation!==n)return"Workbook: invalid workbook location";var t=r.sheet.index,o=this.worksheets.getValue(t);return void 0===o?"Workbook: invalid workbook location":{sheet:o,cell:r}},e.prototype.cellUpdateFailed=function(e,r,n){var t={cell:e,formula:r};S.ULS.traceTag(595891859,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Workbook.cellUpdate: "+n+" >> "+this.preprocess(t)+".")},e.prototype.cellUpdate=function(e,r){try{var n=this.getSheetAndCell(e);if("string"==typeof n)return this.cellUpdateFailed(e,r,"could not find cell and sheet");var t=n.sheet,o=n.cell;t.updateGrid(o,r);var a=t.parse(o);if(!Cr(a))return this.cellUpdateFailed(e,r,"failed at parsing. "+a.reason);if(!Cr(a=t.analyse(o)))return this.cellUpdateFailed(e,r,"failed at analysing. "+a.reason);if(!Cr(a=t.compile(o)))return this.cellUpdateFailed(e,r,"failed at compiling. "+a.reason)}catch(e){S.ULS.traceTag(595891860,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Exception in Workbook.cellUpdate: "+e)}},e.prototype.cellEvaluate=function(e){var r=this.worksheets.getValue(e.sheet.index);if(void 0!==r){var n=r.evaluate(e);Cr(n)||S.ULS.traceTag(595886097,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Workbook.cellEvaluate: failed at evaluating "+this.preprocess(e)+". "+n.reason)}else S.ULS.traceTag(595886096,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,"Workbook.cellEvaluate: couldn't find worksheet "+this.preprocess(r))},e.prototype.cellUpdateWithValue=function(e,r){var n=this.getSheetAndCell(e);if("string"!=typeof n){var t=n.sheet,o=n.cell;t.upgradeGridWithValue(o,r)}else{var a="Workbook.cellUpdateWithValue: "+n+".";S.ULS.traceTag(595891861,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,a)}},e.prototype.cellRead=function(e){var r=this.getSheetAndCell(e);if("string"==typeof r){var n="Workbook.cellRead: "+r+".";return S.ULS.traceTag(595891862,s.LogCategory.msoulscat_ES_EWAJS,s.TraceLevel.Info,n),n}var t=r.sheet,o=r.cell;return t.grid.getCellContents(o)},e.prototype.forEachCell=function(e){this.worksheets.forEach(function(r,n){n.grid.forEach(function(r,t){e(n,r,t)})})},e}();n.d(r,"location",function(){return Nn}),n.d(r,"formula",function(){return kn}),n.d(r,"value",function(){return yn}),n.d(r,"signature",function(){return Mn}),n.d(r,"util",function(){return Fn}),n.d(r,"config",function(){return Un}),n.d(r,"parse",function(){return t}),n.d(r,"analyze",function(){return o}),n.d(r,"runtime",function(){return a}),n.d(r,"calc",function(){return u}),n.d(r,"funcs",function(){return c}),n.d(r,"worker",function(){return i}),n.d(r,"datamodel",function(){return l})}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map